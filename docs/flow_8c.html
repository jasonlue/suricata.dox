<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/flow.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('flow_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">flow.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="runmodes_8h_source.html">runmodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-random_8h_source.html">util-random.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-queue_8h_source.html">flow-queue.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-hash_8h_source.html">flow-hash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-var_8h_source.html">flow-var.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-private_8h_source.html">flow-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-timeout_8h_source.html">flow-timeout.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-manager_8h_source.html">flow-manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-storage_8h_source.html">flow-storage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-bypass_8h_source.html">flow-bypass.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-spare-pool_8h_source.html">flow-spare-pool.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-unittest-helper_8h_source.html">util-unittest-helper.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-byte_8h_source.html">util-byte.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-misc_8h_source.html">util-misc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-macset_8h_source.html">util-macset.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-validate_8h_source.html">util-validate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-expectation_8h_source.html">app-layer-expectation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for flow.c:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2flow_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2flow_8c" id="a_2Users_2jlu_2suricata_2src_2flow_8c">
<area shape="rect" title=" " alt="" coords="1813,5,1941,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="632,319,765,345"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="131,767,207,793"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="125,692,214,719"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1736,617,1811,644"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="1744,767,1803,793"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="1993,692,2087,719"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1280,468,1349,495"/>
<area shape="rect" href="flow_8h.html" title=" " alt="" coords="1515,543,1570,569"/>
<area shape="rect" href="flow-queue_8h.html" title=" " alt="" coords="1495,617,1591,644"/>
<area shape="rect" href="suricata_8h.html" title=" " alt="" coords="1086,244,1165,271"/>
<area shape="rect" href="runmodes_8h.html" title=" " alt="" coords="1528,319,1619,345"/>
<area shape="rect" href="tm-threads_8h.html" title=" " alt="" coords="1358,319,1453,345"/>
<area shape="rect" href="util-random_8h.html" title=" " alt="" coords="2249,95,2346,121"/>
<area shape="rect" href="util-time_8h.html" title=" " alt="" coords="2370,95,2449,121"/>
<area shape="rect" href="flow-hash_8h.html" title=" " alt="" coords="1745,169,1834,196"/>
<area shape="rect" href="flow-util_8h.html" title=" " alt="" coords="1539,169,1618,196"/>
<area shape="rect" href="stream-tcp-private_8h.html" title=" " alt="" coords="1357,244,1496,271"/>
<area shape="rect" href="flow-var_8h.html" title=" " alt="" coords="1606,468,1685,495"/>
<area shape="rect" href="flow-private_8h.html" title=" " alt="" coords="1739,95,1839,121"/>
<area shape="rect" href="flow-timeout_8h.html" title=" " alt="" coords="2473,95,2577,121"/>
<area shape="rect" href="flow-manager_8h.html" title=" " alt="" coords="2602,95,2713,121"/>
<area shape="rect" href="flow-storage_8h.html" title=" " alt="" coords="1909,169,2013,196"/>
<area shape="rect" href="flow-bypass_8h.html" title=" " alt="" coords="2737,95,2839,121"/>
<area shape="rect" href="flow-spare-pool_8h.html" title=" " alt="" coords="787,244,909,271"/>
<area shape="rect" href="stream-tcp-reassemble_8h.html" title=" " alt="" coords="1147,169,1314,196"/>
<area shape="rect" href="stream-tcp_8h.html" title=" " alt="" coords="1305,95,1399,121"/>
<area shape="rect" href="stream_8h.html" title=" " alt="" coords="1390,169,1463,196"/>
<area shape="rect" href="util-unittest_8h.html" title=" " alt="" coords="2863,95,2961,121"/>
<area shape="rect" href="util-unittest-helper_8h.html" title=" " alt="" coords="2985,95,3119,121"/>
<area shape="rect" href="util-byte_8h.html" title=" " alt="" coords="3143,95,3222,121"/>
<area shape="rect" href="util-misc_8h.html" title=" " alt="" coords="3247,95,3329,121"/>
<area shape="rect" href="util-macset_8h.html" title=" " alt="" coords="3354,95,3451,121"/>
<area shape="rect" href="util-privs_8h.html" title=" " alt="" coords="3476,95,3559,121"/>
<area shape="rect" href="util-validate_8h.html" title=" " alt="" coords="3583,95,3681,121"/>
<area shape="rect" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine." alt="" coords="3705,95,3849,121"/>
<area shape="rect" href="app-layer-parser_8h.html" title=" " alt="" coords="3873,95,3999,121"/>
<area shape="rect" href="app-layer-expectation_8h.html" title=" " alt="" coords="1915,95,2072,121"/>
<area shape="rect" title=" " alt="" coords="462,393,527,420"/>
<area shape="rect" title=" " alt="" coords="551,393,630,420"/>
<area shape="rect" title=" " alt="" coords="219,393,285,420"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="1143,617,1246,644"/>
<area shape="rect" title=" " alt="" coords="654,393,727,420"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="1331,393,1480,420"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="13,767,91,793"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="752,393,835,420"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="1115,393,1255,420"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="859,393,938,420"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="341,543,419,569"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="1715,692,1832,719"/>
</map>
</div>
</div>
<p><a href="flow_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a3232d5ee2fdb2b5ffd2be3bdbbf4f18b">FLOW_DEFAULT_EMERGENCY_RECOVERY</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896f8fb0988876b52fba26b36f46e61a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a896f8fb0988876b52fba26b36f46e61a">FLOW_DEFAULT_HASHSIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:a896f8fb0988876b52fba26b36f46e61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0527582503a0d59bcfc0c3392d336e9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a0527582503a0d59bcfc0c3392d336e9e">FLOW_DEFAULT_MEMCAP</a>&#160;&#160;&#160;(32 * 1024 * 1024) /* 32 MB */</td></tr>
<tr class="separator:a0527582503a0d59bcfc0c3392d336e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af279bea0e0bad43d54b60bbf8743942c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#af279bea0e0bad43d54b60bbf8743942c">FLOW_DEFAULT_PREALLOC</a>&#160;&#160;&#160;10000</td></tr>
<tr class="separator:af279bea0e0bad43d54b60bbf8743942c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660c7deee17f0877a88e37913f9bf8fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a660c7deee17f0877a88e37913f9bf8fd">SET_DEFAULTS</a>(p,  n,  e,  c,  b,  ne,  ee,  ce,  be)</td></tr>
<tr class="separator:a660c7deee17f0877a88e37913f9bf8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5be27ced6ce47397200c22dff29ab700"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a5be27ced6ce47397200c22dff29ab700">SC_ATOMIC_DECLARE</a> (<a class="el" href="flow-private_8h.html#aa13286f5b61ee2cf7a7a03171a5d151d">FlowProtoTimeoutPtr</a>, flow_timeouts)</td></tr>
<tr class="separator:a5be27ced6ce47397200c22dff29ab700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a042231529464e85eb0482c00c0cd114f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a042231529464e85eb0482c00c0cd114f">SC_ATOMIC_DECLARE</a> (unsigned int, flow_prune_idx)</td></tr>
<tr class="separator:a042231529464e85eb0482c00c0cd114f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a3c29e500a18c716b94d6975c58009"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a00a3c29e500a18c716b94d6975c58009">SC_ATOMIC_DECLARE</a> (unsigned int, flow_flags)</td></tr>
<tr class="separator:a00a3c29e500a18c716b94d6975c58009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f09029b35eab2a1b1034383d9c1e59f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a9f09029b35eab2a1b1034383d9c1e59f">SC_ATOMIC_DECLARE</a> (uint64_t, flow_memuse)</td></tr>
<tr class="separator:a9f09029b35eab2a1b1034383d9c1e59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a4fa1db77ebc6f5bd811ccf151f1c8218">FlowRegisterTests</a> (void)</td></tr>
<tr class="memdesc:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to register the Flow Unitests.  <a href="flow_8c.html#a4fa1db77ebc6f5bd811ccf151f1c8218">More...</a><br /></td></tr>
<tr class="separator:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871212f9b59e814e9b4763644459247b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a871212f9b59e814e9b4763644459247b">FlowInitFlowProto</a> (void)</td></tr>
<tr class="memdesc:a871212f9b59e814e9b4763644459247b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the default timeout, free function and flow state function for all supported flow_proto.  <a href="flow_8c.html#a871212f9b59e814e9b4763644459247b">More...</a><br /></td></tr>
<tr class="separator:a871212f9b59e814e9b4763644459247b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05174d1570db7ee4b5a25f5ea7234e87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a05174d1570db7ee4b5a25f5ea7234e87">FlowSetProtoFreeFunc</a> (uint8_t <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>, void(*Free)(void *))</td></tr>
<tr class="memdesc:a05174d1570db7ee4b5a25f5ea7234e87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the function to get protocol specific flow state.  <a href="flow_8c.html#a05174d1570db7ee4b5a25f5ea7234e87">More...</a><br /></td></tr>
<tr class="separator:a05174d1570db7ee4b5a25f5ea7234e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68bb367eb352444ff5853171023c42e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a68bb367eb352444ff5853171023c42e9">FlowSetMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:a68bb367eb352444ff5853171023c42e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update memcap value.  <a href="flow_8c.html#a68bb367eb352444ff5853171023c42e9">More...</a><br /></td></tr>
<tr class="separator:a68bb367eb352444ff5853171023c42e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa462907be05f689a465cc2053472fce3"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#aa462907be05f689a465cc2053472fce3">FlowGetMemcap</a> (void)</td></tr>
<tr class="memdesc:aa462907be05f689a465cc2053472fce3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return memcap value.  <a href="flow_8c.html#aa462907be05f689a465cc2053472fce3">More...</a><br /></td></tr>
<tr class="separator:aa462907be05f689a465cc2053472fce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6edadd8447c63a43bd38a1e83af329b9"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6edadd8447c63a43bd38a1e83af329b9">FlowGetMemuse</a> (void)</td></tr>
<tr class="separator:a6edadd8447c63a43bd38a1e83af329b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac544802aadaf9306d54a61942d3e597d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d">FlowCleanupAppLayer</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:ac544802aadaf9306d54a61942d3e597d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6025792807455fef29864c21cea6f38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ac6025792807455fef29864c21cea6f38">FlowSetIPOnlyFlag</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, int direction)</td></tr>
<tr class="memdesc:ac6025792807455fef29864c21cea6f38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the IPOnly scanned flag for 'direction'.  <a href="flow_8c.html#ac6025792807455fef29864c21cea6f38">More...</a><br /></td></tr>
<tr class="separator:ac6025792807455fef29864c21cea6f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8700403578f88dc8810437736ccd21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a5c8700403578f88dc8810437736ccd21">FlowSetHasAlertsFlag</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:a5c8700403578f88dc8810437736ccd21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set flag to indicate that flow has alerts.  <a href="flow_8c.html#a5c8700403578f88dc8810437736ccd21">More...</a><br /></td></tr>
<tr class="separator:a5c8700403578f88dc8810437736ccd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873c37d5d66c4345a30617709eb3b22c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a873c37d5d66c4345a30617709eb3b22c">FlowHasAlerts</a> (const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:a873c37d5d66c4345a30617709eb3b22c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if flow has alerts.  <a href="flow_8c.html#a873c37d5d66c4345a30617709eb3b22c">More...</a><br /></td></tr>
<tr class="separator:a873c37d5d66c4345a30617709eb3b22c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c9972bae4a5474a7f5fc785890ad40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ad5c9972bae4a5474a7f5fc785890ad40">FlowSetChangeProtoFlag</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:ad5c9972bae4a5474a7f5fc785890ad40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set flag to indicate to change proto for the flow.  <a href="flow_8c.html#ad5c9972bae4a5474a7f5fc785890ad40">More...</a><br /></td></tr>
<tr class="separator:ad5c9972bae4a5474a7f5fc785890ad40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71829515c7880d4089d0fb8422f2f912"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a71829515c7880d4089d0fb8422f2f912">FlowUnsetChangeProtoFlag</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:a71829515c7880d4089d0fb8422f2f912"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unset flag to indicate to change proto for the flow.  <a href="flow_8c.html#a71829515c7880d4089d0fb8422f2f912">More...</a><br /></td></tr>
<tr class="separator:a71829515c7880d4089d0fb8422f2f912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4e426d680d8624300a2e3d8dfeffec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#acc4e426d680d8624300a2e3d8dfeffec">FlowChangeProto</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:acc4e426d680d8624300a2e3d8dfeffec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if change proto flag is set for flow.  <a href="flow_8c.html#acc4e426d680d8624300a2e3d8dfeffec">More...</a><br /></td></tr>
<tr class="separator:acc4e426d680d8624300a2e3d8dfeffec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e814b4efead88c5e176c76ba3a90ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#af7e814b4efead88c5e176c76ba3a90ce">FlowSwap</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="memdesc:af7e814b4efead88c5e176c76ba3a90ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">swap the flow's direction  <a href="flow_8c.html#af7e814b4efead88c5e176c76ba3a90ce">More...</a><br /></td></tr>
<tr class="separator:af7e814b4efead88c5e176c76ba3a90ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122">FlowGetPacketDirection</a> (const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine the direction of the packet compared to the flow  <a href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122">More...</a><br /></td></tr>
<tr class="separator:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae335b96119f82fcf93ca0bb0e2f1caad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ae335b96119f82fcf93ca0bb0e2f1caad">FlowHandlePacketUpdate</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="decode_8h.html#a96609a89ed9d99b4286354b153e72495">DecodeThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#a6471cbf93b5fa3fbc67bbafe52d29adb">dtv</a>)</td></tr>
<tr class="memdesc:ae335b96119f82fcf93ca0bb0e2f1caad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update Packet and Flow.  <a href="flow_8c.html#ae335b96119f82fcf93ca0bb0e2f1caad">More...</a><br /></td></tr>
<tr class="separator:ae335b96119f82fcf93ca0bb0e2f1caad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045986b2e6fe1d286361da7b08c03c7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a045986b2e6fe1d286361da7b08c03c7f">FlowHandlePacket</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="flow_8h.html#a2d77f0373e685ff430a8f029f070a749">FlowLookupStruct</a> *fls, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a045986b2e6fe1d286361da7b08c03c7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point for packet flow handling.  <a href="flow_8c.html#a045986b2e6fe1d286361da7b08c03c7f">More...</a><br /></td></tr>
<tr class="separator:a045986b2e6fe1d286361da7b08c03c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a649d2d3a9c0766202ee154aeee1d20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a2a649d2d3a9c0766202ee154aeee1d20">FlowInitConfig</a> (bool quiet)</td></tr>
<tr class="memdesc:a2a649d2d3a9c0766202ee154aeee1d20"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the configuration  <a href="flow_8c.html#a2a649d2d3a9c0766202ee154aeee1d20">More...</a><br /></td></tr>
<tr class="separator:a2a649d2d3a9c0766202ee154aeee1d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc1589cef09521a8894aed9e365b5f7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#adc1589cef09521a8894aed9e365b5f7a">FlowReset</a> (void)</td></tr>
<tr class="separator:adc1589cef09521a8894aed9e365b5f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dae51c56800ed0e22279e49913cd15a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a8dae51c56800ed0e22279e49913cd15a">FlowShutdown</a> (void)</td></tr>
<tr class="memdesc:a8dae51c56800ed0e22279e49913cd15a"><td class="mdescLeft">&#160;</td><td class="mdescRight">shutdown the flow engine  <a href="flow_8c.html#a8dae51c56800ed0e22279e49913cd15a">More...</a><br /></td></tr>
<tr class="separator:a8dae51c56800ed0e22279e49913cd15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e9eb43b74a70300e86da9c025705b1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a">FlowClearMemory</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, uint8_t proto_map)</td></tr>
<tr class="memdesc:a6e9eb43b74a70300e86da9c025705b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function clear the flow memory before queueing it to spare flow queue.  <a href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a">More...</a><br /></td></tr>
<tr class="separator:a6e9eb43b74a70300e86da9c025705b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1135a66e64bd8fe19166c853ea0e7986"><td class="memItemLeft" align="right" valign="top"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a1135a66e64bd8fe19166c853ea0e7986">FlowGetAppProtocol</a> (const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:a1135a66e64bd8fe19166c853ea0e7986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff1b494b285d88cce9ea42219601b04"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#aaff1b494b285d88cce9ea42219601b04">FlowGetAppState</a> (const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:aaff1b494b285d88cce9ea42219601b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca700f93b37d88672923ffb56949d640"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#aca700f93b37d88672923ffb56949d640">FlowGetDisruptionFlags</a> (const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:aca700f93b37d88672923ffb56949d640"><td class="mdescLeft">&#160;</td><td class="mdescRight">get 'disruption' flags: GAP/DEPTH/PASS  <a href="flow_8c.html#aca700f93b37d88672923ffb56949d640">More...</a><br /></td></tr>
<tr class="separator:aca700f93b37d88672923ffb56949d640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a8bb5ef11dfae0a58d0524514cf585"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a09a8bb5ef11dfae0a58d0524514cf585">FlowUpdateState</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, const enum <a class="el" href="flow_8h.html#a1a5d3ef4270e82acfb6d302c9ad7628a">FlowState</a> s)</td></tr>
<tr class="separator:a09a8bb5ef11dfae0a58d0524514cf585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2af6cfce51f793347ed86195dcba90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a5d2af6cfce51f793347ed86195dcba90">FlowGetLastTimeAsParts</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *flow, uint64_t *secs, uint64_t *usecs)</td></tr>
<tr class="memdesc:a5d2af6cfce51f793347ed86195dcba90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow last time as individual values.  <a href="flow_8c.html#a5d2af6cfce51f793347ed86195dcba90">More...</a><br /></td></tr>
<tr class="separator:a5d2af6cfce51f793347ed86195dcba90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe6b9dbb34d54eeb479510a802e4e63"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6fe6b9dbb34d54eeb479510a802e4e63">FlowGetSourcePort</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *flow)</td></tr>
<tr class="memdesc:a6fe6b9dbb34d54eeb479510a802e4e63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow source port.  <a href="flow_8c.html#a6fe6b9dbb34d54eeb479510a802e4e63">More...</a><br /></td></tr>
<tr class="separator:a6fe6b9dbb34d54eeb479510a802e4e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63796c272bf6abb0b5d555900625449"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ae63796c272bf6abb0b5d555900625449">FlowGetDestinationPort</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *flow)</td></tr>
<tr class="memdesc:ae63796c272bf6abb0b5d555900625449"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow destination port.  <a href="flow_8c.html#ae63796c272bf6abb0b5d555900625449">More...</a><br /></td></tr>
<tr class="separator:ae63796c272bf6abb0b5d555900625449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99983b058dae46de007d9a0b21e304e2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a99983b058dae46de007d9a0b21e304e2">FlowGetFlags</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *flow)</td></tr>
<tr class="memdesc:a99983b058dae46de007d9a0b21e304e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flow flags.  <a href="flow_8c.html#a99983b058dae46de007d9a0b21e304e2">More...</a><br /></td></tr>
<tr class="separator:a99983b058dae46de007d9a0b21e304e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa599f62b96cbd9c769d437cc1e9fbafa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#aa599f62b96cbd9c769d437cc1e9fbafa">flow_timeouts_normal</a> [<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td></tr>
<tr class="separator:aa599f62b96cbd9c769d437cc1e9fbafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf3199ad42928f322d3dcde2fa570d3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#abf3199ad42928f322d3dcde2fa570d3a">flow_timeouts_emerg</a> [<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td></tr>
<tr class="separator:abf3199ad42928f322d3dcde2fa570d3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54fce776d70c165d5318fb975d5735f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a54fce776d70c165d5318fb975d5735f5">flow_timeouts_delta</a> [<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td></tr>
<tr class="separator:a54fce776d70c165d5318fb975d5735f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add2c2188b1c722a21ab6f81680b4ceee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#ab7acd87ebcac3213ba1285ec8ca9cca1">FlowProtoFreeFunc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#add2c2188b1c722a21ab6f81680b4ceee">flow_freefuncs</a> [<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td></tr>
<tr class="separator:add2c2188b1c722a21ab6f81680b4ceee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9877c02e96fcbbf1f712942ed49fcc0c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a77bc67eb87fd1881f59c9a222af908a6">FlowConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a9877c02e96fcbbf1f712942ed49fcc0c">flow_config</a></td></tr>
<tr class="separator:a9877c02e96fcbbf1f712942ed49fcc0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc33a1b111d68d2889fc1effbc254f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a5fc33a1b111d68d2889fc1effbc254f1">run_mode</a></td></tr>
<tr class="separator:a5fc33a1b111d68d2889fc1effbc254f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a></dd></dl>
<p>Flow implementation. </p>

<p class="definition">Definition in file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3232d5ee2fdb2b5ffd2be3bdbbf4f18b" name="a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3232d5ee2fdb2b5ffd2be3bdbbf4f18b">&#9670;&nbsp;</a></span>FLOW_DEFAULT_EMERGENCY_RECOVERY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_EMERGENCY_RECOVERY&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00070">70</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

</div>
</div>
<a id="a896f8fb0988876b52fba26b36f46e61a" name="a896f8fb0988876b52fba26b36f46e61a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896f8fb0988876b52fba26b36f46e61a">&#9670;&nbsp;</a></span>FLOW_DEFAULT_HASHSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_HASHSIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00073">73</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

</div>
</div>
<a id="a0527582503a0d59bcfc0c3392d336e9e" name="a0527582503a0d59bcfc0c3392d336e9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0527582503a0d59bcfc0c3392d336e9e">&#9670;&nbsp;</a></span>FLOW_DEFAULT_MEMCAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_MEMCAP&#160;&#160;&#160;(32 * 1024 * 1024) /* 32 MB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00075">75</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

</div>
</div>
<a id="af279bea0e0bad43d54b60bbf8743942c" name="af279bea0e0bad43d54b60bbf8743942c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af279bea0e0bad43d54b60bbf8743942c">&#9670;&nbsp;</a></span>FLOW_DEFAULT_PREALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_PREALLOC&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00077">77</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

</div>
</div>
<a id="a660c7deee17f0877a88e37913f9bf8fd" name="a660c7deee17f0877a88e37913f9bf8fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660c7deee17f0877a88e37913f9bf8fd">&#9670;&nbsp;</a></span>SET_DEFAULTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_DEFAULTS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ne, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ee, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ce, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">be&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_variable" href="flow_8c.html#aa599f62b96cbd9c769d437cc1e9fbafa">flow_timeouts_normal</a>[(p)].new_timeout = (n);     \</div>
<div class="line">    flow_timeouts_normal[(p)].est_timeout = (e);     \</div>
<div class="line">    flow_timeouts_normal[(p)].closed_timeout = (c);  \</div>
<div class="line">    flow_timeouts_normal[(p)].bypassed_timeout = (b); \</div>
<div class="line">    flow_timeouts_emerg[(p)].new_timeout = (ne);     \</div>
<div class="line">    flow_timeouts_emerg[(p)].est_timeout = (ee);     \</div>
<div class="line">    flow_timeouts_emerg[(p)].closed_timeout = (ce); \</div>
<div class="line">    flow_timeouts_emerg[(p)].bypassed_timeout = (be); \</div>
<div class="ttc" id="aflow_8c_html_aa599f62b96cbd9c769d437cc1e9fbafa"><div class="ttname"><a href="flow_8c.html#aa599f62b96cbd9c769d437cc1e9fbafa">flow_timeouts_normal</a></div><div class="ttdeci">FlowProtoTimeout flow_timeouts_normal[FLOW_PROTO_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="flow_8c_source.html#l00094">flow.c:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acc4e426d680d8624300a2e3d8dfeffec" name="acc4e426d680d8624300a2e3d8dfeffec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4e426d680d8624300a2e3d8dfeffec">&#9670;&nbsp;</a></span>FlowChangeProto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowChangeProto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if change proto flag is set for flow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>change proto flag is set </td></tr>
    <tr><td class="paramname">0</td><td>change proto flag is not set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00213">213</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, and <a class="el" href="flow_8h_source.html#l00104">FLOW_CHANGE_PROTO</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer_8c_source.html#l00638">AppLayerHandleTCPData()</a>, <a class="el" href="app-layer-detect-proto_8c_source.html#l01960">AppLayerRequestProtocolChange()</a>, and <a class="el" href="fuzz__applayerparserparse_8c_source.html#l00066">LLVMFuzzerTestOneInput()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_acc4e426d680d8624300a2e3d8dfeffec_icgraph.png" border="0" usemap="#aflow_8c_acc4e426d680d8624300a2e3d8dfeffec_icgraph" alt=""/></div>
<map name="aflow_8c_acc4e426d680d8624300a2e3d8dfeffec_icgraph" id="aflow_8c_acc4e426d680d8624300a2e3d8dfeffec_icgraph">
<area shape="rect" title="Check if change proto flag is set for flow." alt="" coords="567,56,693,83"/>
<area shape="rect" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app&#45;layer." alt="" coords="323,5,496,32"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a67bbf15efd64f1df267f175488524b74" title="request applayer to wrap up this protocol and rerun protocol detection." alt="" coords="300,56,519,83"/>
<area shape="rect" href="fuzz__applayerparserparse_8c.html#a91ce7c16e9840492202299da2b451e60" title=" " alt="" coords="323,107,496,133"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a89fdc683cf890121b3aecc81bedc0bd8" title="Update the stream reassembly upon receiving a packet." alt="" coords="23,5,235,32"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a1aadd5cb1b81b36f54302f54ada9524c" title="request applayer to wrap up this protocol and rerun protocol detection with expectation of TLS...." alt="" coords="5,56,252,83"/>
</map>
</div>

</div>
</div>
<a id="ac544802aadaf9306d54a61942d3e597d" name="ac544802aadaf9306d54a61942d3e597d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac544802aadaf9306d54a61942d3e597d">&#9670;&nbsp;</a></span>FlowCleanupAppLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowCleanupAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00143">143</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00485">Flow_::alparser</a>, <a class="el" href="flow_8h_source.html#l00486">Flow_::alstate</a>, <a class="el" href="app-layer-parser_8c_source.html#l01577">AppLayerParserStateCleanup()</a>, and <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph.png" border="0" usemap="#aflow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph" alt=""/></div>
<map name="aflow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph" id="aflow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,159,39"/>
<area shape="rect" href="app-layer-parser_8c.html#a9a475acbb179fd7b4f826f8eb5a4401c" title=" " alt="" coords="207,13,401,39"/>
<area shape="rect" href="app-layer-parser_8c.html#ac2c97903a2fe9261b63a1efcec6b79a0" title=" " alt="" coords="449,5,627,47"/>
</map>
</div>

</div>
</div>
<a id="a6e9eb43b74a70300e86da9c025705b1a" name="a6e9eb43b74a70300e86da9c025705b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e9eb43b74a70300e86da9c025705b1a">&#9670;&nbsp;</a></span>FlowClearMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowClearMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function clear the flow memory before queueing it to spare flow queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>pointer to the flow needed to be cleared. </td></tr>
    <tr><td class="paramname">proto_map</td><td>mapped value of the protocol to FLOW_PROTO's. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01087">1087</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer-expectation_8c_source.html#l00363">AppLayerExpectationClean()</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow_8c_source.html#l00097">flow_freefuncs</a>, <a class="el" href="flow_8h_source.html#l00110">FLOW_HAS_EXPECTATION</a>, <a class="el" href="flow-util_8h_source.html#l00082">FLOW_RECYCLE</a>, <a class="el" href="flow-storage_8c_source.html#l00059">FlowFreeStorage()</a>, <a class="el" href="flow_8h_source.html#l00531">FlowProtoFreeFunc_::Freefunc</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00653">FlowReset()</a>, and <a class="el" href="flow_8c_source.html#l00671">FlowShutdown()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph.png" border="0" usemap="#aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph" alt=""/></div>
<map name="aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph" id="aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph">
<area shape="rect" title="Function clear the flow memory before queueing it to spare flow queue." alt="" coords="5,31,133,57"/>
<area shape="rect" href="group__applayerexpectation.html#ga021149ff14858903860941e3486dbe1c" title=" " alt="" coords="181,5,361,32"/>
<area shape="rect" href="flow-storage_8c.html#aa43aab9054b3dd6ca65eb1b37acfcf13" title=" " alt="" coords="211,56,332,83"/>
<area shape="rect" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title=" " alt="" coords="409,31,531,57"/>
<area shape="rect" href="util-storage_8c.html#a842a9a77b4fb19baf4b10fc9ed2bd3fb" title=" " alt="" coords="416,81,524,108"/>
<area shape="rect" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers" alt="" coords="579,31,693,57"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph.png" border="0" usemap="#aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph" alt=""/></div>
<map name="aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph" id="aflow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph">
<area shape="rect" title="Function clear the flow memory before queueing it to spare flow queue." alt="" coords="161,31,289,57"/>
<area shape="rect" href="flow_8c.html#adc1589cef09521a8894aed9e365b5f7a" title=" " alt="" coords="17,5,102,32"/>
<area shape="rect" href="flow_8c.html#a8dae51c56800ed0e22279e49913cd15a" title="shutdown the flow engine" alt="" coords="5,56,113,83"/>
</map>
</div>

</div>
</div>
<a id="a1135a66e64bd8fe19166c853ea0e7986" name="a1135a66e64bd8fe19166c853ea0e7986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1135a66e64bd8fe19166c853ea0e7986">&#9670;&nbsp;</a></span>FlowGetAppProtocol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> FlowGetAppProtocol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01124">1124</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00460">Flow_::alproto</a>.</p>

<p class="reference">Referenced by <a class="el" href="output-json-file_8c_source.html#l00083">JsonBuildFileInfoRecord()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph.png" border="0" usemap="#aflow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph" alt=""/></div>
<map name="aflow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph" id="aflow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph">
<area shape="rect" title=" " alt="" coords="217,5,360,32"/>
<area shape="rect" href="output-json-file_8c.html#a37812367499afb3f54a48b34f0593a45" title=" " alt="" coords="5,5,169,32"/>
</map>
</div>

</div>
</div>
<a id="aaff1b494b285d88cce9ea42219601b04" name="aaff1b494b285d88cce9ea42219601b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff1b494b285d88cce9ea42219601b04">&#9670;&nbsp;</a></span>FlowGetAppState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * FlowGetAppState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01129">1129</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00486">Flow_::alstate</a>.</p>

<p class="reference">Referenced by <a class="el" href="detect-engine-state_8c_source.html#l00286">DetectEngineStateResetTxs()</a>, <a class="el" href="output-json-email-common_8c_source.html#l00379">EveEmailAddMetadata()</a>, <a class="el" href="output-json-http2_8c_source.html#l00065">EveHTTP2AddMetadata()</a>, <a class="el" href="output-json-http_8c_source.html#l00515">EveHttpAddMetadata()</a>, <a class="el" href="output-json-http_8c_source.html#l00435">EveHttpLogJSONBodyBase64()</a>, <a class="el" href="output-json-http_8c_source.html#l00404">EveHttpLogJSONBodyPrintable()</a>, <a class="el" href="output-json-ike_8c_source.html#l00065">EveIKEAddMetadata()</a>, <a class="el" href="output-json-nfs_8c_source.html#l00062">EveNFSAddMetadata()</a>, <a class="el" href="output-json-nfs_8c_source.html#l00050">EveNFSAddMetadataRPC()</a>, <a class="el" href="output-json-smb_8c_source.html#l00049">EveSMBAddMetadata()</a>, <a class="el" href="output-json-smtp_8c_source.html#l00096">EveSMTPAddMetadata()</a>, <a class="el" href="app-layer-htp-xff_8c_source.html#l00177">HttpXFFGetIP()</a>, <a class="el" href="app-layer-htp-xff_8c_source.html#l00113">HttpXFFGetIPFromTx()</a>, <a class="el" href="output-json-modbus_8c_source.html#l00139">JsonModbusAddMetadata()</a>, <a class="el" href="output-json-mqtt_8c_source.html#l00062">JsonMQTTAddMetadata()</a>, <a class="el" href="output-json-quic_8c_source.html#l00143">JsonQuicAddMetadata()</a>, <a class="el" href="output-json-rfb_8c_source.html#l00049">JsonRFBAddMetadata()</a>, and <a class="el" href="output-json-sip_8c_source.html#l00051">JsonSIPAddMetadata()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_aaff1b494b285d88cce9ea42219601b04_icgraph.png" border="0" usemap="#aflow_8c_aaff1b494b285d88cce9ea42219601b04_icgraph" alt=""/></div>
<map name="aflow_8c_aaff1b494b285d88cce9ea42219601b04_icgraph" id="aflow_8c_aaff1b494b285d88cce9ea42219601b04_icgraph">
<area shape="rect" title=" " alt="" coords="473,436,599,463"/>
<area shape="rect" href="group__sigstate.html#gabf15c37dbdf92918d6f107087ff082fb" title="Reset de state for active tx&#39; To be used on detect engine reload." alt="" coords="227,5,416,32"/>
<area shape="rect" href="output-json-email-common_8c.html#aba9d5265d524d05894ad1bf8ec2c29dc" title=" " alt="" coords="244,56,399,83"/>
<area shape="rect" href="output-json-http2_8c.html#a7c8841fc39b0cf61f678934535b6a6c7" title=" " alt="" coords="239,107,403,133"/>
<area shape="rect" href="output-json-http_8c.html#a150ae830824b1f4da051e48269eff10c" title=" " alt="" coords="248,157,395,184"/>
<area shape="rect" href="output-json-http_8c.html#a728042efcd468d3387721bac1a6d9739" title=" " alt="" coords="221,208,422,235"/>
<area shape="rect" href="output-json-http_8c.html#a13001cd4bfbbd2ecc10e81a0f8b761c6" title=" " alt="" coords="217,259,425,285"/>
<area shape="rect" href="output-json-ike_8c.html#a4dcb329fb7dfb176c77a5f93c97e156f" title=" " alt="" coords="249,309,393,336"/>
<area shape="rect" href="output-json-nfs_8c.html#a5334d14e4fa1bff666d582f91d14653f" title=" " alt="" coords="247,360,396,387"/>
<area shape="rect" href="output-json-nfs_8c.html#ae0c3235fc6df3b4cfdbc733c18b9e801" title=" " alt="" coords="232,411,411,437"/>
<area shape="rect" href="output-json-smb_8c.html#ac3230533453dafa69198ae1cf9aeeb8f" title=" " alt="" coords="246,461,397,488"/>
<area shape="rect" href="output-json-smtp_8c.html#adc3a786d2d1dfb6687c72053c1902d3b" title=" " alt="" coords="243,512,400,539"/>
<area shape="rect" href="app-layer-htp-xff_8c.html#a5d3e5ca11f5fa0968c8301dc3c5393f8" title="Function to return XFF IP if any. The caller needs to lock the flow." alt="" coords="34,588,141,615"/>
<area shape="rect" href="app-layer-htp-xff_8c.html#a168668dcb6d5509a5b9435b1974e1064" title="Function to return XFF IP if any in the selected transaction. The caller needs to lock the flow." alt="" coords="246,563,397,589"/>
<area shape="rect" href="output-json-modbus_8c.html#aa81d500edaf1bd48798087c837f36344" title=" " alt="" coords="235,664,408,691"/>
<area shape="rect" href="output-json-mqtt_8c.html#acb67cfe4f39b4243ec412436525889be" title=" " alt="" coords="240,715,403,741"/>
<area shape="rect" href="output-json-quic_8c.html#ad2eabdf7fe1ae24475eaa9fea97eb405" title=" " alt="" coords="244,765,399,792"/>
<area shape="rect" href="output-json-rfb_8c.html#aa807d6fd8ea09a06ce0439f2ede272c9" title=" " alt="" coords="244,816,399,843"/>
<area shape="rect" href="output-json-sip_8c.html#a0d11ded9d6daf16f16ebbf575f752308" title=" " alt="" coords="248,867,395,893"/>
<area shape="rect" href="output-json-file_8c.html#a37812367499afb3f54a48b34f0593a45" title=" " alt="" coords="5,385,169,412"/>
</map>
</div>

</div>
</div>
<a id="ae63796c272bf6abb0b5d555900625449" name="ae63796c272bf6abb0b5d555900625449"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae63796c272bf6abb0b5d555900625449">&#9670;&nbsp;</a></span>FlowGetDestinationPort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t FlowGetDestinationPort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get flow destination port. </p>
<p >A function to get the flow dport useful when the caller only has an opaque pointer to the flow structure. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01220">1220</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00369">Flow_::dp</a>.</p>

</div>
</div>
<a id="aca700f93b37d88672923ffb56949d640" name="aca700f93b37d88672923ffb56949d640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca700f93b37d88672923ffb56949d640">&#9670;&nbsp;</a></span>FlowGetDisruptionFlags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t FlowGetDisruptionFlags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get 'disruption' flags: GAP/DEPTH/PASS </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
    <tr><td class="paramname">flags</td><td>existing flags to be ammended </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">flags</td><td>original flags + disrupt flags (if any) \TODO handle UDP </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01141">1141</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="decode-gre_8h_source.html#l00000">flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00215">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>.</p>

</div>
</div>
<a id="a99983b058dae46de007d9a0b21e304e2" name="a99983b058dae46de007d9a0b21e304e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99983b058dae46de007d9a0b21e304e2">&#9670;&nbsp;</a></span>FlowGetFlags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t FlowGetFlags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get flow flags. </p>
<p >A function to get the flow flags useful when the caller only has an opaque pointer to the flow structure. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01231">1231</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>.</p>

</div>
</div>
<a id="a5d2af6cfce51f793347ed86195dcba90" name="a5d2af6cfce51f793347ed86195dcba90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2af6cfce51f793347ed86195dcba90">&#9670;&nbsp;</a></span>FlowGetLastTimeAsParts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowGetLastTimeAsParts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>secs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>usecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get flow last time as individual values. </p>
<p >Instead of returning a pointer to the timeval copy the timeval parts into output pointers to make it simpler to call from Rust over FFI using only basic data types. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01196">1196</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00414">Flow_::lastts</a>.</p>

</div>
</div>
<a id="aa462907be05f689a465cc2053472fce3" name="aa462907be05f689a465cc2053472fce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa462907be05f689a465cc2053472fce3">&#9670;&nbsp;</a></span>FlowGetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t FlowGetMemcap </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return memcap value. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">memcap</td><td>value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00131">131</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, and <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a id="a6edadd8447c63a43bd38a1e83af329b9" name="a6edadd8447c63a43bd38a1e83af329b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6edadd8447c63a43bd38a1e83af329b9">&#9670;&nbsp;</a></span>FlowGetMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t FlowGetMemuse </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00137">137</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a id="a6f7e81aaf61a41cdaa7cbb87d8964122" name="a6f7e81aaf61a41cdaa7cbb87d8964122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f7e81aaf61a41cdaa7cbb87d8964122">&#9670;&nbsp;</a></span>FlowGetPacketDirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowGetPacketDirection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine the direction of the packet compared to the flow </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>to_server </td></tr>
    <tr><td class="paramname">1</td><td>to_client </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00293">293</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00241">CMP_ADDR</a>, <a class="el" href="decode_8h_source.html#l00246">CMP_PORT</a>, <a class="el" href="decode_8h_source.html#l00449">Packet_::dp</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00108">FLOW_DIR_REVERSED</a>, <a class="el" href="decode_8h_source.html#l00456">Packet_::proto</a>, <a class="el" href="decode_8h_source.html#l00441">Packet_::sp</a>, <a class="el" href="flow_8h_source.html#l00358">Flow_::sp</a>, <a class="el" href="decode_8h_source.html#l00438">Packet_::src</a>, <a class="el" href="flow_8h_source.html#l00356">Flow_::src</a>, <a class="el" href="flow_8h_source.html#l00044">TOCLIENT</a>, and <a class="el" href="flow_8h_source.html#l00043">TOSERVER</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00391">FlowHandlePacketUpdate()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05348">StreamTcp()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph.png" border="0" usemap="#aflow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph" alt=""/></div>
<map name="aflow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph" id="aflow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph">
<area shape="rect" title="determine the direction of the packet compared to the flow" alt="" coords="228,31,392,57"/>
<area shape="rect" href="flow_8c.html#ae335b96119f82fcf93ca0bb0e2f1caad" title="Update Packet and Flow." alt="" coords="5,5,180,32"/>
<area shape="rect" href="stream-tcp_8c.html#ac608d6e0b3308d0b463a71fc3b287f48" title=" " alt="" coords="51,56,135,83"/>
</map>
</div>

</div>
</div>
<a id="a6fe6b9dbb34d54eeb479510a802e4e63" name="a6fe6b9dbb34d54eeb479510a802e4e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe6b9dbb34d54eeb479510a802e4e63">&#9670;&nbsp;</a></span>FlowGetSourcePort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t FlowGetSourcePort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get flow source port. </p>
<p >A function to get the flow sport useful when the caller only has an opaque pointer to the flow structure. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01208">1208</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00358">Flow_::sp</a>.</p>

</div>
</div>
<a id="a045986b2e6fe1d286361da7b08c03c7f" name="a045986b2e6fe1d286361da7b08c03c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045986b2e6fe1d286361da7b08c03c7f">&#9670;&nbsp;</a></span>FlowHandlePacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowHandlePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a2d77f0373e685ff430a8f029f070a749">FlowLookupStruct</a> *&#160;</td>
          <td class="paramname"><em>fls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point for packet flow handling. </p>
<p >This is called for every packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>threadvars </td></tr>
    <tr><td class="paramname">dtv</td><td>decode thread vars (for flow output api thread data) </td></tr>
    <tr><td class="paramname">p</td><td>packet to handle flow for </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00508">508</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow-hash_8c_source.html#l00743">FlowGetFlowFromHash()</a>, <a class="el" href="decode_8h_source.html#l01169">PKT_HAS_FLOW</a>, and <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-unittest-helper_8c_source.html#l00891">UTHBuildPacketOfFlows()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a045986b2e6fe1d286361da7b08c03c7f_cgraph.png" border="0" usemap="#aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_cgraph" alt=""/></div>
<map name="aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_cgraph" id="aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_cgraph">
<area shape="rect" title="Entry point for packet flow handling." alt="" coords="5,5,137,32"/>
<area shape="rect" href="flow-hash_8c.html#af46af06670840605dcd58e5432013a8f" title="Get Flow for packet." alt="" coords="185,5,345,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a045986b2e6fe1d286361da7b08c03c7f_icgraph.png" border="0" usemap="#aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_icgraph" alt=""/></div>
<map name="aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_icgraph" id="aflow_8c_a045986b2e6fe1d286361da7b08c03c7f_icgraph">
<area shape="rect" title="Entry point for packet flow handling." alt="" coords="223,5,355,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#af06fe2a36e13018d41be2a28357f3032" title=" " alt="" coords="5,5,175,32"/>
</map>
</div>

</div>
</div>
<a id="ae335b96119f82fcf93ca0bb0e2f1caad" name="ae335b96119f82fcf93ca0bb0e2f1caad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae335b96119f82fcf93ca0bb0e2f1caad">&#9670;&nbsp;</a></span>FlowHandlePacketUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowHandlePacketUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a96609a89ed9d99b4286354b153e72495">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update Packet and Flow. </p>
<p >Updates packet and flow based on the new packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
    <tr><td class="paramname">p</td><td>packet</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>overwrites p::flowflags </dd></dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00391">391</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow-bypass_8c_source.html#l00204">BypassedFlowUpdate()</a>, <a class="el" href="flow-util_8h_source.html#l00029">COPY_TIMESTAMP</a>, <a class="el" href="suricata_8c_source.html#l00258">EngineModeIsIPS()</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow-private_8h_source.html#l00067">FLOW_BYPASSED_TIMEOUT</a>, <a class="el" href="flow_8h_source.html#l00223">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00422">Flow_::flow_state</a>, <a class="el" href="flow_8h_source.html#l00512">FLOW_STATE_LOCAL_BYPASSED</a>, <a class="el" href="flow_8h_source.html#l00051">FLOW_TO_DST_SEEN</a>, <a class="el" href="decode_8h_source.html#l00465">Packet_::flowflags</a>, <a class="el" href="flow_8c_source.html#l00293">FlowGetPacketDirection()</a>, <a class="el" href="flow_8c_source.html#l01162">FlowUpdateState()</a>, <a class="el" href="decode_8h_source.html#l00226">GET_PKT_LEN</a>, <a class="el" href="flow_8h_source.html#l00414">Flow_::lastts</a>, <a class="el" href="decode_8h_source.html#l00595">Packet_::pcap_cnt</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="flow_8h_source.html#l00399">Flow_::timeout_at</a>, <a class="el" href="flow_8h_source.html#l00420">Flow_::timeout_policy</a>, <a class="el" href="flow_8h_source.html#l00504">Flow_::todstbytecnt</a>, <a class="el" href="flow_8h_source.html#l00502">Flow_::todstpktcnt</a>, <a class="el" href="flow_8h_source.html#l00043">TOSERVER</a>, and <a class="el" href="decode_8h_source.html#l00477">Packet_::ts</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ae335b96119f82fcf93ca0bb0e2f1caad_cgraph.png" border="0" usemap="#aflow_8c_ae335b96119f82fcf93ca0bb0e2f1caad_cgraph" alt=""/></div>
<map name="aflow_8c_ae335b96119f82fcf93ca0bb0e2f1caad_cgraph" id="aflow_8c_ae335b96119f82fcf93ca0bb0e2f1caad_cgraph">
<area shape="rect" title="Update Packet and Flow." alt="" coords="5,81,180,108"/>
<area shape="rect" href="flow-bypass_8c.html#a2410bb4efcaac403be88f41d54e0509a" title=" " alt="" coords="235,5,385,32"/>
<area shape="rect" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title=" " alt="" coords="247,56,373,83"/>
<area shape="rect" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow" alt="" coords="228,107,392,133"/>
<area shape="rect" href="flow_8c.html#a09a8bb5ef11dfae0a58d0524514cf585" title=" " alt="" coords="249,157,371,184"/>
</map>
</div>

</div>
</div>
<a id="a873c37d5d66c4345a30617709eb3b22c" name="a873c37d5d66c4345a30617709eb3b22c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a873c37d5d66c4345a30617709eb3b22c">&#9670;&nbsp;</a></span>FlowHasAlerts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowHasAlerts </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if flow has alerts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>has alerts </td></tr>
    <tr><td class="paramname">0</td><td>has not alerts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00181">181</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, and <a class="el" href="flow_8h_source.html#l00079">FLOW_HAS_ALERTS</a>.</p>

</div>
</div>
<a id="a2a649d2d3a9c0766202ee154aeee1d20" name="a2a649d2d3a9c0766202ee154aeee1d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a649d2d3a9c0766202ee154aeee1d20">&#9670;&nbsp;</a></span>FlowInitConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowInitConfig </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the configuration </p>
<dl class="section warning"><dt>Warning</dt><dd>Not thread safe </dd></dl>
<p >set config values for memcap, prealloc and hash_size</p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00524">524</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00045">CLS</a>, <a class="el" href="conf_8c_source.html#l00330">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00392">ConfGetInt()</a>, <a class="el" href="flow_8h_source.html#l00298">FlowCnf_::emergency_recovery</a>, <a class="el" href="util-exception-policy_8c_source.html#l00075">ExceptionPolicyParse()</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="flow-hash_8h_source.html#l00069">FBLOCK_INIT</a>, <a class="el" href="flow-util_8h_source.html#l00143">FLOW_CHECK_MEMCAP</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="flow_8c_source.html#l00070">FLOW_DEFAULT_EMERGENCY_RECOVERY</a>, <a class="el" href="flow_8c_source.html#l00073">FLOW_DEFAULT_HASHSIZE</a>, <a class="el" href="flow_8c_source.html#l00075">FLOW_DEFAULT_MEMCAP</a>, <a class="el" href="flow_8c_source.html#l00077">FLOW_DEFAULT_PREALLOC</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow-manager_8c_source.html#l00081">flow_recycle_q</a>, <a class="el" href="flow_8c_source.html#l00717">FlowInitFlowProto()</a>, <a class="el" href="flow-queue_8c_source.html#l00046">FlowQueueInit()</a>, <a class="el" href="flow-spare-pool_8c_source.html#l00245">FlowSparePoolInit()</a>, <a class="el" href="flow-storage_8c_source.html#l00034">FlowStorageSize()</a>, <a class="el" href="flow_8h_source.html#l00288">FlowCnf_::hash_rand</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, <a class="el" href="flow_8h_source.html#l00300">FlowCnf_::memcap_policy</a>, <a class="el" href="util-misc_8c_source.html#l00200">ParseSizeStringU64()</a>, <a class="el" href="flow_8h_source.html#l00291">FlowCnf_::prealloc</a>, <a class="el" href="util-random_8c_source.html#l00130">RandomGet()</a>, <a class="el" href="util-atomic_8h_source.html#l00333">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00315">SC_ATOMIC_INIT</a>, <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-error_8h_source.html#l00237">SC_ERR_FLOW_INIT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-error_8h_source.html#l00230">SC_ERR_SIZE_PARSE</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00255">SCLogError</a>, <a class="el" href="util-mem_8h_source.html#l00068">SCMallocAligned</a>, <a class="el" href="util-byte_8c_source.html#l00313">StringParseUint32()</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="suricata_8c_source.html#l02154">PreRunInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a2a649d2d3a9c0766202ee154aeee1d20_cgraph.png" border="0" usemap="#aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_cgraph" alt=""/></div>
<map name="aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_cgraph" id="aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_cgraph">
<area shape="rect" title="initialize the configuration" alt="" coords="5,236,112,262"/>
<area shape="rect" href="conf_8c.html#ab7638a53fd00da93228a4769b1efd635" title="Retrieve the value of a configuration node." alt="" coords="416,8,487,34"/>
<area shape="rect" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer." alt="" coords="192,58,279,85"/>
<area shape="rect" href="util-exception-policy_8c.html#aca33bad9c66e73b6d198b8d9614a00f6" title=" " alt="" coords="160,109,311,136"/>
<area shape="rect" href="flow_8c.html#a871212f9b59e814e9b4763644459247b" title="Function to set the default timeout, free function and flow state function for all supported flow_pro..." alt="" coords="172,160,299,186"/>
<area shape="rect" href="util-byte_8c.html#a54e03a2b649d2c8f4e7639e57911ea7d" title=" " alt="" coords="387,261,515,288"/>
<area shape="rect" href="flow-queue_8c.html#a9a1f1e1bba46d034cf99361b1dfe6f2b" title=" " alt="" coords="182,261,289,288"/>
<area shape="rect" href="flow-spare-pool_8c.html#adbf217f5736e6107da551b5412fbb17e" title=" " alt="" coords="171,312,299,338"/>
<area shape="rect" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title=" " alt="" coords="175,362,296,389"/>
<area shape="rect" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title=" " alt="" coords="165,413,305,440"/>
<area shape="rect" href="util-random_8c.html#a223e88772d48ffbc9803901d5e76115a" title=" " alt="" coords="189,464,281,490"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="617,46,720,73"/>
<area shape="rect" href="conf_8c.html#a8b6a513ab4ef3a716bddf0ff03ad5c17" title="Lookup a child configuration node by name." alt="" coords="592,122,745,149"/>
<area shape="rect" href="conf_8c.html#a5d08d07c040bbc30efc87a932b5ce72d" title="Lookup the value of a child configuration node by name." alt="" coords="359,160,544,186"/>
<area shape="rect" href="flow-manager_8c.html#a871d49df7366d2b0ba644133bfe6c5e4" title=" " alt="" coords="390,210,513,237"/>
<area shape="rect" href="util-byte_8c.html#a0da980c9303c35632a6f96dea14a6a50" title=" " alt="" coords="606,261,731,288"/>
<area shape="rect" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers" alt="" coords="394,362,509,389"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a2a649d2d3a9c0766202ee154aeee1d20_icgraph.png" border="0" usemap="#aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_icgraph" alt=""/></div>
<map name="aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_icgraph" id="aflow_8c_a2a649d2d3a9c0766202ee154aeee1d20_icgraph">
<area shape="rect" title="initialize the configuration" alt="" coords="137,5,244,32"/>
<area shape="rect" href="suricata_8c.html#a24ef7c82defde542c35c3c27e3c41106" title=" " alt="" coords="5,5,89,32"/>
</map>
</div>

</div>
</div>
<a id="a871212f9b59e814e9b4763644459247b" name="a871212f9b59e814e9b4763644459247b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871212f9b59e814e9b4763644459247b">&#9670;&nbsp;</a></span>FlowInitFlowProto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowInitFlowProto </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the default timeout, free function and flow state function for all supported flow_proto. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00717">717</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00527">FlowProtoTimeout_::bypassed_timeout</a>, <a class="el" href="flow_8h_source.html#l00526">FlowProtoTimeout_::closed_timeout</a>, <a class="el" href="conf_8c_source.html#l00175">ConfGetNode()</a>, <a class="el" href="conf_8c_source.html#l00770">ConfNodeLookupChild()</a>, <a class="el" href="conf_8c_source.html#l00798">ConfNodeLookupChildValue()</a>, <a class="el" href="flow_8h_source.html#l00525">FlowProtoTimeout_::est_timeout</a>, <a class="el" href="flow-private_8h_source.html#l00043">FLOW_DEFAULT_BYPASSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00058">FLOW_DEFAULT_EMERG_BYPASSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00056">FLOW_DEFAULT_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00055">FLOW_DEFAULT_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00041">FLOW_DEFAULT_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00040">FLOW_DEFAULT_NEW_TIMEOUT</a>, <a class="el" href="flow_8c_source.html#l00097">flow_freefuncs</a>, <a class="el" href="flow-private_8h_source.html#l00053">FLOW_IPPROTO_ICMP_BYPASSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00065">FLOW_IPPROTO_ICMP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00064">FLOW_IPPROTO_ICMP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00052">FLOW_IPPROTO_ICMP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00051">FLOW_IPPROTO_ICMP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00047">FLOW_IPPROTO_TCP_BYPASSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00046">FLOW_IPPROTO_TCP_CLOSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00061">FLOW_IPPROTO_TCP_EMERG_CLOSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00060">FLOW_IPPROTO_TCP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00059">FLOW_IPPROTO_TCP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00045">FLOW_IPPROTO_TCP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00044">FLOW_IPPROTO_TCP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00050">FLOW_IPPROTO_UDP_BYPASSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00063">FLOW_IPPROTO_UDP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00062">FLOW_IPPROTO_UDP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00049">FLOW_IPPROTO_UDP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00048">FLOW_IPPROTO_UDP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00073">FLOW_PROTO_DEFAULT</a>, <a class="el" href="flow-private_8h_source.html#l00072">FLOW_PROTO_ICMP</a>, <a class="el" href="flow-private_8h_source.html#l00076">FLOW_PROTO_MAX</a>, <a class="el" href="flow-private_8h_source.html#l00070">FLOW_PROTO_TCP</a>, <a class="el" href="flow-private_8h_source.html#l00071">FLOW_PROTO_UDP</a>, <a class="el" href="flow_8c_source.html#l00096">flow_timeouts_delta</a>, <a class="el" href="flow_8c_source.html#l00095">flow_timeouts_emerg</a>, <a class="el" href="flow_8c_source.html#l00094">flow_timeouts_normal</a>, <a class="el" href="flow-manager_8c_source.html#l00100">FlowTimeoutsInit()</a>, <a class="el" href="flow_8h_source.html#l00531">FlowProtoFreeFunc_::Freefunc</a>, <a class="el" href="flow_8h_source.html#l00524">FlowProtoTimeout_::new_timeout</a>, <a class="el" href="decode-template_8h_source.html#l00000">proto</a>, <a class="el" href="util-error_8h_source.html#l00192">SC_WARN_FLOW_EMERGENCY</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00242">SCLogWarning</a>, <a class="el" href="flow_8c.html#a660c7deee17f0877a88e37913f9bf8fd">SET_DEFAULTS</a>, and <a class="el" href="util-byte_8c_source.html#l00313">StringParseUint32()</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00524">FlowInitConfig()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a871212f9b59e814e9b4763644459247b_cgraph.png" border="0" usemap="#aflow_8c_a871212f9b59e814e9b4763644459247b_cgraph" alt=""/></div>
<map name="aflow_8c_a871212f9b59e814e9b4763644459247b_cgraph" id="aflow_8c_a871212f9b59e814e9b4763644459247b_cgraph">
<area shape="rect" title="Function to set the default timeout, free function and flow state function for all supported flow_pro..." alt="" coords="5,107,132,133"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="221,5,324,32"/>
<area shape="rect" href="conf_8c.html#a8b6a513ab4ef3a716bddf0ff03ad5c17" title="Lookup a child configuration node by name." alt="" coords="413,81,567,108"/>
<area shape="rect" href="conf_8c.html#a5d08d07c040bbc30efc87a932b5ce72d" title="Lookup the value of a child configuration node by name." alt="" coords="180,107,365,133"/>
<area shape="rect" href="flow-manager_8c.html#a871d49df7366d2b0ba644133bfe6c5e4" title=" " alt="" coords="211,157,334,184"/>
<area shape="rect" href="util-byte_8c.html#a54e03a2b649d2c8f4e7639e57911ea7d" title=" " alt="" coords="209,208,337,235"/>
<area shape="rect" href="util-byte_8c.html#a0da980c9303c35632a6f96dea14a6a50" title=" " alt="" coords="427,208,553,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a871212f9b59e814e9b4763644459247b_icgraph.png" border="0" usemap="#aflow_8c_a871212f9b59e814e9b4763644459247b_icgraph" alt=""/></div>
<map name="aflow_8c_a871212f9b59e814e9b4763644459247b_icgraph" id="aflow_8c_a871212f9b59e814e9b4763644459247b_icgraph">
<area shape="rect" title="Function to set the default timeout, free function and flow state function for all supported flow_pro..." alt="" coords="292,5,419,32"/>
<area shape="rect" href="flow_8c.html#a2a649d2d3a9c0766202ee154aeee1d20" title="initialize the configuration" alt="" coords="137,5,244,32"/>
<area shape="rect" href="suricata_8c.html#a24ef7c82defde542c35c3c27e3c41106" title=" " alt="" coords="5,5,89,32"/>
</map>
</div>

</div>
</div>
<a id="a4fa1db77ebc6f5bd811ccf151f1c8218" name="a4fa1db77ebc6f5bd811ccf151f1c8218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa1db77ebc6f5bd811ccf151f1c8218">&#9670;&nbsp;</a></span>FlowRegisterTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to register the Flow Unitests. </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01448">1448</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="util-unittest_8c_source.html#l00103">UtRegisterTest()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph.png" border="0" usemap="#aflow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph" alt=""/></div>
<map name="aflow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph" id="aflow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph">
<area shape="rect" title="Function to register the Flow Unitests." alt="" coords="5,5,136,32"/>
<area shape="rect" href="group__Testing.html#ga34617b41f44505d5c3938e4df12c264f" title="Register unit test." alt="" coords="184,5,295,32"/>
</map>
</div>

</div>
</div>
<a id="adc1589cef09521a8894aed9e365b5f7a" name="adc1589cef09521a8894aed9e365b5f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc1589cef09521a8894aed9e365b5f7a">&#9670;&nbsp;</a></span>FlowReset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowReset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00653">653</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow_8c_source.html#l01087">FlowClearMemory()</a>, <a class="el" href="flow-util_8c_source.html#l00081">FlowFree()</a>, <a class="el" href="flow-util_8c_source.html#l00096">FlowGetProtoMapping()</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, <a class="el" href="flow_8h_source.html#l00404">Flow_::next</a>, and <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_adc1589cef09521a8894aed9e365b5f7a_cgraph.png" border="0" usemap="#aflow_8c_adc1589cef09521a8894aed9e365b5f7a_cgraph" alt=""/></div>
<map name="aflow_8c_adc1589cef09521a8894aed9e365b5f7a_cgraph" id="aflow_8c_adc1589cef09521a8894aed9e365b5f7a_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,91,133"/>
<area shape="rect" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a" title="Function clear the flow memory before queueing it to spare flow queue." alt="" coords="150,56,278,83"/>
<area shape="rect" href="flow-util_8c.html#ae5fdd38c5ca6851df9ce87aee016ba54" title="cleanup &amp; free the memory of a flow" alt="" coords="389,107,465,133"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="139,157,289,184"/>
<area shape="rect" href="group__applayerexpectation.html#ga021149ff14858903860941e3486dbe1c" title=" " alt="" coords="337,5,517,32"/>
<area shape="rect" href="flow-storage_8c.html#aa43aab9054b3dd6ca65eb1b37acfcf13" title=" " alt="" coords="367,56,488,83"/>
<area shape="rect" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title=" " alt="" coords="565,107,687,133"/>
<area shape="rect" href="util-storage_8c.html#a842a9a77b4fb19baf4b10fc9ed2bd3fb" title=" " alt="" coords="572,56,680,83"/>
<area shape="rect" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers" alt="" coords="735,107,849,133"/>
</map>
</div>

</div>
</div>
<a id="ad5c9972bae4a5474a7f5fc785890ad40" name="ad5c9972bae4a5474a7f5fc785890ad40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5c9972bae4a5474a7f5fc785890ad40">&#9670;&nbsp;</a></span>FlowSetChangeProtoFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetChangeProtoFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set flag to indicate to change proto for the flow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00194">194</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, and <a class="el" href="flow_8h_source.html#l00104">FLOW_CHANGE_PROTO</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer-detect-proto_8c_source.html#l01960">AppLayerRequestProtocolChange()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ad5c9972bae4a5474a7f5fc785890ad40_icgraph.png" border="0" usemap="#aflow_8c_ad5c9972bae4a5474a7f5fc785890ad40_icgraph" alt=""/></div>
<map name="aflow_8c_ad5c9972bae4a5474a7f5fc785890ad40_icgraph" id="aflow_8c_ad5c9972bae4a5474a7f5fc785890ad40_icgraph">
<area shape="rect" title="Set flag to indicate to change proto for the flow." alt="" coords="567,5,737,32"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a67bbf15efd64f1df267f175488524b74" title="request applayer to wrap up this protocol and rerun protocol detection." alt="" coords="300,5,519,32"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a1aadd5cb1b81b36f54302f54ada9524c" title="request applayer to wrap up this protocol and rerun protocol detection with expectation of TLS...." alt="" coords="5,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="a5c8700403578f88dc8810437736ccd21" name="a5c8700403578f88dc8810437736ccd21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8700403578f88dc8810437736ccd21">&#9670;&nbsp;</a></span>FlowSetHasAlertsFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetHasAlertsFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set flag to indicate that flow has alerts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00170">170</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, and <a class="el" href="flow_8h_source.html#l00079">FLOW_HAS_ALERTS</a>.</p>

</div>
</div>
<a id="ac6025792807455fef29864c21cea6f38" name="ac6025792807455fef29864c21cea6f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6025792807455fef29864c21cea6f38">&#9670;&nbsp;</a></span>FlowSetIPOnlyFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetIPOnlyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the IPOnly scanned flag for 'direction'. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Flow to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00159">159</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00058">FLOW_TOCLIENT_IPONLY_SET</a>, and <a class="el" href="flow_8h_source.html#l00056">FLOW_TOSERVER_IPONLY_SET</a>.</p>

</div>
</div>
<a id="a68bb367eb352444ff5853171023c42e9" name="a68bb367eb352444ff5853171023c42e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68bb367eb352444ff5853171023c42e9">&#9670;&nbsp;</a></span>FlowSetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowSetMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update memcap value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>new memcap value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00116">116</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, and <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>.</p>

</div>
</div>
<a id="a05174d1570db7ee4b5a25f5ea7234e87" name="a05174d1570db7ee4b5a25f5ea7234e87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05174d1570db7ee4b5a25f5ea7234e87">&#9670;&nbsp;</a></span>FlowSetProtoFreeFunc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowSetProtoFreeFunc </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the function to get protocol specific flow state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>protocol of which function is needed to be set. </td></tr>
    <tr><td class="paramname">Free</td><td>Function pointer which will be called to free the protocol specific memory. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01115">1115</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8c_source.html#l00097">flow_freefuncs</a>, <a class="el" href="flow-util_8c_source.html#l00096">FlowGetProtoMapping()</a>, <a class="el" href="flow_8h_source.html#l00531">FlowProtoFreeFunc_::Freefunc</a>, and <a class="el" href="decode-template_8h_source.html#l00000">proto</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph.png" border="0" usemap="#aflow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph" alt=""/></div>
<map name="aflow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph" id="aflow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph">
<area shape="rect" title="Function to set the function to get protocol specific flow state." alt="" coords="5,5,161,32"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="209,5,360,32"/>
</map>
</div>

</div>
</div>
<a id="a8dae51c56800ed0e22279e49913cd15a" name="a8dae51c56800ed0e22279e49913cd15a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dae51c56800ed0e22279e49913cd15a">&#9670;&nbsp;</a></span>FlowShutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowShutdown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shutdown the flow engine </p>
<dl class="section warning"><dt>Warning</dt><dd>Not thread safe </dd></dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00671">671</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="flow-hash_8h_source.html#l00070">FBLOCK_DESTROY</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow-manager_8c_source.html#l00081">flow_recycle_q</a>, <a class="el" href="flow_8c_source.html#l01087">FlowClearMemory()</a>, <a class="el" href="flow-queue_8c_source.html#l00191">FlowDequeue()</a>, <a class="el" href="flow-util_8c_source.html#l00081">FlowFree()</a>, <a class="el" href="flow-util_8c_source.html#l00096">FlowGetProtoMapping()</a>, <a class="el" href="flow-queue_8c_source.html#l00060">FlowQueueDestroy()</a>, <a class="el" href="flow-spare-pool_8c_source.html#l00264">FlowSparePoolDestroy()</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, <a class="el" href="flow_8h_source.html#l00404">Flow_::next</a>, <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>, <a class="el" href="util-atomic_8h_source.html#l00342">SC_ATOMIC_SUB</a>, <a class="el" href="util-mem_8h_source.html#l00077">SCFreeAligned</a>, and <a class="el" href="flow_8h_source.html#l00383">Flow_::use_cnt</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph.png" border="0" usemap="#aflow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph" alt=""/></div>
<map name="aflow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph" id="aflow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph">
<area shape="rect" title="shutdown the flow engine" alt="" coords="5,183,113,209"/>
<area shape="rect" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a" title="Function clear the flow memory before queueing it to spare flow queue." alt="" coords="175,56,303,83"/>
<area shape="rect" href="flow-queue_8c.html#a769580307c499073e4cd5d6d933b9a69" title="remove a flow from the queue" alt="" coords="188,107,291,133"/>
<area shape="rect" href="flow-util_8c.html#ae5fdd38c5ca6851df9ce87aee016ba54" title="cleanup &amp; free the memory of a flow" alt="" coords="428,157,504,184"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="164,208,315,235"/>
<area shape="rect" href="flow-queue_8c.html#abb7a23ee9c1efb31ee74ed7de5603655" title="Destroy a flow queue." alt="" coords="172,259,307,285"/>
<area shape="rect" href="flow-spare-pool_8c.html#a4de3de72ebccab2e657a3db011f11df5" title=" " alt="" coords="161,309,317,336"/>
<area shape="rect" href="group__applayerexpectation.html#ga021149ff14858903860941e3486dbe1c" title=" " alt="" coords="376,5,556,32"/>
<area shape="rect" href="flow-storage_8c.html#aa43aab9054b3dd6ca65eb1b37acfcf13" title=" " alt="" coords="405,56,527,83"/>
<area shape="rect" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title=" " alt="" coords="615,132,736,159"/>
<area shape="rect" href="util-storage_8c.html#a842a9a77b4fb19baf4b10fc9ed2bd3fb" title=" " alt="" coords="621,56,729,83"/>
<area shape="rect" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers" alt="" coords="784,132,899,159"/>
<area shape="rect" href="flow-queue_8c.html#a2d5901655f45e9f2f6484e1bb7a1481e" title=" " alt="" coords="365,107,567,133"/>
</map>
</div>

</div>
</div>
<a id="af7e814b4efead88c5e176c76ba3a90ce" name="af7e814b4efead88c5e176c76ba3a90ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e814b4efead88c5e176c76ba3a90ce">&#9670;&nbsp;</a></span>FlowSwap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSwap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>swap the flow's direction </p>
<dl class="section note"><dt>Note</dt><dd>leaves the 'header' untouched. Interpret that based on FLOW_DIR_REVERSED flag. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>: only valid before applayer parsing started. This function doesn't swap anything in <a class="el" href="structFlow__.html#a9997ffc30e4a73597b349f81bb12efe2">Flow::alparser</a>, <a class="el" href="structFlow__.html#a6146ef01d2fae1b25d13aa70546020e0">Flow::alstate</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00262">262</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00108">FLOW_DIR_REVERSED</a>, <a class="el" href="flow_8h_source.html#l00429">Flow_::probing_parser_toclient_alproto_masks</a>, <a class="el" href="flow_8h_source.html#l00428">Flow_::probing_parser_toserver_alproto_masks</a>, and <a class="el" href="suricata-common_8h_source.html#l00409">SWAP_VARS</a>.</p>

</div>
</div>
<a id="a71829515c7880d4089d0fb8422f2f912" name="a71829515c7880d4089d0fb8422f2f912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71829515c7880d4089d0fb8422f2f912">&#9670;&nbsp;</a></span>FlowUnsetChangeProtoFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowUnsetChangeProtoFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unset flag to indicate to change proto for the flow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00203">203</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer_8c_source.html#l00638">AppLayerHandleTCPData()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a71829515c7880d4089d0fb8422f2f912_icgraph.png" border="0" usemap="#aflow_8c_a71829515c7880d4089d0fb8422f2f912_icgraph" alt=""/></div>
<map name="aflow_8c_a71829515c7880d4089d0fb8422f2f912_icgraph" id="aflow_8c_a71829515c7880d4089d0fb8422f2f912_icgraph">
<area shape="rect" title="Unset flag to indicate to change proto for the flow." alt="" coords="487,5,673,32"/>
<area shape="rect" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app&#45;layer." alt="" coords="265,5,439,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a89fdc683cf890121b3aecc81bedc0bd8" title="Update the stream reassembly upon receiving a packet." alt="" coords="5,5,217,32"/>
</map>
</div>

</div>
</div>
<a id="a09a8bb5ef11dfae0a58d0524514cf585" name="a09a8bb5ef11dfae0a58d0524514cf585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a8bb5ef11dfae0a58d0524514cf585">&#9670;&nbsp;</a></span>FlowUpdateState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowUpdateState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum <a class="el" href="flow_8h.html#a1a5d3ef4270e82acfb6d302c9ad7628a">FlowState</a>&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l01162">1162</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00422">Flow_::flow_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00391">FlowHandlePacketUpdate()</a>, and <a class="el" href="decode_8c_source.html#l00444">PacketBypassCallback()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a09a8bb5ef11dfae0a58d0524514cf585_icgraph.png" border="0" usemap="#aflow_8c_a09a8bb5ef11dfae0a58d0524514cf585_icgraph" alt=""/></div>
<map name="aflow_8c_a09a8bb5ef11dfae0a58d0524514cf585_icgraph" id="aflow_8c_a09a8bb5ef11dfae0a58d0524514cf585_icgraph">
<area shape="rect" title=" " alt="" coords="228,31,351,57"/>
<area shape="rect" href="flow_8c.html#ae335b96119f82fcf93ca0bb0e2f1caad" title="Update Packet and Flow." alt="" coords="5,5,180,32"/>
<area shape="rect" href="group__decode.html#gafcf1aaa5cea0ff80abc127acdd6a0b51" title=" " alt="" coords="13,56,172,83"/>
</map>
</div>

</div>
</div>
<a id="a5be27ced6ce47397200c22dff29ab700" name="a5be27ced6ce47397200c22dff29ab700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5be27ced6ce47397200c22dff29ab700">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow-private_8h.html#aa13286f5b61ee2cf7a7a03171a5d151d">FlowProtoTimeoutPtr</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_timeouts&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f09029b35eab2a1b1034383d9c1e59f" name="a9f09029b35eab2a1b1034383d9c1e59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f09029b35eab2a1b1034383d9c1e59f">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >flow memuse counter (atomic), for enforcing memcap limit </p>

</div>
</div>
<a id="a00a3c29e500a18c716b94d6975c58009" name="a00a3c29e500a18c716b94d6975c58009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a3c29e500a18c716b94d6975c58009">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_flags&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >atomic flags </p>

</div>
</div>
<a id="a042231529464e85eb0482c00c0cd114f" name="a042231529464e85eb0482c00c0cd114f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a042231529464e85eb0482c00c0cd114f">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_prune_idx&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >atomic int that is used when freeing a flow from the hash. In this case we walk the hash to find a flow to free. This var records where we left off in the hash. Without this only the top rows of the hash are freed. This isn't just about fairness. Under severe presure, the hash rows on top would be all freed and the time to find a flow to free increased with every run. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9877c02e96fcbbf1f712942ed49fcc0c" name="a9877c02e96fcbbf1f712942ed49fcc0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9877c02e96fcbbf1f712942ed49fcc0c">&#9670;&nbsp;</a></span>flow_config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a77bc67eb87fd1881f59c9a222af908a6">FlowConfig</a> flow_config</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00099">99</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-hash_8c_source.html#l00935">FlowGetExistingFlowFromHash()</a>, <a class="el" href="flow-hash_8c_source.html#l00743">FlowGetFlowFromHash()</a>, <a class="el" href="flow-hash_8c_source.html#l00873">FlowGetFromFlowKey()</a>, <a class="el" href="flow_8c_source.html#l00131">FlowGetMemcap()</a>, <a class="el" href="flow_8c_source.html#l00524">FlowInitConfig()</a>, <a class="el" href="flow-hash_8c_source.html#l00227">FlowKeyGetHash()</a>, <a class="el" href="flow_8c_source.html#l00653">FlowReset()</a>, <a class="el" href="flow_8c_source.html#l00116">FlowSetMemcap()</a>, <a class="el" href="flow_8c_source.html#l00671">FlowShutdown()</a>, and <a class="el" href="flow-spare-pool_8c_source.html#l00171">FlowSparePoolUpdate()</a>.</p>

</div>
</div>
<a id="add2c2188b1c722a21ab6f81680b4ceee" name="add2c2188b1c722a21ab6f81680b4ceee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add2c2188b1c722a21ab6f81680b4ceee">&#9670;&nbsp;</a></span>flow_freefuncs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#ab7acd87ebcac3213ba1285ec8ca9cca1">FlowProtoFreeFunc</a> flow_freefuncs[<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00097">97</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l01087">FlowClearMemory()</a>, <a class="el" href="flow_8c_source.html#l00717">FlowInitFlowProto()</a>, and <a class="el" href="flow_8c_source.html#l01115">FlowSetProtoFreeFunc()</a>.</p>

</div>
</div>
<a id="a54fce776d70c165d5318fb975d5735f5" name="a54fce776d70c165d5318fb975d5735f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54fce776d70c165d5318fb975d5735f5">&#9670;&nbsp;</a></span>flow_timeouts_delta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a> flow_timeouts_delta[<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00096">96</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00717">FlowInitFlowProto()</a>.</p>

</div>
</div>
<a id="abf3199ad42928f322d3dcde2fa570d3a" name="abf3199ad42928f322d3dcde2fa570d3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf3199ad42928f322d3dcde2fa570d3a">&#9670;&nbsp;</a></span>flow_timeouts_emerg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a> flow_timeouts_emerg[<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00095">95</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00717">FlowInitFlowProto()</a>, and <a class="el" href="flow-manager_8c_source.html#l00105">FlowTimeoutsEmergency()</a>.</p>

</div>
</div>
<a id="aa599f62b96cbd9c769d437cc1e9fbafa" name="aa599f62b96cbd9c769d437cc1e9fbafa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa599f62b96cbd9c769d437cc1e9fbafa">&#9670;&nbsp;</a></span>flow_timeouts_normal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a5d30f0c15f46eac6046d4240d370cda4">FlowProtoTimeout</a> flow_timeouts_normal[<a class="el" href="flow-private_8h.html#a1b7b7893d940926615b39239ac05829daedce7a334f296b3b82709611bc4eb99a">FLOW_PROTO_MAX</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >FlowProto specific timeouts and free/state functions </p>

<p class="definition">Definition at line <a class="el" href="flow_8c_source.html#l00094">94</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00717">FlowInitFlowProto()</a>, and <a class="el" href="flow-manager_8c_source.html#l00100">FlowTimeoutsInit()</a>.</p>

</div>
</div>
<a id="a5fc33a1b111d68d2889fc1effbc254f1" name="a5fc33a1b111d68d2889fc1effbc254f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc33a1b111d68d2889fc1effbc254f1">&#9670;&nbsp;</a></span>run_mode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int run_mode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Run mode selected </p>

<p class="definition">Definition at line <a class="el" href="suricata_8c_source.html#l00211">211</a> of file <a class="el" href="suricata_8c_source.html">suricata.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="flow_8c.html">flow.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:23 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
