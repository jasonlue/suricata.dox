<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/util-spm-bs.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('util-spm-bs_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">util-spm-bs.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-spm-bs_8h_source.html">util-spm-bs.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-spm-bs.c:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm-bs_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2util-spm-bs_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2util-spm-bs_8c" id="a_2Users_2jlu_2suricata_2src_2util-spm-bs_8c">
<area shape="rect" title=" " alt="" coords="492,5,620,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="533,169,667,196"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="123,393,213,420"/>
<area shape="rect" href="suricata_8h.html" title=" " alt="" coords="673,95,751,121"/>
<area shape="rect" href="util-spm-bs_8h.html" title=" " alt="" coords="551,95,649,121"/>
<area shape="rect" title=" " alt="" coords="1234,244,1299,271"/>
<area shape="rect" title=" " alt="" coords="1323,244,1402,271"/>
<area shape="rect" title=" " alt="" coords="118,244,183,271"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="207,244,310,271"/>
<area shape="rect" title=" " alt="" coords="334,244,407,271"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="358,468,434,495"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="851,244,1000,271"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="255,468,334,495"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="1024,244,1107,271"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="585,244,725,271"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="1131,244,1210,271"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="2837,319,2915,345"/>
<area shape="rect" href="util-cpu_8h.html" title=" " alt="" coords="359,543,433,569"/>
<area shape="rect" title=" " alt="" coords="194,543,270,569"/>
<area shape="rect" href="util-debug-filters_8h.html" title=" " alt="" coords="105,468,231,495"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1817,319,1892,345"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1916,319,1985,345"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="3143,393,3260,420"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="2881,393,2975,420"/>
<area shape="rect" href="decode-events_8h.html" title=" " alt="" coords="2999,393,3118,420"/>
<area shape="rect" href="flow-worker_8h.html" title=" " alt="" coords="3284,393,3383,420"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="3407,393,3534,420"/>
<area shape="rect" href="util-napatech_8h.html" title=" " alt="" coords="3559,393,3665,420"/>
<area shape="rect" href="source-nflog_8h.html" title=" " alt="" coords="433,393,537,420"/>
<area shape="rect" href="source-nfq_8h.html" title=" " alt="" coords="2063,393,2158,420"/>
<area shape="rect" href="source-ipfw_8h.html" title=" " alt="" coords="561,393,660,420"/>
<area shape="rect" href="source-pcap_8h.html" title=" " alt="" coords="684,393,788,420"/>
<area shape="rect" href="source-af-packet_8h.html" title=" " alt="" coords="812,393,943,420"/>
<area shape="rect" href="source-netmap_8h.html" title=" " alt="" coords="967,393,1086,420"/>
<area shape="rect" href="source-windivert_8h.html" title=" " alt="" coords="1111,393,1239,420"/>
<area shape="rect" href="action-globals_8h.html" title=" " alt="" coords="1263,393,1377,420"/>
<area shape="rect" href="decode-ethernet_8h.html" title=" " alt="" coords="1401,393,1527,420"/>
<area shape="rect" href="decode-gre_8h.html" title=" " alt="" coords="1551,393,1649,420"/>
<area shape="rect" href="decode-ppp_8h.html" title=" " alt="" coords="1673,393,1773,420"/>
<area shape="rect" href="decode-pppoe_8h.html" title=" " alt="" coords="1797,393,1912,420"/>
<area shape="rect" href="decode-ipv4_8h.html" title=" " alt="" coords="1937,393,2039,420"/>
<area shape="rect" href="decode-ipv6_8h.html" title=" " alt="" coords="2157,468,2259,495"/>
<area shape="rect" href="decode-icmpv4_8h.html" title=" " alt="" coords="2683,393,2805,420"/>
<area shape="rect" href="decode-tcp_8h.html" title=" " alt="" coords="2297,468,2394,495"/>
<area shape="rect" href="decode-udp_8h.html" title=" " alt="" coords="2694,468,2794,495"/>
<area shape="rect" href="decode-icmpv6_8h.html" title=" " alt="" coords="2285,393,2406,420"/>
<area shape="rect" href="decode-sctp_8h.html" title=" " alt="" coords="2431,393,2535,420"/>
<area shape="rect" href="decode-esp_8h.html" title=" " alt="" coords="2559,393,2659,420"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="3423,468,3481,495"/>
<area shape="rect" href="runmodes_8h.html" title=" " alt="" coords="691,169,781,196"/>
</map>
</div>
</div>
<p><a href="util-spm-bs_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a61e49fb45cc8dd4f84ac01733891ed58"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#a61e49fb45cc8dd4f84ac01733891ed58">BasicSearch</a> (const uint8_t *haystack, uint32_t haystack_len, const uint8_t *needle, uint16_t needle_len)</td></tr>
<tr class="memdesc:a61e49fb45cc8dd4f84ac01733891ed58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic search improved. Limits are better handled, so it doesn't start searches that wont fit in the remaining buffer.  <a href="util-spm-bs_8c.html#a61e49fb45cc8dd4f84ac01733891ed58">More...</a><br /></td></tr>
<tr class="separator:a61e49fb45cc8dd4f84ac01733891ed58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9570c29f9a0df2e3c79dbcc2f22fb5fc"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#a9570c29f9a0df2e3c79dbcc2f22fb5fc">BasicSearchNocase</a> (const uint8_t *haystack, uint32_t haystack_len, const uint8_t *needle, uint16_t needle_len)</td></tr>
<tr class="memdesc:a9570c29f9a0df2e3c79dbcc2f22fb5fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic search case less.  <a href="util-spm-bs_8c.html#a9570c29f9a0df2e3c79dbcc2f22fb5fc">More...</a><br /></td></tr>
<tr class="separator:a9570c29f9a0df2e3c79dbcc2f22fb5fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3959b973ce99a9e8ebf0491ffc8790"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#a3f3959b973ce99a9e8ebf0491ffc8790">BasicSearchInit</a> (void)</td></tr>
<tr class="separator:a3f3959b973ce99a9e8ebf0491ffc8790"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd>
<dd>
Pablo Rincon Crespo <a href="#" onclick="location.href='mai'+'lto:'+'pab'+'lo'+'.ri'+'nc'+'on.'+'cr'+'esp'+'o@'+'gma'+'il'+'.co'+'m'; return false;">pablo<span class="obfuscator">.nosp@m.</span>.rin<span class="obfuscator">.nosp@m.</span>con.c<span class="obfuscator">.nosp@m.</span>resp<span class="obfuscator">.nosp@m.</span>o@gma<span class="obfuscator">.nosp@m.</span>il.c<span class="obfuscator">.nosp@m.</span>om</a></dd></dl>
<p>bs is a bruteforce search. It will try to search the pattern from all characters until the available text len is less than the length of the pattern. It needs no context but it time cost is not good. </p>

<p class="definition">Definition in file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a61e49fb45cc8dd4f84ac01733891ed58" name="a61e49fb45cc8dd4f84ac01733891ed58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e49fb45cc8dd4f84ac01733891ed58">&#9670;&nbsp;</a></span>BasicSearch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * BasicSearch </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>haystack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>haystack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needle_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic search improved. Limits are better handled, so it doesn't start searches that wont fit in the remaining buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">haystack</td><td>pointer to the buffer to search in </td></tr>
    <tr><td class="paramname">haystack_len</td><td>length limit of the buffer </td></tr>
    <tr><td class="paramname">neddle</td><td>pointer to the pattern we ar searching for </td></tr>
    <tr><td class="paramname">needle_len</td><td>length limit of the needle</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>to start of the match; NULL if no match </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00048">48</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

<p class="reference">References <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="util-debug_8h_source.html#l00314">SCReturnPtr</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-unittest-helper_8c_source.html#l01004">UTHmemsearch()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm-bs_8c_a61e49fb45cc8dd4f84ac01733891ed58_icgraph.png" border="0" usemap="#autil-spm-bs_8c_a61e49fb45cc8dd4f84ac01733891ed58_icgraph" alt=""/></div>
<map name="autil-spm-bs_8c_a61e49fb45cc8dd4f84ac01733891ed58_icgraph" id="autil-spm-bs_8c_a61e49fb45cc8dd4f84ac01733891ed58_icgraph">
<area shape="rect" title="Basic search improved. Limits are better handled, so it doesn&#39;t start searches that wont fit in the r..." alt="" coords="172,5,268,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#a3366ec189b631105c61d531509103bdd" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="a3f3959b973ce99a9e8ebf0491ffc8790" name="a3f3959b973ce99a9e8ebf0491ffc8790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3959b973ce99a9e8ebf0491ffc8790">&#9670;&nbsp;</a></span>BasicSearchInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSearchInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00135">135</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

</div>
</div>
<a id="a9570c29f9a0df2e3c79dbcc2f22fb5fc" name="a9570c29f9a0df2e3c79dbcc2f22fb5fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9570c29f9a0df2e3c79dbcc2f22fb5fc">&#9670;&nbsp;</a></span>BasicSearchNocase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * BasicSearchNocase </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>haystack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>haystack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needle_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic search case less. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">haystack</td><td>pointer to the buffer to search in </td></tr>
    <tr><td class="paramname">haystack_len</td><td>length limit of the buffer </td></tr>
    <tr><td class="paramname">neddle</td><td>pointer to the pattern we ar searching for </td></tr>
    <tr><td class="paramname">needle_len</td><td>length limit of the needle</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>to start of the match; NULL if no match </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00102">102</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00417">u8_tolower</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="util-spm-bs_8c.html">util-spm-bs.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:25 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
