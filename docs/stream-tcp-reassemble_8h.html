<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/stream-tcp-reassemble.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('stream-tcp-reassemble_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">stream-tcp-reassemble.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp-reassemble.h:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8h" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8h" id="a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8h">
<area shape="rect" title=" " alt="" coords="335,5,527,47"/>
<area shape="rect" href="stream-tcp-private_8h.html" title=" " alt="" coords="153,95,291,121"/>
<area shape="rect" href="suricata_8h.html" title=" " alt="" coords="689,95,768,121"/>
<area shape="rect" href="util-pool-thread_8h.html" title=" " alt="" coords="5,169,124,196"/>
<area shape="rect" href="util-streaming-buffer_8h.html" title=" " alt="" coords="149,169,295,196"/>
<area shape="rect" href="util-pool_8h.html" title=" " alt="" coords="25,244,104,271"/>
<area shape="rect" href="tree_8h.html" title=" " alt="" coords="161,244,216,271"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="662,169,795,196"/>
<area shape="rect" href="runmodes_8h.html" title=" " alt="" coords="819,169,910,196"/>
<area shape="rect" title=" " alt="" coords="1255,244,1320,271"/>
<area shape="rect" title=" " alt="" coords="1344,244,1423,271"/>
<area shape="rect" title=" " alt="" coords="1447,244,1512,271"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="1536,244,1639,271"/>
<area shape="rect" title=" " alt="" coords="240,244,313,271"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="544,468,620,495"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="871,244,1021,271"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="389,393,479,420"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="291,468,369,495"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="1045,244,1127,271"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="605,244,745,271"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="1152,244,1231,271"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="2651,319,2729,345"/>
<area shape="rect" href="util-cpu_8h.html" title=" " alt="" coords="545,543,619,569"/>
<area shape="rect" title=" " alt="" coords="432,543,508,569"/>
<area shape="rect" href="util-debug-filters_8h.html" title=" " alt="" coords="394,468,519,495"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1683,319,1758,345"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1782,319,1851,345"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="2906,393,3023,420"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="2593,393,2688,420"/>
<area shape="rect" href="decode-events_8h.html" title=" " alt="" coords="2712,393,2831,420"/>
<area shape="rect" href="flow-worker_8h.html" title=" " alt="" coords="3047,393,3146,420"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="3171,393,3297,420"/>
<area shape="rect" href="util-napatech_8h.html" title=" " alt="" coords="3322,393,3429,420"/>
<area shape="rect" href="source-nflog_8h.html" title=" " alt="" coords="554,393,658,420"/>
<area shape="rect" href="source-nfq_8h.html" title=" " alt="" coords="2184,393,2279,420"/>
<area shape="rect" href="source-ipfw_8h.html" title=" " alt="" coords="682,393,781,420"/>
<area shape="rect" href="source-pcap_8h.html" title=" " alt="" coords="805,393,909,420"/>
<area shape="rect" href="source-af-packet_8h.html" title=" " alt="" coords="933,393,1063,420"/>
<area shape="rect" href="source-netmap_8h.html" title=" " alt="" coords="1088,393,1207,420"/>
<area shape="rect" href="source-windivert_8h.html" title=" " alt="" coords="1231,393,1359,420"/>
<area shape="rect" href="action-globals_8h.html" title=" " alt="" coords="1384,393,1497,420"/>
<area shape="rect" href="decode-ethernet_8h.html" title=" " alt="" coords="1521,393,1648,420"/>
<area shape="rect" href="decode-gre_8h.html" title=" " alt="" coords="1672,393,1769,420"/>
<area shape="rect" href="decode-ppp_8h.html" title=" " alt="" coords="1793,393,1893,420"/>
<area shape="rect" href="decode-pppoe_8h.html" title=" " alt="" coords="1918,393,2033,420"/>
<area shape="rect" href="decode-ipv4_8h.html" title=" " alt="" coords="2057,393,2160,420"/>
<area shape="rect" href="decode-ipv6_8h.html" title=" " alt="" coords="2637,468,2740,495"/>
<area shape="rect" href="decode-icmpv4_8h.html" title=" " alt="" coords="2303,393,2424,420"/>
<area shape="rect" href="decode-icmpv6_8h.html" title=" " alt="" coords="2448,393,2569,420"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="3186,468,3245,495"/>
</map>
</div>
</div>
<p><a href="stream-tcp-reassemble_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTcpReassemblyThreadCtx__.html">TcpReassemblyThreadCtx_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9c350c78bb5ab0cfaa182789acbb477d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a9c350c78bb5ab0cfaa182789acbb477d">OS_POLICY_DEFAULT</a>&#160;&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66aa3252d3769146af7fb0fb135cc91257b">OS_POLICY_BSD</a></td></tr>
<tr class="separator:a9c350c78bb5ab0cfaa182789acbb477d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a774d008ef52e7f248715dbb83bdb18aa"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTcpReassemblyThreadCtx__.html">TcpReassemblyThreadCtx_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a></td></tr>
<tr class="separator:a774d008ef52e7f248715dbb83bdb18aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a4f79453548dc20926be4b5a000ecbd66"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a26c2eab439c47f8ae02ba986a02ac7f9">OS_POLICY_NONE</a> = 1
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66aa3252d3769146af7fb0fb135cc91257b">OS_POLICY_BSD</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66aac4cf0fdb25b4a139e797be2683fae50">OS_POLICY_BSD_RIGHT</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a8ea06040506e39cbc81e2cf49c3d23bc">OS_POLICY_OLD_LINUX</a>
, <br />
&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a7b36b8c277fcfdb439551d081028e61b">OS_POLICY_LINUX</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66ad4791ae9f646f35552571cdb33817e6d">OS_POLICY_OLD_SOLARIS</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66aec3e6bb1d3f8e05f5e084be4e060d1d9">OS_POLICY_SOLARIS</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a6c048a2fcec3cbc937dccd84d13b2b90">OS_POLICY_HPUX10</a>
, <br />
&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66ae80c13952abbddfecbf7c17666167e52">OS_POLICY_HPUX11</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a617d38ae56123d2fe9047a7f43835f65">OS_POLICY_IRIX</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a2e3fe034562cb35761a788413cc5cd72">OS_POLICY_MACOS</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a404c0f20babca5ac5f6cd5c582c51920">OS_POLICY_WINDOWS</a>
, <br />
&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a793bc53f10bc08446b33ab88c01078a8">OS_POLICY_VISTA</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66ac4cf65ac273bbd7d57ed4554a75abee7">OS_POLICY_WINDOWS2K3</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66ab3c88ca2dc4abbdd797531ed71c79d4e">OS_POLICY_FIRST</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66a11149ed18610fc83cc1f3dcfdeeb26de">OS_POLICY_LAST</a>
<br />
 }</td></tr>
<tr class="separator:a4f79453548dc20926be4b5a000ecbd66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa20e4335392804ebf882090830978c6"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a> { <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6a507201aefa0a53f398cf039baa7f2c8b">UPDATE_DIR_PACKET</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6a020451b669624b855d5ba34adb0c4351">UPDATE_DIR_OPPOSING</a>
, <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6a168e5e5b3e156d5ffa95e9899482d58a">UPDATE_DIR_BOTH</a>
 }</td></tr>
<tr class="separator:afa20e4335392804ebf882090830978c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7fa4f290ce0908537a1c3c879fec24dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a7fa4f290ce0908537a1c3c879fec24dd">StreamTcpReassembleInitMemuse</a> (void)</td></tr>
<tr class="separator:a7fa4f290ce0908537a1c3c879fec24dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65a6ac4e322a80bf70418ad1a34e5be9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a65a6ac4e322a80bf70418ad1a34e5be9">StreamTcpReassembleHandleSegment</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *, <a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *)</td></tr>
<tr class="separator:a65a6ac4e322a80bf70418ad1a34e5be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6684f54f7ac2825603f4d0b1e8f07651"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a6684f54f7ac2825603f4d0b1e8f07651">StreamTcpReassembleInit</a> (bool)</td></tr>
<tr class="separator:a6684f54f7ac2825603f4d0b1e8f07651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08cb731049c0592e88aa3e8e9bbbd561"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a08cb731049c0592e88aa3e8e9bbbd561">StreamTcpReassembleFree</a> (bool)</td></tr>
<tr class="separator:a08cb731049c0592e88aa3e8e9bbbd561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a771b5f3f7ef9d74f05f4ce19b0a75b27"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a771b5f3f7ef9d74f05f4ce19b0a75b27">StreamTcpReassembleRealloc</a> (void *optr, size_t orig_size, size_t size)</td></tr>
<tr class="separator:a771b5f3f7ef9d74f05f4ce19b0a75b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4894f48885e4926013c260b03f68685f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a4894f48885e4926013c260b03f68685f">StreamTcpReassembleRegisterTests</a> (void)</td></tr>
<tr class="memdesc:a4894f48885e4926013c260b03f68685f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function Register the Unit tests to test the reassembly engine for various OS policies.  <a href="stream-tcp-reassemble_8h.html#a4894f48885e4926013c260b03f68685f">More...</a><br /></td></tr>
<tr class="separator:a4894f48885e4926013c260b03f68685f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53c19d8ac0e70cfa806afefc24b273c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ad53c19d8ac0e70cfa806afefc24b273c">StreamTcpReassembleInitThreadCtx</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>)</td></tr>
<tr class="separator:ad53c19d8ac0e70cfa806afefc24b273c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5879b9a05fd13c3c9249e60a1f646bbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a5879b9a05fd13c3c9249e60a1f646bbb">StreamTcpReassembleFreeThreadCtx</a> (<a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *)</td></tr>
<tr class="separator:a5879b9a05fd13c3c9249e60a1f646bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fdc683cf890121b3aecc81bedc0bd8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a89fdc683cf890121b3aecc81bedc0bd8">StreamTcpReassembleAppLayer</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, enum <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a> dir)</td></tr>
<tr class="memdesc:a89fdc683cf890121b3aecc81bedc0bd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the stream reassembly upon receiving a packet.  <a href="stream-tcp-reassemble_8h.html#a89fdc683cf890121b3aecc81bedc0bd8">More...</a><br /></td></tr>
<tr class="separator:a89fdc683cf890121b3aecc81bedc0bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad13ca18d0189118eca9aee4dfc9d11cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ad13ca18d0189118eca9aee4dfc9d11cd">StreamTcpCreateTestPacket</a> (uint8_t *, uint8_t, uint8_t, uint8_t)</td></tr>
<tr class="memdesc:ad13ca18d0189118eca9aee4dfc9d11cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function to create the packet with given payload, which is used to test the reassembly of the engine.  <a href="stream-tcp-reassemble_8h.html#ad13ca18d0189118eca9aee4dfc9d11cd">More...</a><br /></td></tr>
<tr class="separator:ad13ca18d0189118eca9aee4dfc9d11cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a2c8bcfd02ada1794f778c0614d5d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1">StreamTcpSetSessionNoReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *, char)</td></tr>
<tr class="memdesc:aa7a2c8bcfd02ada1794f778c0614d5d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">disable reassembly  <a href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1">More...</a><br /></td></tr>
<tr class="separator:aa7a2c8bcfd02ada1794f778c0614d5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34dd3f8d3c2e31b5e8afb1b203d245d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a34dd3f8d3c2e31b5e8afb1b203d245d6">StreamTcpSetSessionBypassFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *)</td></tr>
<tr class="memdesc:a34dd3f8d3c2e31b5e8afb1b203d245d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable bypass  <a href="stream-tcp-reassemble_8h.html#a34dd3f8d3c2e31b5e8afb1b203d245d6">More...</a><br /></td></tr>
<tr class="separator:a34dd3f8d3c2e31b5e8afb1b203d245d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acde93e47910831b8fc81b7cba2740188"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#acde93e47910831b8fc81b7cba2740188">StreamTcpSetDisableRawReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *, char)</td></tr>
<tr class="memdesc:acde93e47910831b8fc81b7cba2740188"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the No reassembly flag for the given direction in given TCP session.  <a href="stream-tcp-reassemble_8h.html#acde93e47910831b8fc81b7cba2740188">More...</a><br /></td></tr>
<tr class="separator:acde93e47910831b8fc81b7cba2740188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025c6aeffa2046f8b39ee519edcfa8c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1">StreamTcpSetOSPolicy</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *)</td></tr>
<tr class="memdesc:a025c6aeffa2046f8b39ee519edcfa8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the OS policy for the given stream based on the destination of the received packet.  <a href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1">More...</a><br /></td></tr>
<tr class="separator:a025c6aeffa2046f8b39ee519edcfa8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a75ed0e6a51ad7ee4418623e1db12fc8f">StreamTcpReassembleHandleSegmentHandleData</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a packets TCP data into the stream reassembly engine.  <a href="stream-tcp-reassemble_8h.html#a75ed0e6a51ad7ee4418623e1db12fc8f">More...</a><br /></td></tr>
<tr class="separator:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8dbb2d5c18463f92d4f1d4c55c9bfc4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ac8dbb2d5c18463f92d4f1d4c55c9bfc4">StreamTcpReassembleInsertSegment</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *, <a class="el" href="structTcpSegment.html">TcpSegment</a> *, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *, uint32_t pkt_seq, uint8_t *pkt_data, uint16_t pkt_datalen)</td></tr>
<tr class="separator:ac8dbb2d5c18463f92d4f1d4c55c9bfc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f899c85d711a03ce09949266b772e75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTcpSegment.html">TcpSegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a0f899c85d711a03ce09949266b772e75">StreamTcpGetSegment</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *)</td></tr>
<tr class="memdesc:a0f899c85d711a03ce09949266b772e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a segment from the pool  <a href="stream-tcp-reassemble_8h.html#a0f899c85d711a03ce09949266b772e75">More...</a><br /></td></tr>
<tr class="separator:a0f899c85d711a03ce09949266b772e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96d6fa8305eedd10a095558194edf776"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a96d6fa8305eedd10a095558194edf776">StreamTcpReturnStreamSegments</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *)</td></tr>
<tr class="memdesc:a96d6fa8305eedd10a095558194edf776"><td class="mdescLeft">&#160;</td><td class="mdescRight">return all segments in this stream into the pool(s)  <a href="stream-tcp-reassemble_8h.html#a96d6fa8305eedd10a095558194edf776">More...</a><br /></td></tr>
<tr class="separator:a96d6fa8305eedd10a095558194edf776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba1e32be404a7a0b5e1a52d39ddf0eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a9ba1e32be404a7a0b5e1a52d39ddf0eb">StreamTcpSegmentReturntoPool</a> (<a class="el" href="structTcpSegment.html">TcpSegment</a> *)</td></tr>
<tr class="memdesc:a9ba1e32be404a7a0b5e1a52d39ddf0eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the segment back to the pool.  <a href="stream-tcp-reassemble_8h.html#a9ba1e32be404a7a0b5e1a52d39ddf0eb">More...</a><br /></td></tr>
<tr class="separator:a9ba1e32be404a7a0b5e1a52d39ddf0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569d1edaec7e3d3402e2382025ccd605"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a569d1edaec7e3d3402e2382025ccd605">StreamTcpReassembleTriggerRawReassembly</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *, int direction)</td></tr>
<tr class="memdesc:a569d1edaec7e3d3402e2382025ccd605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger RAW stream reassembly.  <a href="stream-tcp-reassemble_8h.html#a569d1edaec7e3d3402e2382025ccd605">More...</a><br /></td></tr>
<tr class="separator:a569d1edaec7e3d3402e2382025ccd605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c545cb0ef123eb3b19064c380f75a17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a4c545cb0ef123eb3b19064c380f75a17">StreamTcpPruneSession</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *, uint8_t)</td></tr>
<tr class="memdesc:a4c545cb0ef123eb3b19064c380f75a17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove idle TcpSegments from TcpSession.  <a href="stream-tcp-reassemble_8h.html#a4c545cb0ef123eb3b19064c380f75a17">More...</a><br /></td></tr>
<tr class="separator:a4c545cb0ef123eb3b19064c380f75a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de7491805a4a77ffda933d5fbf566e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a3de7491805a4a77ffda933d5fbf566e4">StreamTcpReassembleDepthReached</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a3de7491805a4a77ffda933d5fbf566e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if stream in pkt direction has depth reached  <a href="stream-tcp-reassemble_8h.html#a3de7491805a4a77ffda933d5fbf566e4">More...</a><br /></td></tr>
<tr class="separator:a3de7491805a4a77ffda933d5fbf566e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0450f1665ff06a11cb08777c78eba9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ae0450f1665ff06a11cb08777c78eba9b">StreamTcpReassembleIncrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:ae0450f1665ff06a11cb08777c78eba9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Increment the memory usage counter for the TCP reassembly segments.  <a href="stream-tcp-reassemble_8h.html#ae0450f1665ff06a11cb08777c78eba9b">More...</a><br /></td></tr>
<tr class="separator:ae0450f1665ff06a11cb08777c78eba9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1117512e3b998a56f41b4457da37c416"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a1117512e3b998a56f41b4457da37c416">StreamTcpReassembleDecrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:a1117512e3b998a56f41b4457da37c416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Decrease the memory usage counter for the TCP reassembly segments.  <a href="stream-tcp-reassemble_8h.html#a1117512e3b998a56f41b4457da37c416">More...</a><br /></td></tr>
<tr class="separator:a1117512e3b998a56f41b4457da37c416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ad7eea57c7056aa4bba068cf731d3d4a8">StreamTcpReassembleSetMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update memcap value.  <a href="stream-tcp-reassemble_8h.html#ad7eea57c7056aa4bba068cf731d3d4a8">More...</a><br /></td></tr>
<tr class="separator:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2d6917e9c96e40b3be5af0fb011f89"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a4a2d6917e9c96e40b3be5af0fb011f89">StreamTcpReassembleGetMemcap</a> (void)</td></tr>
<tr class="memdesc:a4a2d6917e9c96e40b3be5af0fb011f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return memcap value.  <a href="stream-tcp-reassemble_8h.html#a4a2d6917e9c96e40b3be5af0fb011f89">More...</a><br /></td></tr>
<tr class="separator:a4a2d6917e9c96e40b3be5af0fb011f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b00d2144fbbf62514e68ba316903c62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a1b00d2144fbbf62514e68ba316903c62">StreamTcpReassembleCheckMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:a1b00d2144fbbf62514e68ba316903c62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP segments.  <a href="stream-tcp-reassemble_8h.html#a1b00d2144fbbf62514e68ba316903c62">More...</a><br /></td></tr>
<tr class="separator:a1b00d2144fbbf62514e68ba316903c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a477c59db3b1fef12cb9b1e5e5de0f59f">StreamTcpReassembleMemuseGlobalCounter</a> (void)</td></tr>
<tr class="separator:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419339627115993b6ef9f55ebbd4365c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a419339627115993b6ef9f55ebbd4365c">StreamTcpDisableAppLayer</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:a419339627115993b6ef9f55ebbd4365c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34cbaa81da49c7656535cebbca45ff1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ad34cbaa81da49c7656535cebbca45ff1">StreamTcpAppLayerIsDisabled</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:ad34cbaa81da49c7656535cebbca45ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a042ac8f42a36981cd42ee2c6605f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a91a042ac8f42a36981cd42ee2c6605f9">StreamTcpCheckStreamContents</a> (uint8_t *, uint16_t, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *)</td></tr>
<tr class="memdesc:a91a042ac8f42a36981cd42ee2c6605f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function Checks the reassembled stream contents against predefined stream contents according to OS policy used.  <a href="stream-tcp-reassemble_8h.html#a91a042ac8f42a36981cd42ee2c6605f9">More...</a><br /></td></tr>
<tr class="separator:a91a042ac8f42a36981cd42ee2c6605f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244d3a5e334392fa0091554609e55f71"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a244d3a5e334392fa0091554609e55f71">StreamReassembleRawHasDataReady</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a244d3a5e334392fa0091554609e55f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">does the stream engine have data to inspect?  <a href="stream-tcp-reassemble_8h.html#a244d3a5e334392fa0091554609e55f71">More...</a><br /></td></tr>
<tr class="separator:a244d3a5e334392fa0091554609e55f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cca677b3f6c60ab903b3246bcd5129f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a6cca677b3f6c60ab903b3246bcd5129f">StreamTcpReassemblySetMinInspectDepth</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, int direction, uint32_t depth)</td></tr>
<tr class="separator:a6cca677b3f6c60ab903b3246bcd5129f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73328239ccee3f1597b9085df75faf2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#aa73328239ccee3f1597b9085df75faf2">IsTcpSessionDumpingEnabled</a> (void)</td></tr>
<tr class="separator:aa73328239ccee3f1597b9085df75faf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35abd3b4853e4137e6c2d9739df2484f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#a35abd3b4853e4137e6c2d9739df2484f">EnableTcpSessionDumping</a> (void)</td></tr>
<tr class="separator:a35abd3b4853e4137e6c2d9739df2484f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8100dabd6d650899e0e52f84d72e13f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8h.html#ac8100dabd6d650899e0e52f84d72e13f">StreamDataAvailableForProtoDetect</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="separator:ac8100dabd6d650899e0e52f84d72e13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd>
<dd>
Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span class="obfuscator">.nosp@m.</span>nder<span class="obfuscator">.nosp@m.</span>singh<span class="obfuscator">.nosp@m.</span>dahi<span class="obfuscator">.nosp@m.</span>ya@gm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9c350c78bb5ab0cfaa182789acbb477d" name="a9c350c78bb5ab0cfaa182789acbb477d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c350c78bb5ab0cfaa182789acbb477d">&#9670;&nbsp;</a></span>OS_POLICY_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OS_POLICY_DEFAULT&#160;&#160;&#160;<a class="el" href="stream-tcp-reassemble_8h.html#a4f79453548dc20926be4b5a000ecbd66aa3252d3769146af7fb0fb135cc91257b">OS_POLICY_BSD</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8h_source.html#l00083">83</a> of file <a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a774d008ef52e7f248715dbb83bdb18aa" name="a774d008ef52e7f248715dbb83bdb18aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774d008ef52e7f248715dbb83bdb18aa">&#9670;&nbsp;</a></span>TcpReassemblyThreadCtx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTcpReassemblyThreadCtx__.html">TcpReassemblyThreadCtx_</a> <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a4f79453548dc20926be4b5a000ecbd66" name="a4f79453548dc20926be4b5a000ecbd66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f79453548dc20926be4b5a000ecbd66">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Supported OS list and default OS policy is BSD </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a26c2eab439c47f8ae02ba986a02ac7f9" name="a4f79453548dc20926be4b5a000ecbd66a26c2eab439c47f8ae02ba986a02ac7f9"></a>OS_POLICY_NONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66aa3252d3769146af7fb0fb135cc91257b" name="a4f79453548dc20926be4b5a000ecbd66aa3252d3769146af7fb0fb135cc91257b"></a>OS_POLICY_BSD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66aac4cf0fdb25b4a139e797be2683fae50" name="a4f79453548dc20926be4b5a000ecbd66aac4cf0fdb25b4a139e797be2683fae50"></a>OS_POLICY_BSD_RIGHT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a8ea06040506e39cbc81e2cf49c3d23bc" name="a4f79453548dc20926be4b5a000ecbd66a8ea06040506e39cbc81e2cf49c3d23bc"></a>OS_POLICY_OLD_LINUX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a7b36b8c277fcfdb439551d081028e61b" name="a4f79453548dc20926be4b5a000ecbd66a7b36b8c277fcfdb439551d081028e61b"></a>OS_POLICY_LINUX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66ad4791ae9f646f35552571cdb33817e6d" name="a4f79453548dc20926be4b5a000ecbd66ad4791ae9f646f35552571cdb33817e6d"></a>OS_POLICY_OLD_SOLARIS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66aec3e6bb1d3f8e05f5e084be4e060d1d9" name="a4f79453548dc20926be4b5a000ecbd66aec3e6bb1d3f8e05f5e084be4e060d1d9"></a>OS_POLICY_SOLARIS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a6c048a2fcec3cbc937dccd84d13b2b90" name="a4f79453548dc20926be4b5a000ecbd66a6c048a2fcec3cbc937dccd84d13b2b90"></a>OS_POLICY_HPUX10&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66ae80c13952abbddfecbf7c17666167e52" name="a4f79453548dc20926be4b5a000ecbd66ae80c13952abbddfecbf7c17666167e52"></a>OS_POLICY_HPUX11&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a617d38ae56123d2fe9047a7f43835f65" name="a4f79453548dc20926be4b5a000ecbd66a617d38ae56123d2fe9047a7f43835f65"></a>OS_POLICY_IRIX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a2e3fe034562cb35761a788413cc5cd72" name="a4f79453548dc20926be4b5a000ecbd66a2e3fe034562cb35761a788413cc5cd72"></a>OS_POLICY_MACOS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a404c0f20babca5ac5f6cd5c582c51920" name="a4f79453548dc20926be4b5a000ecbd66a404c0f20babca5ac5f6cd5c582c51920"></a>OS_POLICY_WINDOWS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a793bc53f10bc08446b33ab88c01078a8" name="a4f79453548dc20926be4b5a000ecbd66a793bc53f10bc08446b33ab88c01078a8"></a>OS_POLICY_VISTA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66ac4cf65ac273bbd7d57ed4554a75abee7" name="a4f79453548dc20926be4b5a000ecbd66ac4cf65ac273bbd7d57ed4554a75abee7"></a>OS_POLICY_WINDOWS2K3&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66ab3c88ca2dc4abbdd797531ed71c79d4e" name="a4f79453548dc20926be4b5a000ecbd66ab3c88ca2dc4abbdd797531ed71c79d4e"></a>OS_POLICY_FIRST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f79453548dc20926be4b5a000ecbd66a11149ed18610fc83cc1f3dcfdeeb26de" name="a4f79453548dc20926be4b5a000ecbd66a11149ed18610fc83cc1f3dcfdeeb26de"></a>OS_POLICY_LAST&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8h_source.html#l00036">36</a> of file <a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>.</p>

</div>
</div>
<a id="afa20e4335392804ebf882090830978c6" name="afa20e4335392804ebf882090830978c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa20e4335392804ebf882090830978c6">&#9670;&nbsp;</a></span>StreamUpdateDir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afa20e4335392804ebf882090830978c6a507201aefa0a53f398cf039baa7f2c8b" name="afa20e4335392804ebf882090830978c6a507201aefa0a53f398cf039baa7f2c8b"></a>UPDATE_DIR_PACKET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afa20e4335392804ebf882090830978c6a020451b669624b855d5ba34adb0c4351" name="afa20e4335392804ebf882090830978c6a020451b669624b855d5ba34adb0c4351"></a>UPDATE_DIR_OPPOSING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afa20e4335392804ebf882090830978c6a168e5e5b3e156d5ffa95e9899482d58a" name="afa20e4335392804ebf882090830978c6a168e5e5b3e156d5ffa95e9899482d58a"></a>UPDATE_DIR_BOTH&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8h_source.html#l00056">56</a> of file <a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a35abd3b4853e4137e6c2d9739df2484f" name="a35abd3b4853e4137e6c2d9739df2484f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35abd3b4853e4137e6c2d9739df2484f">&#9670;&nbsp;</a></span>EnableTcpSessionDumping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnableTcpSessionDumping </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00093">93</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="aa73328239ccee3f1597b9085df75faf2" name="aa73328239ccee3f1597b9085df75faf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73328239ccee3f1597b9085df75faf2">&#9670;&nbsp;</a></span>IsTcpSessionDumpingEnabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool IsTcpSessionDumpingEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00088">88</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="ac8100dabd6d650899e0e52f84d72e13f" name="ac8100dabd6d650899e0e52f84d72e13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8100dabd6d650899e0e52f84d72e13f">&#9670;&nbsp;</a></span>StreamDataAvailableForProtoDetect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t StreamDataAvailableForProtoDetect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00680">680</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00102">StreamingBuffer_::head</a>, <a class="el" href="tree_8h_source.html#l00327">RB_EMPTY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00103">StreamingBuffer_::sbb_size</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00101">StreamingBuffer_::sbb_tree</a>, and <a class="el" href="util-streaming-buffer_8h_source.html#l00095">StreamingBuffer_::stream_offset</a>.</p>

</div>
</div>
<a id="a244d3a5e334392fa0091554609e55f71" name="a244d3a5e334392fa0091554609e55f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244d3a5e334392fa0091554609e55f71">&#9670;&nbsp;</a></span>StreamReassembleRawHasDataReady()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StreamReassembleRawHasDataReady </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>does the stream engine have data to inspect? </p>
<p >Returns true if there is data to inspect. In IDS case this is about ACK'd data in the packet's direction.</p>
<p >In the IPS case this is about the packet itself. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01414">1414</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="tree_8h_source.html#l00327">RB_EMPTY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00143">STREAM_BASE_OFFSET</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00145">STREAM_RAW_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00230">STREAMTCP_STREAM_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, and <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a244d3a5e334392fa0091554609e55f71_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a244d3a5e334392fa0091554609e55f71_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a244d3a5e334392fa0091554609e55f71_cgraph" id="astream-tcp-reassemble_8h_a244d3a5e334392fa0091554609e55f71_cgraph">
<area shape="rect" title="does the stream engine have data to inspect?" alt="" coords="5,5,221,47"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="269,13,416,39"/>
</map>
</div>

</div>
</div>
<a id="ad34cbaa81da49c7656535cebbca45ff1" name="ad34cbaa81da49c7656535cebbca45ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34cbaa81da49c7656535cebbca45ff1">&#9670;&nbsp;</a></span>StreamTcpAppLayerIsDisabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpAppLayerIsDisabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00446">446</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>.</p>

</div>
</div>
<a id="a91a042ac8f42a36981cd42ee2c6605f9" name="a91a042ac8f42a36981cd42ee2c6605f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a042ac8f42a36981cd42ee2c6605f9">&#9670;&nbsp;</a></span>StreamTcpCheckStreamContents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpCheckStreamContents </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>stream_policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sp_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function Checks the reassembled stream contents against predefined stream contents according to OS policy used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream_policy</td><td>Predefined value of stream for different OS policies </td></tr>
    <tr><td class="paramname">stream</td><td>Reassembled stream returned from the reassembly functions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02132">2132</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, and <a class="el" href="util-streaming-buffer_8c_source.html#l00870">StreamingBufferCompareRawData()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a91a042ac8f42a36981cd42ee2c6605f9_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a91a042ac8f42a36981cd42ee2c6605f9_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a91a042ac8f42a36981cd42ee2c6605f9_cgraph" id="astream-tcp-reassemble_8h_a91a042ac8f42a36981cd42ee2c6605f9_cgraph">
<area shape="rect" title="The Function Checks the reassembled stream contents against predefined stream contents according to O..." alt="" coords="5,31,223,57"/>
<area shape="rect" href="util-streaming-buffer_8c.html#a752f9a408bd7ee8cac07d3772d81cf07" title=" " alt="" coords="271,31,495,57"/>
<area shape="rect" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title=" " alt="" coords="566,5,685,32"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af6d76eb5aead49d5f5b16d48aac130ef" title=" " alt="" coords="543,56,708,83"/>
</map>
</div>

</div>
</div>
<a id="ad13ca18d0189118eca9aee4dfc9d11cd" name="ad13ca18d0189118eca9aee4dfc9d11cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad13ca18d0189118eca9aee4dfc9d11cd">&#9670;&nbsp;</a></span>StreamTcpCreateTestPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpCreateTestPacket </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function to create the packet with given payload, which is used to test the reassembly of the engine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">payload</td><td>The variable used to store the payload contents of the current packet. </td></tr>
    <tr><td class="paramname">value</td><td>The value which current payload will have for this packet </td></tr>
    <tr><td class="paramname">payload_len</td><td>The length of the filed payload for current packet. </td></tr>
    <tr><td class="paramname">len</td><td>Length of the payload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02115">2115</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer-dnp3_8h_source.html#l00002">len</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00001">payload_len</a>.</p>

</div>
</div>
<a id="a419339627115993b6ef9f55ebbd4365c" name="a419339627115993b6ef9f55ebbd4365c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419339627115993b6ef9f55ebbd4365c">&#9670;&nbsp;</a></span>StreamTcpDisableAppLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDisableAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00430">430</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00485">Flow_::alparser</a>, <a class="el" href="app-layer-parser_8h_source.html#l00040">APP_LAYER_PARSER_EOF_TC</a>, <a class="el" href="app-layer-parser_8h_source.html#l00039">APP_LAYER_PARSER_EOF_TS</a>, <a class="el" href="app-layer-parser_8c_source.html#l01718">AppLayerParserStateSetFlag()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00294">StreamTcpDisableAppLayerReassembly</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00288">StreamTcpSetStreamFlagAppProtoDetectionCompleted</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a419339627115993b6ef9f55ebbd4365c_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a419339627115993b6ef9f55ebbd4365c_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a419339627115993b6ef9f55ebbd4365c_cgraph" id="astream-tcp-reassemble_8h_a419339627115993b6ef9f55ebbd4365c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,32"/>
<area shape="rect" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title=" " alt="" coords="236,5,427,32"/>
</map>
</div>

</div>
</div>
<a id="a0f899c85d711a03ce09949266b772e75" name="a0f899c85d711a03ce09949266b772e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f899c85d711a03ce09949266b772e75">&#9670;&nbsp;</a></span>StreamTcpGetSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTcpSegment.html">TcpSegment</a> * StreamTcpGetSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a segment from the pool </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">seg</td><td>Segment from the pool or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02036">2036</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8c_source.html#l00168">PoolThreadGetById()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00136">StreamTcpUTAddSegmentWithByte()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00113">StreamTcpUTAddSegmentWithPayload()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_cgraph" id="astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_cgraph">
<area shape="rect" title="get a segment from the pool" alt="" coords="5,5,163,32"/>
<area shape="rect" href="group__utilpool.html#gabe3fd07a4b08ea4aa17e13b24ece9dbf" title="get data from thread pool by thread id" alt="" coords="211,5,347,32"/>
<area shape="rect" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9" title=" " alt="" coords="395,5,464,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_icgraph" id="astream-tcp-reassemble_8h_a0f899c85d711a03ce09949266b772e75_icgraph">
<area shape="rect" title="get a segment from the pool" alt="" coords="284,35,441,61"/>
<area shape="rect" href="stream-tcp-util_8c.html#a76e6bc7448ccad45a8955265ec14e40a" title=" " alt="" coords="5,5,236,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#aa95bbbdf447725bbfb4948657754d61f" title=" " alt="" coords="19,57,222,98"/>
</map>
</div>

</div>
</div>
<a id="a4c545cb0ef123eb3b19064c380f75a17" name="a4c545cb0ef123eb3b19064c380f75a17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c545cb0ef123eb3b19064c380f75a17">&#9670;&nbsp;</a></span>StreamTcpPruneSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpPruneSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove idle TcpSegments from TcpSession. </p>
<p >Checks app progress and raw progress and progresses them if needed, slides the streaming buffer, then gets rid of excess segments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
    <tr><td class="paramname">flags</td><td>direction flags </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-list_8c_source.html#l00880">880</a> of file <a class="el" href="stream-tcp-list_8c_source.html">stream-tcp-list.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="decode-gre_8h_source.html#l00000">flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="util-streaming-buffer_8c_source.html#l00130">StreamingBufferClear()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00215">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00230">STREAMTCP_STREAM_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">StreamTcpReturnStreamSegments()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a4c545cb0ef123eb3b19064c380f75a17_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a4c545cb0ef123eb3b19064c380f75a17_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a4c545cb0ef123eb3b19064c380f75a17_cgraph" id="astream-tcp-reassemble_8h_a4c545cb0ef123eb3b19064c380f75a17_cgraph">
<area shape="rect" title="Remove idle TcpSegments from TcpSession." alt="" coords="5,31,171,57"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af4bd99000ecb44d68835f4793e33f3d4" title=" " alt="" coords="257,5,404,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="219,56,443,83"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="491,56,703,83"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="751,56,877,83"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="925,56,1012,83"/>
</map>
</div>

</div>
</div>
<a id="a89fdc683cf890121b3aecc81bedc0bd8" name="a89fdc683cf890121b3aecc81bedc0bd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fdc683cf890121b3aecc81bedc0bd8">&#9670;&nbsp;</a></span>StreamTcpReassembleAppLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a>&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the stream reassembly upon receiving a packet. </p>
<p >For IDS mode, the stream is in the opposite direction of the packet, as the ACK-packet is ACK'ing the stream.</p>
<p >One of the utilities call by this function <a class="el" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app-layer.">AppLayerHandleTCPData()</a>, has a feature where it will call this very same function for the stream opposing the stream it is called with. This shouldn't cause any issues, since processing of each stream is independent of the other stream. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01301">1301</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer_8c_source.html#l00638">AppLayerHandleTCPData()</a>, <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="decode_8h_source.html#l01171">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="tree_8h_source.html#l00778">RB_MIN</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00273">TcpSession_::state</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00144">STREAM_APP_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00104">STREAM_HAS_SEEN_DATA</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00102">STREAM_RIGHT_EDGE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00160">TCP_CLOSING</a>, and <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a89fdc683cf890121b3aecc81bedc0bd8_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a89fdc683cf890121b3aecc81bedc0bd8_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a89fdc683cf890121b3aecc81bedc0bd8_cgraph" id="astream-tcp-reassemble_8h_a89fdc683cf890121b3aecc81bedc0bd8_cgraph">
<area shape="rect" title="Update the stream reassembly upon receiving a packet." alt="" coords="5,107,217,133"/>
<area shape="rect" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app&#45;layer." alt="" coords="265,107,439,133"/>
<area shape="rect" href="app-layer-parser_8c.html#a7b0bc1a5a394504f629b6a9ab3ac33eb" title=" " alt="" coords="529,5,678,32"/>
<area shape="rect" href="util-exception-policy_8c.html#ac8f42e476206f6214c9704b16ec35155" title=" " alt="" coords="529,56,678,83"/>
<area shape="rect" href="flow_8c.html#acc4e426d680d8624300a2e3d8dfeffec" title="Check if change proto flag is set for flow." alt="" coords="540,107,667,133"/>
<area shape="rect" href="flow_8c.html#a71829515c7880d4089d0fb8422f2f912" title="Unset flag to indicate to change proto for the flow." alt="" coords="510,157,697,184"/>
<area shape="rect" href="stream-tcp_8c.html#afc4ebba3d55a0923ad8aee7f6a959bd0" title="update reassembly progress" alt="" coords="487,208,720,235"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="768,5,919,32"/>
<area shape="rect" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title=" " alt="" coords="780,56,907,83"/>
</map>
</div>

</div>
</div>
<a id="a1b00d2144fbbf62514e68ba316903c62" name="a1b00d2144fbbf62514e68ba316903c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b00d2144fbbf62514e68ba316903c62">&#9670;&nbsp;</a></span>StreamTcpReassembleCheckMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">161</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-debug_8h_source.html#l00230">SCLogNotice</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00077">t_pcapcnt</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a1b00d2144fbbf62514e68ba316903c62_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a1b00d2144fbbf62514e68ba316903c62_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a1b00d2144fbbf62514e68ba316903c62_icgraph" id="astream-tcp-reassemble_8h_a1b00d2144fbbf62514e68ba316903c62_icgraph">
<area shape="rect" title="Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP se..." alt="" coords="255,5,449,47"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,13,207,39"/>
</map>
</div>

</div>
</div>
<a id="a1117512e3b998a56f41b4457da37c416" name="a1117512e3b998a56f41b4457da37c416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1117512e3b998a56f41b4457da37c416">&#9670;&nbsp;</a></span>StreamTcpReassembleDecrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Decrease the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00126">126</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="suricata_8c_source.html#l00279">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00342">SC_ATOMIC_SUB</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">StreamTcpReassembleMemuseGlobalCounter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_cgraph" id="astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_cgraph">
<area shape="rect" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="5,35,240,61"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="320,5,463,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="288,57,495,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_icgraph" id="astream-tcp-reassemble_8h_a1117512e3b998a56f41b4457da37c416_icgraph">
<area shape="rect" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="255,5,489,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="a3de7491805a4a77ffda933d5fbf566e4" name="a3de7491805a4a77ffda933d5fbf566e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3de7491805a4a77ffda933d5fbf566e4">&#9670;&nbsp;</a></span>StreamTcpReassembleDepthReached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleDepthReached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if stream in pkt direction has depth reached </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>packet with <em>LOCKED</em> flow</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>stream has depth reached </td></tr>
    <tr><td class="paramname">0</td><td>stream does not have depth reached </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00583">583</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00223">FLOW_PKT_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l00465">Packet_::flowflags</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00215">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>.</p>

</div>
</div>
<a id="a08cb731049c0592e88aa3e8e9bbbd561" name="a08cb731049c0592e88aa3e8e9bbbd561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08cb731049c0592e88aa3e8e9bbbd561">&#9670;&nbsp;</a></span>StreamTcpReassembleFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFree </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">505</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00667">StreamTcpFreeConfig()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a08cb731049c0592e88aa3e8e9bbbd561_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a08cb731049c0592e88aa3e8e9bbbd561_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a08cb731049c0592e88aa3e8e9bbbd561_icgraph" id="astream-tcp-reassemble_8h_a08cb731049c0592e88aa3e8e9bbbd561_icgraph">
<area shape="rect" title=" " alt="" coords="385,5,568,32"/>
<area shape="rect" href="stream-tcp_8c.html#a6e1df383229e4ec307642c8770bf218a" title=" " alt="" coords="189,5,337,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#af08d2b5ca2d164e365b1fcd55cd3521a" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
<a id="a5879b9a05fd13c3c9249e60a1f646bbb" name="a5879b9a05fd13c3c9249e60a1f646bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5879b9a05fd13c3c9249e60a1f646bbb">&#9670;&nbsp;</a></span>StreamTcpReassembleFreeThreadCtx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFreeThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00565">565</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00063">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l01004">AppLayerDestroyCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, and <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05455">StreamTcpThreadDeinit()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00051">StreamTcpUTDeinit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_cgraph" id="astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,249,98"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="297,71,481,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="529,42,732,69"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="534,93,727,135"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="780,5,989,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="785,71,985,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_icgraph" id="astream-tcp-reassemble_8h_a5879b9a05fd13c3c9249e60a1f646bbb_icgraph">
<area shape="rect" title=" " alt="" coords="212,31,456,57"/>
<area shape="rect" href="stream-tcp_8c.html#a108137f5e3fa9caa0aab96a14df9b1cc" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#af08d2b5ca2d164e365b1fcd55cd3521a" title=" " alt="" coords="17,56,153,83"/>
</map>
</div>

</div>
</div>
<a id="a4a2d6917e9c96e40b3be5af0fb011f89" name="a4a2d6917e9c96e40b3be5af0fb011f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2d6917e9c96e40b3be5af0fb011f89">&#9670;&nbsp;</a></span>StreamTcpReassembleGetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleGetMemcap </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return memcap value. </p>
<dl class="section return"><dt>Returns</dt><dd>memcap memcap value </dd></dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00197">197</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a65a6ac4e322a80bf70418ad1a34e5be9" name="a65a6ac4e322a80bf70418ad1a34e5be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65a6ac4e322a80bf70418ad1a34e5be9">&#9670;&nbsp;</a></span>StreamTcpReassembleHandleSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01921">1921</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00108">FLOW_DIR_REVERSED</a>, <a class="el" href="decode_8h_source.html#l00575">Packet_::payload_len</a>, <a class="el" href="decode_8h_source.html#l01171">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00273">TcpSession_::state</a>, <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00161">TCP_CLOSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00157">TCP_TIME_WAIT</a>, <a class="el" href="decode_8h_source.html#l00554">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00038">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00034">TH_FIN</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_RST</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00059">UPDATE_DIR_BOTH</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00058">UPDATE_DIR_OPPOSING</a>, and <a class="el" href="stream-tcp-reassemble_8h_source.html#l00057">UPDATE_DIR_PACKET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a65a6ac4e322a80bf70418ad1a34e5be9_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a65a6ac4e322a80bf70418ad1a34e5be9_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a65a6ac4e322a80bf70418ad1a34e5be9_cgraph" id="astream-tcp-reassemble_8h_a65a6ac4e322a80bf70418ad1a34e5be9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,204,47"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="252,13,399,39"/>
</map>
</div>

</div>
</div>
<a id="a75ed0e6a51ad7ee4418623e1db12fc8f" name="a75ed0e6a51ad7ee4418623e1db12fc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ed0e6a51ad7ee4418623e1db12fc8f">&#9670;&nbsp;</a></span>StreamTcpReassembleHandleSegmentHandleData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegmentHandleData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a packets TCP data into the stream reassembly engine. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>good segment, as far as we checked. </td></tr>
    <tr><td class="paramname">-1</td><td>insert failure due to memcap</td></tr>
  </table>
  </dd>
</dl>
<p>If the retval is 0 the segment is inserted correctly, or overlap is handled, or it wasn't added because of reassembly depth. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00704">704</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00276">TcpSession_::data_first_seen_dir</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00110">TcpStream_::os_policy</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>, and <a class="el" href="stream-tcp_8c_source.html#l00773">StreamTcpSetOSPolicy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00097">StreamTcpUTAddPayload()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" id="astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph">
<area shape="rect" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="5,23,204,65"/>
<area shape="rect" href="stream-tcp_8c.html#a4bbabc99ab491dd9fa822fd5b3ade953" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="252,31,411,57"/>
<area shape="rect" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format." alt="" coords="459,5,669,32"/>
<area shape="rect" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format." alt="" coords="459,56,669,83"/>
<area shape="rect" href="util-radix-tree_8c.html#a3f0f2284278ce9b4b740e9c08d842652" title="Checks if an IPV4 address is present in the tree under a netblock." alt="" coords="717,5,932,32"/>
<area shape="rect" href="util-radix-tree_8c.html#a6cc3963f75cae4474ad3f63869860a98" title="Checks if an IPV6 address is present in the tree under a netblock." alt="" coords="717,56,932,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" id="astream-tcp-reassemble_8h_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph">
<area shape="rect" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="224,5,423,47"/>
<area shape="rect" href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924" title="wrapper for StreamTcpReassembleHandleSegmentHandleData" alt="" coords="5,13,176,39"/>
</map>
</div>

</div>
</div>
<a id="ae0450f1665ff06a11cb08777c78eba9b" name="ae0450f1665ff06a11cb08777c78eba9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0450f1665ff06a11cb08777c78eba9b">&#9670;&nbsp;</a></span>StreamTcpReassembleIncrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Increment the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00113">113</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00333">SC_ATOMIC_ADD</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">StreamTcpReassembleMemuseGlobalCounter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_cgraph" id="astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_cgraph">
<area shape="rect" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="5,13,235,39"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="283,5,489,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_icgraph" id="astream-tcp-reassemble_8h_ae0450f1665ff06a11cb08777c78eba9b_icgraph">
<area shape="rect" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="255,5,484,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="a6684f54f7ac2825603f4d0b1e8f07651" name="a6684f54f7ac2825603f4d0b1e8f07651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6684f54f7ac2825603f4d0b1e8f07651">&#9670;&nbsp;</a></span>StreamTcpReassembleInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleInit </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00489">489</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8c_source.html#l00102">StreamTcpReassembleInitMemuse()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a6684f54f7ac2825603f4d0b1e8f07651_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a6684f54f7ac2825603f4d0b1e8f07651_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a6684f54f7ac2825603f4d0b1e8f07651_cgraph" id="astream-tcp-reassemble_8h_a6684f54f7ac2825603f4d0b1e8f07651_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a7fa4f290ce0908537a1c3c879fec24dd" title=" " alt="" coords="228,5,453,32"/>
</map>
</div>

</div>
</div>
<a id="a7fa4f290ce0908537a1c3c879fec24dd" name="a7fa4f290ce0908537a1c3c879fec24dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa4f290ce0908537a1c3c879fec24dd">&#9670;&nbsp;</a></span>StreamTcpReassembleInitMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleInitMemuse </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00102">102</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00315">SC_ATOMIC_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00489">StreamTcpReassembleInit()</a>, and <a class="el" href="util-unittest_8c_source.html#l00189">UtRunTests()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a7fa4f290ce0908537a1c3c879fec24dd_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a7fa4f290ce0908537a1c3c879fec24dd_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a7fa4f290ce0908537a1c3c879fec24dd_icgraph" id="astream-tcp-reassemble_8h_a7fa4f290ce0908537a1c3c879fec24dd_icgraph">
<area shape="rect" title=" " alt="" coords="228,31,453,57"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#aa6ddeaa2bb0f397d541844c4a5ac521a" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="group__Testing.html#ga961f4890d5ff5ef0e1b83e66b3255b6a" title="Run all registered unittests." alt="" coords="47,56,139,83"/>
</map>
</div>

</div>
</div>
<a id="ad53c19d8ac0e70cfa806afefc24b273c" name="ad53c19d8ac0e70cfa806afefc24b273c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53c19d8ac0e70cfa806afefc24b273c">&#9670;&nbsp;</a></span>StreamTcpReassembleInitThreadCtx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> * StreamTcpReassembleInitThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00524">524</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00063">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00982">AppLayerGetCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05389">StreamTcpThreadInit()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00044">StreamTcpUTInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_cgraph" id="astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_cgraph">
<area shape="rect" title=" " alt="" coords="5,130,241,157"/>
<area shape="rect" href="app-layer_8c.html#a0a0e638b06f49c80ad35efdf473f6556" title="Creates a new app layer thread context." alt="" coords="289,130,448,157"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="507,71,691,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a400a9d5e447fc436600350bdb157a64c" title="Gets a new app layer protocol&#39;s parser thread context." alt="" coords="496,130,701,157"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a56a48d357c05d7cfe483a1a213444664" title="Inits and returns an app layer protocol detection thread context." alt="" coords="504,181,693,223"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="749,13,952,39"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="754,64,947,105"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="1000,5,1209,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="1005,101,1205,127"/>
<area shape="rect" href="app-layer-parser_8c.html#a9f308874dc34fb891799d99c9beb7a84" title=" " alt="" coords="759,181,943,223"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_icgraph" id="astream-tcp-reassemble_8h_ad53c19d8ac0e70cfa806afefc24b273c_icgraph">
<area shape="rect" title=" " alt="" coords="196,31,432,57"/>
<area shape="rect" href="stream-tcp_8c.html#a0929f1a9b555b60d89e3ce16271f89b9" title=" " alt="" coords="5,5,148,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4" title=" " alt="" coords="17,56,137,83"/>
</map>
</div>

</div>
</div>
<a id="ac8dbb2d5c18463f92d4f1d4c55c9bfc4" name="ac8dbb2d5c18463f92d4f1d4c55c9bfc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8dbb2d5c18463f92d4f1d4c55c9bfc4">&#9670;&nbsp;</a></span>StreamTcpReassembleInsertSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleInsertSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTcpSegment.html">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pkt_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pkt_datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>0 ok </dd>
<dd>
-1 segment not inserted due to memcap issue</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seg</td><td>segment, this function takes total ownership</td></tr>
  </table>
  </dd>
</dl>
<p>In case of error, this function returns the segment to the pool </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-list_8c_source.html#l00629">629</a> of file <a class="el" href="stream-tcp-list_8c_source.html">stream-tcp-list.c</a>.</p>

<p class="reference">References <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00136">StreamTcpUTAddSegmentWithByte()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00113">StreamTcpUTAddSegmentWithPayload()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_ac8dbb2d5c18463f92d4f1d4c55c9bfc4_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_ac8dbb2d5c18463f92d4f1d4c55c9bfc4_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_ac8dbb2d5c18463f92d4f1d4c55c9bfc4_icgraph" id="astream-tcp-reassemble_8h_ac8dbb2d5c18463f92d4f1d4c55c9bfc4_icgraph">
<area shape="rect" title=" " alt="" coords="284,27,475,69"/>
<area shape="rect" href="stream-tcp-util_8c.html#a76e6bc7448ccad45a8955265ec14e40a" title=" " alt="" coords="5,5,236,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#aa95bbbdf447725bbfb4948657754d61f" title=" " alt="" coords="19,57,222,98"/>
</map>
</div>

</div>
</div>
<a id="a477c59db3b1fef12cb9b1e5e5de0f59f" name="a477c59db3b1fef12cb9b1e5e5de0f59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477c59db3b1fef12cb9b1e5e5de0f59f">&#9670;&nbsp;</a></span>StreamTcpReassembleMemuseGlobalCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleMemuseGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">147</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a771b5f3f7ef9d74f05f4ce19b0a75b27" name="a771b5f3f7ef9d74f05f4ce19b0a75b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a771b5f3f7ef9d74f05f4ce19b0a75b27">&#9670;&nbsp;</a></span>StreamTcpReassembleRealloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * StreamTcpReassembleRealloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>optr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>orig_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">222</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-mem_8h_source.html#l00050">SCRealloc</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00126">StreamTcpReassembleDecrMemuse()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00113">StreamTcpReassembleIncrMemuse()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph" id="astream-tcp-reassemble_8h_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,207,98"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a1b00d2144fbbf62514e68ba316903c62" title="Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP se..." alt="" coords="275,5,469,47"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="255,71,489,98"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="257,122,487,149"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="569,63,712,90"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="537,115,744,156"/>
</map>
</div>

</div>
</div>
<a id="a4894f48885e4926013c260b03f68685f" name="a4894f48885e4926013c260b03f68685f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4894f48885e4926013c260b03f68685f">&#9670;&nbsp;</a></span>StreamTcpReassembleRegisterTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function Register the Unit tests to test the reassembly engine for various OS policies. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03755">3755</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-unittest_8c_source.html#l00103">UtRegisterTest()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a4894f48885e4926013c260b03f68685f_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a4894f48885e4926013c260b03f68685f_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a4894f48885e4926013c260b03f68685f_cgraph" id="astream-tcp-reassemble_8h_a4894f48885e4926013c260b03f68685f_cgraph">
<area shape="rect" title="The Function Register the Unit tests to test the reassembly engine for various OS policies." alt="" coords="5,5,212,47"/>
<area shape="rect" href="group__Testing.html#ga34617b41f44505d5c3938e4df12c264f" title="Register unit test." alt="" coords="260,13,371,39"/>
</map>
</div>

</div>
</div>
<a id="ad7eea57c7056aa4bba068cf731d3d4a8" name="ad7eea57c7056aa4bba068cf731d3d4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7eea57c7056aa4bba068cf731d3d4a8">&#9670;&nbsp;</a></span>StreamTcpReassembleSetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleSetMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update memcap value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>new memcap value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00182">182</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a569d1edaec7e3d3402e2382025ccd605" name="a569d1edaec7e3d3402e2382025ccd605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a569d1edaec7e3d3402e2382025ccd605">&#9670;&nbsp;</a></span>StreamTcpReassembleTriggerRawReassembly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleTriggerRawReassembly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger RAW stream reassembly. </p>
<p >Used by AppLayerTriggerRawStreamReassembly to trigger RAW stream reassembly from the applayer, for example upon completion of a HTTP request.</p>
<p >It sets a flag in the stream so that the next Raw call will return the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TcpSession </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02064">2064</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00217">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer-parser_8c_source.html#l01499">AppLayerParserTriggerRawStreamReassembly()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a569d1edaec7e3d3402e2382025ccd605_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a569d1edaec7e3d3402e2382025ccd605_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a569d1edaec7e3d3402e2382025ccd605_icgraph" id="astream-tcp-reassemble_8h_a569d1edaec7e3d3402e2382025ccd605_icgraph">
<area shape="rect" title="Trigger RAW stream reassembly." alt="" coords="236,5,433,47"/>
<area shape="rect" href="app-layer-parser_8c.html#af660c95f302aa1c8f1737706c1714b5e" title=" " alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a6cca677b3f6c60ab903b3246bcd5129f" name="a6cca677b3f6c60ab903b3246bcd5129f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cca677b3f6c60ab903b3246bcd5129f">&#9670;&nbsp;</a></span>StreamTcpReassemblySetMinInspectDepth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassemblySetMinInspectDepth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02081">2081</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00130">TcpStream_::min_inspect_depth</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer-smtp_8c_source.html#l00479">SMTPProcessDataChunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a6cca677b3f6c60ab903b3246bcd5129f_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a6cca677b3f6c60ab903b3246bcd5129f_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a6cca677b3f6c60ab903b3246bcd5129f_icgraph" id="astream-tcp-reassemble_8h_a6cca677b3f6c60ab903b3246bcd5129f_icgraph">
<area shape="rect" title=" " alt="" coords="227,5,425,47"/>
<area shape="rect" href="app-layer-smtp_8c.html#aa8c9a12cd961cef05c8aad9e5a628eb1" title=" " alt="" coords="5,13,179,39"/>
</map>
</div>

</div>
</div>
<a id="a96d6fa8305eedd10a095558194edf776" name="a96d6fa8305eedd10a095558194edf776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96d6fa8305eedd10a095558194edf776">&#9670;&nbsp;</a></span>StreamTcpReturnStreamSegments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReturnStreamSegments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return all segments in this stream into the pool(s) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>the stream to cleanup </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">385</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a9ba1e32be404a7a0b5e1a52d39ddf0eb" name="a9ba1e32be404a7a0b5e1a52d39ddf0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba1e32be404a7a0b5e1a52d39ddf0eb">&#9670;&nbsp;</a></span>StreamTcpSegmentReturntoPool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSegmentReturntoPool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTcpSegment.html">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the segment back to the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seg</td><td>Segment which will be returned back to the pool. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00368">368</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00078">TcpSegment::pcap_hdr_storage</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00067">TcpSegmentPcapHdrStorage_::pktlen</a>, and <a class="el" href="util-pool-thread_8c_source.html#l00187">PoolThreadReturn()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">StreamTcpReturnStreamSegments()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_cgraph" id="astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_cgraph">
<area shape="rect" title="Function to return the segment back to the pool." alt="" coords="5,5,217,32"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="265,5,392,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="440,5,527,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_icgraph" id="astream-tcp-reassemble_8h_a9ba1e32be404a7a0b5e1a52d39ddf0eb_icgraph">
<area shape="rect" title="Function to return the segment back to the pool." alt="" coords="981,56,1193,83"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="709,56,933,83"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,5,655,32"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,56,661,83"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,107,660,133"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,81,436,108"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,132,434,159"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,31,189,57"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,132,197,159"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,81,209,108"/>
</map>
</div>

</div>
</div>
<a id="acde93e47910831b8fc81b7cba2740188" name="acde93e47910831b8fc81b7cba2740188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acde93e47910831b8fc81b7cba2740188">&#9670;&nbsp;</a></span>StreamTcpSetDisableRawReassemblyFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetDisableRawReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the No reassembly flag for the given direction in given TCP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06085">6085</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>.</p>

</div>
</div>
<a id="a025c6aeffa2046f8b39ee519edcfa8c1" name="a025c6aeffa2046f8b39ee519edcfa8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025c6aeffa2046f8b39ee519edcfa8c1">&#9670;&nbsp;</a></span>StreamTcpSetOSPolicy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetOSPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the OS policy for the given stream based on the destination of the received packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>TcpStream of which os_policy needs to set </td></tr>
    <tr><td class="paramname">p</td><td>Packet which is used to set the os policy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00773">773</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00217">GET_IPV4_DST_ADDR_PTR</a>, <a class="el" href="decode_8h_source.html#l00222">GET_IPV6_DST_ADDR</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00110">TcpStream_::os_policy</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00039">OS_POLICY_BSD</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00040">OS_POLICY_BSD_RIGHT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00083">OS_POLICY_DEFAULT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00043">OS_POLICY_OLD_SOLARIS</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00044">OS_POLICY_SOLARIS</a>, <a class="el" href="decode_8h_source.html#l00253">PKT_IS_IPV4</a>, <a class="el" href="decode_8h_source.html#l00254">PKT_IS_IPV6</a>, <a class="el" href="util-host-os-info_8c_source.html#l00292">SCHInfoGetIPv4HostOSFlavour()</a>, <a class="el" href="util-host-os-info_8c_source.html#l00310">SCHInfoGetIPv6HostOSFlavour()</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00704">StreamTcpReassembleHandleSegmentHandleData()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_cgraph" id="astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_cgraph">
<area shape="rect" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="5,31,164,57"/>
<area shape="rect" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format." alt="" coords="212,5,423,32"/>
<area shape="rect" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format." alt="" coords="212,56,423,83"/>
<area shape="rect" href="util-radix-tree_8c.html#a3f0f2284278ce9b4b740e9c08d842652" title="Checks if an IPV4 address is present in the tree under a netblock." alt="" coords="471,5,685,32"/>
<area shape="rect" href="util-radix-tree_8c.html#a6cc3963f75cae4474ad3f63869860a98" title="Checks if an IPV6 address is present in the tree under a netblock." alt="" coords="471,56,685,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_icgraph" id="astream-tcp-reassemble_8h_a025c6aeffa2046f8b39ee519edcfa8c1_icgraph">
<area shape="rect" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="471,13,629,39"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="224,5,423,47"/>
<area shape="rect" href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924" title="wrapper for StreamTcpReassembleHandleSegmentHandleData" alt="" coords="5,13,176,39"/>
</map>
</div>

</div>
</div>
<a id="a34dd3f8d3c2e31b5e8afb1b203d245d6" name="a34dd3f8d3c2e31b5e8afb1b203d245d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34dd3f8d3c2e31b5e8afb1b203d245d6">&#9670;&nbsp;</a></span>StreamTcpSetSessionBypassFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetSessionBypassFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable bypass </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06096">6096</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00201">STREAMTCP_FLAG_BYPASS</a>.</p>

</div>
</div>
<a id="aa7a2c8bcfd02ada1794f778c0614d5d1" name="aa7a2c8bcfd02ada1794f778c0614d5d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a2c8bcfd02ada1794f778c0614d5d1">&#9670;&nbsp;</a></span>StreamTcpSetSessionNoReassemblyFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetSessionNoReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>disable reassembly </p>
<p >Disable app layer and set raw inspect to no longer accept new data. Stream engine will then fully disable raw after last inspection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06069">6069</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp-reassemble_8h.html">stream-tcp-reassemble.h</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:24 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
