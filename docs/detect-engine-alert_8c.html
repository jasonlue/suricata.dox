<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/detect-engine-alert.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('detect-engine-alert_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">detect-engine-alert.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-alert_8h_source.html">detect-engine-alert.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-threshold_8h_source.html">detect-engine-threshold.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-tag_8h_source.html">detect-engine-tag.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-private_8h_source.html">flow-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-validate_8h_source.html">util-validate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tests_2detect-engine-alert_8c_source.html">tests/detect-engine-alert.c</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for detect-engine-alert.c:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-alert_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2detect-engine-alert_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2detect-engine-alert_8c" id="a_2Users_2jlu_2suricata_2src_2detect-engine-alert_8c">
<area shape="rect" title=" " alt="" coords="1243,5,1409,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="1653,259,1786,285"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="1207,333,1347,360"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1923,632,1998,659"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1134,408,1203,435"/>
<area shape="rect" href="flow_8h.html" title=" " alt="" coords="5,483,60,509"/>
<area shape="rect" href="detect-engine-threshold_8h.html" title=" " alt="" coords="205,333,373,360"/>
<area shape="rect" href="detect-engine-tag_8h.html" title=" " alt="" coords="1105,95,1238,121"/>
<area shape="rect" href="flow-private_8h.html" title=" " alt="" coords="1472,95,1572,121"/>
<area shape="rect" href="util-profiling_8h.html" title=" " alt="" coords="1597,95,1695,121"/>
<area shape="rect" href="util-validate_8h.html" title=" " alt="" coords="1719,95,1818,121"/>
<area shape="rect" href="tests_2detect-engine-alert_8c.html" title=" " alt="" coords="1155,169,1289,211"/>
<area shape="rect" title=" " alt="" coords="1735,333,1800,360"/>
<area shape="rect" title=" " alt="" coords="1876,333,1955,360"/>
<area shape="rect" title=" " alt="" coords="1979,333,2044,360"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="72,557,175,584"/>
<area shape="rect" title=" " alt="" coords="2068,333,2141,360"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="2325,781,2401,808"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="2166,333,2315,360"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="2401,707,2491,733"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="2457,781,2536,808"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="1422,333,1505,360"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="1529,333,1608,360"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="1632,333,1711,360"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="1970,707,2087,733"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="2112,707,2207,733"/>
<area shape="rect" href="decode-events_8h.html" title=" " alt="" coords="1445,707,1564,733"/>
<area shape="rect" href="flow-worker_8h.html" title=" " alt="" coords="1589,707,1687,733"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="631,707,757,733"/>
<area shape="rect" href="util-napatech_8h.html" title=" " alt="" coords="1711,707,1818,733"/>
<area shape="rect" href="source-nflog_8h.html" title=" " alt="" coords="1842,707,1946,733"/>
<area shape="rect" href="source-nfq_8h.html" title=" " alt="" coords="2231,707,2325,733"/>
<area shape="rect" href="detect-engine-proto_8h.html" title=" " alt="" coords="1450,483,1594,509"/>
<area shape="rect" href="detect-reference_8h.html" title=" " alt="" coords="1619,483,1745,509"/>
<area shape="rect" href="detect-metadata_8h.html" title=" " alt="" coords="405,483,532,509"/>
<area shape="rect" href="detect-engine-register_8h.html" title=" " alt="" coords="557,483,714,509"/>
<area shape="rect" href="util-prefilter_8h.html" title=" " alt="" coords="1818,557,1914,584"/>
<area shape="rect" href="util-mpm_8h.html" title=" " alt="" coords="1885,483,1967,509"/>
<area shape="rect" href="util-spm_8h.html" title=" " alt="" coords="739,483,817,509"/>
<area shape="rect" href="util-hash_8h.html" title=" " alt="" coords="842,483,925,509"/>
<area shape="rect" href="util-hashlist_8h.html" title=" " alt="" coords="949,483,1047,509"/>
<area shape="rect" href="util-radix-tree_8h.html" title=" " alt="" coords="1072,483,1180,509"/>
<area shape="rect" href="util-file_8h.html" title=" " alt="" coords="1204,483,1275,509"/>
<area shape="rect" href="reputation_8h.html" title=" " alt="" coords="1770,483,1861,509"/>
<area shape="rect" href="app-layer-events_8h.html" title=" " alt="" coords="1939,557,2068,584"/>
<area shape="rect" href="detect-threshold_8h.html" title=" " alt="" coords="1299,483,1425,509"/>
<area shape="rect" href="host_8h.html" title=" " alt="" coords="338,557,397,584"/>
<area shape="rect" href="ippair_8h.html" title=" " alt="" coords="129,408,192,435"/>
<area shape="rect" href="host-storage_8h.html" title=" " alt="" coords="216,408,321,435"/>
<area shape="rect" href="detect-tag_8h.html" title=" " alt="" coords="1363,177,1454,203"/>
</map>
</div>
</div>
<p><a href="detect-engine-alert_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a352e97b222bb239a5881d98bdc307784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a352e97b222bb239a5881d98bdc307784">PacketAlertTagInit</a> (void)</td></tr>
<tr class="separator:a352e97b222bb239a5881d98bdc307784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d1198fbcb049e95335e38c4fb0e89d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a8e868a8ff48d73231bdba7e073ca8ef8">PacketAlert</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a83d1198fbcb049e95335e38c4fb0e89d">PacketAlertGetTag</a> (void)</td></tr>
<tr class="separator:a83d1198fbcb049e95335e38c4fb0e89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7be8c483cd300583ccce00b1b8502e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#aa7be8c483cd300583ccce00b1b8502e6">PacketAlertCheck</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, uint32_t sid)</td></tr>
<tr class="memdesc:aa7be8c483cd300583ccce00b1b8502e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a certain sid alerted, this is used in the test functions.  <a href="detect-engine-alert_8c.html#aa7be8c483cd300583ccce00b1b8502e6">More...</a><br /></td></tr>
<tr class="separator:aa7be8c483cd300583ccce00b1b8502e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a2d5715cc5c30e1724095c349c374c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a74a2d5715cc5c30e1724095c349c374c">AlertQueueInit</a> (<a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *det_ctx)</td></tr>
<tr class="separator:a74a2d5715cc5c30e1724095c349c374c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a906692b33adaa7674d7def5d920cca12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a906692b33adaa7674d7def5d920cca12">AlertQueueFree</a> (<a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *det_ctx)</td></tr>
<tr class="separator:a906692b33adaa7674d7def5d920cca12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a1950e6f21f643682dfeae011036de7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a2a1950e6f21f643682dfeae011036de7">AlertQueueAppend</a> (<a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *det_ctx, const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *s, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, uint64_t tx_id, uint8_t alert_flags)</td></tr>
<tr class="memdesc:a2a1950e6f21f643682dfeae011036de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append signature to local packet alert queue for later preprocessing.  <a href="detect-engine-alert_8c.html#a2a1950e6f21f643682dfeae011036de7">More...</a><br /></td></tr>
<tr class="separator:a2a1950e6f21f643682dfeae011036de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464327c97eb2fde5f130af99e80133bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-alert_8c.html#a464327c97eb2fde5f130af99e80133bc">PacketAlertFinalize</a> (<a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *<a class="el" href="fuzz__siginit_8c.html#acddc8144764f1c83e62c17369417e646">de_ctx</a>, <a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *det_ctx, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a464327c97eb2fde5f130af99e80133bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the threshold of the sigs that match, set actions, break on pass action This function iterate the packet alerts array, removing those that didn't match the threshold, and those that match after a signature with the action "pass". The array is sorted by action priority/order.  <a href="detect-engine-alert_8c.html#a464327c97eb2fde5f130af99e80133bc">More...</a><br /></td></tr>
<tr class="separator:a464327c97eb2fde5f130af99e80133bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2a1950e6f21f643682dfeae011036de7" name="a2a1950e6f21f643682dfeae011036de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a1950e6f21f643682dfeae011036de7">&#9670;&nbsp;</a></span>AlertQueueAppend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AlertQueueAppend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tx_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>alert_flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append signature to local packet alert queue for later preprocessing. </p>

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00273">273</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00273">PacketAlert_::action</a>, <a class="el" href="detect_8h_source.html#l00554">Signature_::action</a>, <a class="el" href="action-globals_8h_source.html#l00030">ACTION_DROP</a>, <a class="el" href="decode_8h_source.html#l00589">Packet_::alerts</a>, and <a class="el" href="decode_8h_source.html#l00303">PacketAlerts_::drop</a>.</p>

</div>
</div>
<a id="a906692b33adaa7674d7def5d920cca12" name="a906692b33adaa7674d7def5d920cca12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a906692b33adaa7674d7def5d920cca12">&#9670;&nbsp;</a></span>AlertQueueFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AlertQueueFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00225">225</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

<p class="reference">References <a class="el" href="detect_8h_source.html#l01113">DetectEngineThreadCtx_::alert_queue</a>, <a class="el" href="detect_8h_source.html#l01112">DetectEngineThreadCtx_::alert_queue_capacity</a>, and <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>.</p>

</div>
</div>
<a id="a74a2d5715cc5c30e1724095c349c374c" name="a74a2d5715cc5c30e1724095c349c374c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a2d5715cc5c30e1724095c349c374c">&#9670;&nbsp;</a></span>AlertQueueInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AlertQueueInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00212">212</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

<p class="reference">References <a class="el" href="detect_8h_source.html#l01113">DetectEngineThreadCtx_::alert_queue</a>, <a class="el" href="detect_8h_source.html#l01112">DetectEngineThreadCtx_::alert_queue_capacity</a>, <a class="el" href="detect_8h_source.html#l01111">DetectEngineThreadCtx_::alert_queue_size</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="decode_8c_source.html#l00080">packet_alert_max</a>, <a class="el" href="util-error_8h_source.html#l00031">SC_ERR_MEM_ALLOC</a>, <a class="el" href="util-mem_8h_source.html#l00053">SCCalloc</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

</div>
</div>
<a id="aa7be8c483cd300583ccce00b1b8502e6" name="aa7be8c483cd300583ccce00b1b8502e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7be8c483cd300583ccce00b1b8502e6">&#9670;&nbsp;</a></span>PacketAlertCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PacketAlertCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a certain sid alerted, this is used in the test functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Packet on which we want to check if the signature alerted or not </td></tr>
    <tr><td class="paramname">sid</td><td>Signature id of the signature that has to be checked for a match</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">match</td><td>A value &gt; 0 on a match; 0 on no match </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00142">142</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00300">PacketAlerts_::alerts</a>, <a class="el" href="decode_8h_source.html#l00589">Packet_::alerts</a>, <a class="el" href="decode_8h_source.html#l00297">PacketAlerts_::cnt</a>, <a class="el" href="detect_8h_source.html#l00574">Signature_::id</a>, and <a class="el" href="decode_8h_source.html#l00275">PacketAlert_::s</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-unittest-helper_8c_source.html#l00644">UTHCheckPacketMatchResults()</a>, <a class="el" href="util-unittest-helper_8c_source.html#l00842">UTHPacketMatchSig()</a>, and <a class="el" href="util-unittest-helper_8c_source.html#l00788">UTHPacketMatchSigMpm()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-alert_8c_aa7be8c483cd300583ccce00b1b8502e6_icgraph.png" border="0" usemap="#adetect-engine-alert_8c_aa7be8c483cd300583ccce00b1b8502e6_icgraph" alt=""/></div>
<map name="adetect-engine-alert_8c_aa7be8c483cd300583ccce00b1b8502e6_icgraph" id="adetect-engine-alert_8c_aa7be8c483cd300583ccce00b1b8502e6_icgraph">
<area shape="rect" title="Check if a certain sid alerted, this is used in the test functions." alt="" coords="687,56,815,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#a74a4885e958035b339fc99060729d21e" title="UTHCheckPacketMatches: function to check if a packet match some sids." alt="" coords="428,5,639,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#a30ad84488c5292331f23f02a0f121175" title=" " alt="" coords="460,56,607,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#ae2b42a605040aa0a6528f2fda98881e7" title=" " alt="" coords="446,107,621,133"/>
<area shape="rect" href="util-unittest-helper_8c.html#a790d3ec8bd4307b5f5891fd26c9af364" title=" " alt="" coords="173,5,380,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#ab06c363b5a68bae722b6b7c0a4e7e7f3" title="UTHGenericTest: function that perfom a generic check taking care of as maximum common unittest elemen..." alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
<a id="a464327c97eb2fde5f130af99e80133bc" name="a464327c97eb2fde5f130af99e80133bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464327c97eb2fde5f130af99e80133bc">&#9670;&nbsp;</a></span>PacketAlertFinalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketAlertFinalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the threshold of the sigs that match, set actions, break on pass action This function iterate the packet alerts array, removing those that didn't match the threshold, and those that match after a signature with the action "pass". The array is sorted by action priority/order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>detection engine context </td></tr>
    <tr><td class="paramname">det_ctx</td><td>detection engine thread context </td></tr>
    <tr><td class="paramname">p</td><td>pointer to the packet </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00348">348</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

<p class="reference">References <a class="el" href="detect_8h_source.html#l01113">DetectEngineThreadCtx_::alert_queue</a>, <a class="el" href="detect_8h_source.html#l01111">DetectEngineThreadCtx_::alert_queue_size</a>, and <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>.</p>

</div>
</div>
<a id="a83d1198fbcb049e95335e38c4fb0e89d" name="a83d1198fbcb049e95335e38c4fb0e89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d1198fbcb049e95335e38c4fb0e89d">&#9670;&nbsp;</a></span>PacketAlertGetTag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a8e868a8ff48d73231bdba7e073ca8ef8">PacketAlert</a> * PacketAlertGetTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00058">58</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

</div>
</div>
<a id="a352e97b222bb239a5881d98bdc307784" name="a352e97b222bb239a5881d98bdc307784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a352e97b222bb239a5881d98bdc307784">&#9670;&nbsp;</a></span>PacketAlertTagInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketAlertTagInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-alert_8c_source.html#l00042">42</a> of file <a class="el" href="detect-engine-alert_8c_source.html">detect-engine-alert.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="detect-engine-alert_8c.html">detect-engine-alert.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:22 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
