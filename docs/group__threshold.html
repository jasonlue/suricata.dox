<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: Thresholding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__threshold.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Thresholding</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:detect-engine-threshold_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-threshold_8c.html">detect-engine-threshold.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:detect-threshold_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-threshold_8c.html">detect-threshold.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:util-threshold-config_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-threshold-config_8c.html">util-threshold-config.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab56fa5190dc82cc6e532b6925c05471b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="host-storage_8h.html#a3bc4fc949eb2d3ae36adab1cf431ccd2">HostStorageId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#gab56fa5190dc82cc6e532b6925c05471b">ThresholdHostStorageId</a> (void)</td></tr>
<tr class="separator:gab56fa5190dc82cc6e532b6925c05471b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56569edacd3bd0a6d0654c853b9e8903"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga56569edacd3bd0a6d0654c853b9e8903">ThresholdInit</a> (void)</td></tr>
<tr class="separator:ga56569edacd3bd0a6d0654c853b9e8903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12823c5b56e0d076a83250e3d40270d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga12823c5b56e0d076a83250e3d40270d1">ThresholdHostHasThreshold</a> (<a class="el" href="host_8h.html#a9ff12a66d80c706d1b0413ee4cf6bfcf">Host</a> *host)</td></tr>
<tr class="separator:ga12823c5b56e0d076a83250e3d40270d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27faa3ff07db0b088708b7d82a3d812b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga27faa3ff07db0b088708b7d82a3d812b">ThresholdIPPairHasThreshold</a> (<a class="el" href="ippair_8h.html#a4bde479d6fd0b62e9add97567e950968">IPPair</a> *pair)</td></tr>
<tr class="separator:ga27faa3ff07db0b088708b7d82a3d812b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27d192ea40d7fa5cd9ee605fd1870cd9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga27d192ea40d7fa5cd9ee605fd1870cd9">SigGetThresholdTypeIter</a> (const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *sig, const <a class="el" href="detect_8h.html#acf35bbeb5f973af3ce9af81c6ed27c5a">SigMatchData</a> **psm, int list)</td></tr>
<tr class="memdesc:ga27d192ea40d7fa5cd9ee605fd1870cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return next DetectThresholdData for signature.  <a href="group__threshold.html#ga27d192ea40d7fa5cd9ee605fd1870cd9">More...</a><br /></td></tr>
<tr class="separator:ga27d192ea40d7fa5cd9ee605fd1870cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29c8b667e031bfd252e6ab664ef9c65f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga29c8b667e031bfd252e6ab664ef9c65f">ThresholdHostTimeoutCheck</a> (<a class="el" href="host_8h.html#a9ff12a66d80c706d1b0413ee4cf6bfcf">Host</a> *host, struct timeval *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>)</td></tr>
<tr class="separator:ga29c8b667e031bfd252e6ab664ef9c65f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad395285ed6c4f093962c1213eef991e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#gad395285ed6c4f093962c1213eef991e2">ThresholdIPPairTimeoutCheck</a> (<a class="el" href="ippair_8h.html#a4bde479d6fd0b62e9add97567e950968">IPPair</a> *pair, struct timeval *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>)</td></tr>
<tr class="separator:gad395285ed6c4f093962c1213eef991e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga830d2601dcb7711a8c0c721eeeec4c49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga830d2601dcb7711a8c0c721eeeec4c49">PacketAlertThreshold</a> (<a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *<a class="el" href="fuzz__siginit_8c.html#acddc8144764f1c83e62c17369417e646">de_ctx</a>, <a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *det_ctx, const <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *td, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *s, <a class="el" href="decode_8h.html#a8e868a8ff48d73231bdba7e073ca8ef8">PacketAlert</a> *pa)</td></tr>
<tr class="memdesc:ga830d2601dcb7711a8c0c721eeeec4c49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the threshold logic for signatures.  <a href="group__threshold.html#ga830d2601dcb7711a8c0c721eeeec4c49">More...</a><br /></td></tr>
<tr class="separator:ga830d2601dcb7711a8c0c721eeeec4c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d0d51c920ab9996dccf423be2a42e75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga5d0d51c920ab9996dccf423be2a42e75">ThresholdHashInit</a> (<a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *<a class="el" href="fuzz__siginit_8c.html#acddc8144764f1c83e62c17369417e646">de_ctx</a>)</td></tr>
<tr class="memdesc:ga5d0d51c920ab9996dccf423be2a42e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init threshold context hash tables.  <a href="group__threshold.html#ga5d0d51c920ab9996dccf423be2a42e75">More...</a><br /></td></tr>
<tr class="separator:ga5d0d51c920ab9996dccf423be2a42e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd5f0973bfb372f61c9f998316ee98a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#gadd5f0973bfb372f61c9f998316ee98a9">ThresholdHashAllocate</a> (<a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *<a class="el" href="fuzz__siginit_8c.html#acddc8144764f1c83e62c17369417e646">de_ctx</a>)</td></tr>
<tr class="memdesc:gadd5f0973bfb372f61c9f998316ee98a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate threshold context hash tables.  <a href="group__threshold.html#gadd5f0973bfb372f61c9f998316ee98a9">More...</a><br /></td></tr>
<tr class="separator:gadd5f0973bfb372f61c9f998316ee98a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga438c0d2d9103c7ae29bc422b972ea89f">ThresholdContextDestroy</a> (<a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *<a class="el" href="fuzz__siginit_8c.html#acddc8144764f1c83e62c17369417e646">de_ctx</a>)</td></tr>
<tr class="memdesc:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy threshold context hash tables.  <a href="group__threshold.html#ga438c0d2d9103c7ae29bc422b972ea89f">More...</a><br /></td></tr>
<tr class="separator:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49528de5969274cd2b6586bff7dbaae8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga49528de5969274cd2b6586bff7dbaae8">ThresholdListFree</a> (void *ptr)</td></tr>
<tr class="memdesc:ga49528de5969274cd2b6586bff7dbaae8"><td class="mdescLeft">&#160;</td><td class="mdescRight">this function will free all the entries of a list DetectTagDataEntry  <a href="group__threshold.html#ga49528de5969274cd2b6586bff7dbaae8">More...</a><br /></td></tr>
<tr class="separator:ga49528de5969274cd2b6586bff7dbaae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >This feature is used to reduce the number of logged alerts for noisy rules. This can be tuned to significantly reduce false alarms, and it can also be used to write a newer breed of rules. Thresholding commands limit the number of times a particular event is logged during a specified time interval. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga830d2601dcb7711a8c0c721eeeec4c49" name="ga830d2601dcb7711a8c0c721eeeec4c49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga830d2601dcb7711a8c0c721eeeec4c49">&#9670;&nbsp;</a></span>PacketAlertThreshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PacketAlertThreshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#ab095f689e03ab2d0d1ceeb2392d70489">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a8e868a8ff48d73231bdba7e073ca8ef8">PacketAlert</a> *&#160;</td>
          <td class="paramname"><em>pa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make the threshold logic for signatures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
    <tr><td class="paramname">tsh_ptr</td><td>Threshold element </td></tr>
    <tr><td class="paramname">p</td><td>Packet structure </td></tr>
    <tr><td class="paramname">s</td><td>Signature structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">2</td><td>silent match (no alert but apply actions) </td></tr>
    <tr><td class="paramname">1</td><td>alert on this event </td></tr>
    <tr><td class="paramname">0</td><td>do not alert on this event </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00604">604</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="detect-threshold_8h_source.html#l00057">DetectThresholdData_::type</a>, and <a class="el" href="detect-threshold_8h_source.html#l00033">TYPE_SUPPRESS</a>.</p>

</div>
</div>
<a id="ga27d192ea40d7fa5cd9ee605fd1870cd9" name="ga27d192ea40d7fa5cd9ee605fd1870cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga27d192ea40d7fa5cd9ee605fd1870cd9">&#9670;&nbsp;</a></span>SigGetThresholdTypeIter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> * SigGetThresholdTypeIter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="detect_8h.html#a2e302beff3fc4044e240b39fe8bc47e6">Signature</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="detect_8h.html#acf35bbeb5f973af3ce9af81c6ed27c5a">SigMatchData</a> **&#160;</td>
          <td class="paramname"><em>psm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return next DetectThresholdData for signature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sig</td><td>Signature pointer </td></tr>
    <tr><td class="paramname">psm</td><td>Pointer to a Signature Match pointer </td></tr>
    <tr><td class="paramname">list</td><td>List to return data from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">tsh</td><td>Return the threshold data from signature or NULL if not found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00112">112</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="detect-engine-threshold_8c_source.html#l00662">ThresholdHashAllocate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga27d192ea40d7fa5cd9ee605fd1870cd9_icgraph.png" border="0" usemap="#agroup__threshold_ga27d192ea40d7fa5cd9ee605fd1870cd9_icgraph" alt=""/></div>
<map name="agroup__threshold_ga27d192ea40d7fa5cd9ee605fd1870cd9_icgraph" id="agroup__threshold_ga27d192ea40d7fa5cd9ee605fd1870cd9_icgraph">
<area shape="rect" title="Return next DetectThresholdData for signature." alt="" coords="211,5,377,32"/>
<area shape="rect" href="group__threshold.html#gadd5f0973bfb372f61c9f998316ee98a9" title="Allocate threshold context hash tables." alt="" coords="5,5,163,32"/>
</map>
</div>

</div>
</div>
<a id="ga438c0d2d9103c7ae29bc422b972ea89f" name="ga438c0d2d9103c7ae29bc422b972ea89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga438c0d2d9103c7ae29bc422b972ea89f">&#9670;&nbsp;</a></span>ThresholdContextDestroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdContextDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy threshold context hash tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00732">732</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="fuzz__siginit_8c_source.html#l00017">de_ctx</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="threads-debug_8h_source.html#l00120">SCMutexDestroy</a>, <a class="el" href="detect_8h_source.html#l00734">ThresholdCtx_::th_entry</a>, <a class="el" href="detect_8h_source.html#l00735">ThresholdCtx_::th_size</a>, <a class="el" href="detect_8h_source.html#l00731">ThresholdCtx_::threshold_table_lock</a>, and <a class="el" href="detect_8h_source.html#l00833">DetectEngineCtx_::ths_ctx</a>.</p>

<p class="reference">Referenced by <a class="el" href="detect-engine_8c_source.html#l02445">DetectEngineCtxFree()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph.png" border="0" usemap="#agroup__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph" alt=""/></div>
<map name="agroup__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph" id="agroup__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph">
<area shape="rect" title="Destroy threshold context hash tables." alt="" coords="424,81,595,108"/>
<area shape="rect" href="detect-engine_8c.html#a7d42bbc5847dc1ed0cf5b1fc4d118c0c" title="Free a DetectEngineCtx::" alt="" coords="228,81,376,108"/>
<area shape="rect" href="util-unittest-helper_8c.html#ab06c363b5a68bae722b6b7c0a4e7e7f3" title="UTHGenericTest: function that perfom a generic check taking care of as maximum common unittest elemen..." alt="" coords="33,5,153,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#a30ad84488c5292331f23f02a0f121175" title=" " alt="" coords="19,56,166,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#ae2b42a605040aa0a6528f2fda98881e7" title=" " alt="" coords="5,107,180,133"/>
<area shape="rect" href="util-unittest-helper_8c.html#ad3bd5728dbe7bb02f007b33870b1de18" title="parser a sig and see if the expected result is correct" alt="" coords="23,157,162,184"/>
</map>
</div>

</div>
</div>
<a id="gadd5f0973bfb372f61c9f998316ee98a9" name="gadd5f0973bfb372f61c9f998316ee98a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadd5f0973bfb372f61c9f998316ee98a9">&#9670;&nbsp;</a></span>ThresholdHashAllocate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdHashAllocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate threshold context hash tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Detection Context </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00662">662</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="fuzz__siginit_8c_source.html#l00017">de_ctx</a>, <a class="el" href="detect_8h_source.html#l00094">DETECT_SM_LIST_SUPPRESS</a>, <a class="el" href="detect_8h_source.html#l00095">DETECT_SM_LIST_THRESHOLD</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="detect_8h_source.html#l00614">Signature_::next</a>, <a class="el" href="detect_8h_source.html#l00551">Signature_::num</a>, <a class="el" href="util-error_8h_source.html#l00031">SC_ERR_MEM_ALLOC</a>, <a class="el" href="util-mem_8h_source.html#l00053">SCCalloc</a>, <a class="el" href="detect_8h_source.html#l00791">DetectEngineCtx_::sig_list</a>, <a class="el" href="detect-engine-threshold_8c_source.html#l00112">SigGetThresholdTypeIter()</a>, <a class="el" href="detect_8h_source.html#l00595">Signature_::sm_arrays</a>, <a class="el" href="detect_8h_source.html#l00734">ThresholdCtx_::th_entry</a>, <a class="el" href="detect_8h_source.html#l00735">ThresholdCtx_::th_size</a>, <a class="el" href="detect_8h_source.html#l00833">DetectEngineCtx_::ths_ctx</a>, <a class="el" href="detect-threshold_8h_source.html#l00058">DetectThresholdData_::track</a>, and <a class="el" href="detect-threshold_8h_source.html#l00037">TRACK_RULE</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_gadd5f0973bfb372f61c9f998316ee98a9_cgraph.png" border="0" usemap="#agroup__threshold_gadd5f0973bfb372f61c9f998316ee98a9_cgraph" alt=""/></div>
<map name="agroup__threshold_gadd5f0973bfb372f61c9f998316ee98a9_cgraph" id="agroup__threshold_gadd5f0973bfb372f61c9f998316ee98a9_cgraph">
<area shape="rect" title="Allocate threshold context hash tables." alt="" coords="5,5,163,32"/>
<area shape="rect" href="group__threshold.html#ga27d192ea40d7fa5cd9ee605fd1870cd9" title="Return next DetectThresholdData for signature." alt="" coords="211,5,377,32"/>
</map>
</div>

</div>
</div>
<a id="ga5d0d51c920ab9996dccf423be2a42e75" name="ga5d0d51c920ab9996dccf423be2a42e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5d0d51c920ab9996dccf423be2a42e75">&#9670;&nbsp;</a></span>ThresholdHashInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdHashInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#afc9c5f6594662d87e32c40d8d6c4b0cf">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init threshold context hash tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00649">649</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="fuzz__siginit_8c_source.html#l00017">de_ctx</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="threads-debug_8h_source.html#l00116">SCMutexInit</a>, <a class="el" href="detect_8h_source.html#l00731">ThresholdCtx_::threshold_table_lock</a>, and <a class="el" href="detect_8h_source.html#l00833">DetectEngineCtx_::ths_ctx</a>.</p>

</div>
</div>
<a id="ga12823c5b56e0d076a83250e3d40270d1" name="ga12823c5b56e0d076a83250e3d40270d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12823c5b56e0d076a83250e3d40270d1">&#9670;&nbsp;</a></span>ThresholdHostHasThreshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHostHasThreshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="host_8h.html#a9ff12a66d80c706d1b0413ee4cf6bfcf">Host</a> *&#160;</td>
          <td class="paramname"><em>host</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00093">93</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="host-storage_8c_source.html#l00088">HostGetStorageById()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph.png" border="0" usemap="#agroup__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph" alt=""/></div>
<map name="agroup__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph" id="agroup__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,193,32"/>
<area shape="rect" href="group__hoststorage.html#gabead7d5b83cee70236b822995f13a6bc" title="Get a value from a given Host storage." alt="" coords="241,5,384,32"/>
<area shape="rect" href="util-storage_8c.html#a087864e35f683908abf849f04708ef1a" title="get storage for id" alt="" coords="432,5,547,32"/>
</map>
</div>

</div>
</div>
<a id="gab56fa5190dc82cc6e532b6925c05471b" name="gab56fa5190dc82cc6e532b6925c05471b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab56fa5190dc82cc6e532b6925c05471b">&#9670;&nbsp;</a></span>ThresholdHostStorageId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="host-storage_8h.html#a3bc4fc949eb2d3ae36adab1cf431ccd2">HostStorageId</a> ThresholdHostStorageId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00074">74</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

</div>
</div>
<a id="ga29c8b667e031bfd252e6ab664ef9c65f" name="ga29c8b667e031bfd252e6ab664ef9c65f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29c8b667e031bfd252e6ab664ef9c65f">&#9670;&nbsp;</a></span>ThresholdHostTimeoutCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHostTimeoutCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="host_8h.html#a9ff12a66d80c706d1b0413ee4cf6bfcf">Host</a> *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00192">192</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="flow-hash_8h_source.html#l00001">head</a>, and <a class="el" href="host-storage_8c_source.html#l00088">HostGetStorageById()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga29c8b667e031bfd252e6ab664ef9c65f_cgraph.png" border="0" usemap="#agroup__threshold_ga29c8b667e031bfd252e6ab664ef9c65f_cgraph" alt=""/></div>
<map name="agroup__threshold_ga29c8b667e031bfd252e6ab664ef9c65f_cgraph" id="agroup__threshold_ga29c8b667e031bfd252e6ab664ef9c65f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,197,32"/>
<area shape="rect" href="group__hoststorage.html#gabead7d5b83cee70236b822995f13a6bc" title="Get a value from a given Host storage." alt="" coords="245,5,388,32"/>
<area shape="rect" href="util-storage_8c.html#a087864e35f683908abf849f04708ef1a" title="get storage for id" alt="" coords="436,5,551,32"/>
</map>
</div>

</div>
</div>
<a id="ga56569edacd3bd0a6d0654c853b9e8903" name="ga56569edacd3bd0a6d0654c853b9e8903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56569edacd3bd0a6d0654c853b9e8903">&#9670;&nbsp;</a></span>ThresholdInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00079">79</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

</div>
</div>
<a id="ga27faa3ff07db0b088708b7d82a3d812b" name="ga27faa3ff07db0b088708b7d82a3d812b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga27faa3ff07db0b088708b7d82a3d812b">&#9670;&nbsp;</a></span>ThresholdIPPairHasThreshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdIPPairHasThreshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ippair_8h.html#a4bde479d6fd0b62e9add97567e950968">IPPair</a> *&#160;</td>
          <td class="paramname"><em>pair</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00098">98</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="ippair-storage_8c_source.html#l00035">IPPairGetStorageById()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga27faa3ff07db0b088708b7d82a3d812b_cgraph.png" border="0" usemap="#agroup__threshold_ga27faa3ff07db0b088708b7d82a3d812b_cgraph" alt=""/></div>
<map name="agroup__threshold_ga27faa3ff07db0b088708b7d82a3d812b_cgraph" id="agroup__threshold_ga27faa3ff07db0b088708b7d82a3d812b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,201,32"/>
<area shape="rect" href="ippair-storage_8c.html#a195f094ddf83c2bf8d1d306bdfb779ae" title=" " alt="" coords="249,5,400,32"/>
<area shape="rect" href="util-storage_8c.html#a087864e35f683908abf849f04708ef1a" title="get storage for id" alt="" coords="448,5,563,32"/>
</map>
</div>

</div>
</div>
<a id="gad395285ed6c4f093962c1213eef991e2" name="gad395285ed6c4f093962c1213eef991e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad395285ed6c4f093962c1213eef991e2">&#9670;&nbsp;</a></span>ThresholdIPPairTimeoutCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdIPPairTimeoutCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ippair_8h.html#a4bde479d6fd0b62e9add97567e950968">IPPair</a> *&#160;</td>
          <td class="paramname"><em>pair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00203">203</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="flow-hash_8h_source.html#l00001">head</a>, and <a class="el" href="ippair-storage_8c_source.html#l00035">IPPairGetStorageById()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_gad395285ed6c4f093962c1213eef991e2_cgraph.png" border="0" usemap="#agroup__threshold_gad395285ed6c4f093962c1213eef991e2_cgraph" alt=""/></div>
<map name="agroup__threshold_gad395285ed6c4f093962c1213eef991e2_cgraph" id="agroup__threshold_gad395285ed6c4f093962c1213eef991e2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,205,32"/>
<area shape="rect" href="ippair-storage_8c.html#a195f094ddf83c2bf8d1d306bdfb779ae" title=" " alt="" coords="253,5,404,32"/>
<area shape="rect" href="util-storage_8c.html#a087864e35f683908abf849f04708ef1a" title="get storage for id" alt="" coords="452,5,567,32"/>
</map>
</div>

</div>
</div>
<a id="ga49528de5969274cd2b6586bff7dbaae8" name="ga49528de5969274cd2b6586bff7dbaae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49528de5969274cd2b6586bff7dbaae8">&#9670;&nbsp;</a></span>ThresholdListFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdListFree </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this function will free all the entries of a list DetectTagDataEntry </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">td</td><td>pointer to DetectTagDataEntryList </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00751">751</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p class="reference">References <a class="el" href="detect-threshold_8h_source.html#l00076">DetectThresholdEntry_::next</a>, and <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:25 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
