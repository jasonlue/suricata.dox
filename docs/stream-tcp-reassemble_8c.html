<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/stream-tcp-reassemble.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('stream-tcp-reassemble_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">stream-tcp-reassemble.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-pool_8h_source.html">util-pool.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-print_8h_source.html">util-print.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-host-os-info_8h_source.html">util-host-os-info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-unittest-helper_8h_source.html">util-unittest-helper.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-byte_8h_source.html">util-byte.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-device_8h_source.html">util-device.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-inline_8h_source.html">stream-tcp-inline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-list_8h_source.html">stream-tcp-list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-util_8h_source.html">stream-tcp-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-protos_8h_source.html">app-layer-protos.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer_8h_source.html">app-layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-events_8h_source.html">app-layer-events.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-frames_8h_source.html">app-layer-frames.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-validate_8h_source.html">util-validate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-exception-policy_8h_source.html">util-exception-policy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tests_2stream-tcp-reassemble_8c_source.html">tests/stream-tcp-reassemble.c</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp-reassemble.c:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8c" id="a_2Users_2jlu_2suricata_2src_2stream-tcp-reassemble_8c">
<area shape="rect" title=" " alt="" coords="1007,5,1199,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="985,393,1119,420"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="550,543,626,569"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="626,468,715,495"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1596,543,1665,569"/>
<area shape="rect" href="flow_8h.html" title=" " alt="" coords="319,617,374,644"/>
<area shape="rect" href="util-exception-policy_8h.html" title=" " alt="" coords="5,692,152,719"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="247,692,374,719"/>
<area shape="rect" href="app-layer-events_8h.html" title=" " alt="" coords="1843,617,1973,644"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="700,543,759,569"/>
<area shape="rect" href="suricata_8h.html" title=" " alt="" coords="1135,319,1214,345"/>
<area shape="rect" href="flow-util_8h.html" title=" " alt="" coords="1899,244,1978,271"/>
<area shape="rect" href="stream-tcp-private_8h.html" title=" " alt="" coords="1403,319,1541,345"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="554,244,649,271"/>
<area shape="rect" href="tm-threads_8h.html" title=" " alt="" coords="351,319,446,345"/>
<area shape="rect" href="util-pool_8h.html" title=" " alt="" coords="757,95,835,121"/>
<area shape="rect" href="util-unittest_8h.html" title=" " alt="" coords="765,169,862,196"/>
<area shape="rect" href="util-print_8h.html" title=" " alt="" coords="886,169,965,196"/>
<area shape="rect" href="util-host-os-info_8h.html" title=" " alt="" coords="1135,95,1257,121"/>
<area shape="rect" href="util-unittest-helper_8h.html" title=" " alt="" coords="1282,95,1417,121"/>
<area shape="rect" href="util-byte_8h.html" title=" " alt="" coords="1441,95,1519,121"/>
<area shape="rect" href="util-device_8h.html" title=" " alt="" coords="1543,95,1635,121"/>
<area shape="rect" href="stream-tcp_8h.html" title=" " alt="" coords="1449,169,1543,196"/>
<area shape="rect" href="stream_8h.html" title=" " alt="" coords="1510,244,1583,271"/>
<area shape="rect" href="stream-tcp-reassemble_8h.html" title=" " alt="" coords="1091,244,1258,271"/>
<area shape="rect" href="stream-tcp-inline_8h.html" title=" " alt="" coords="1810,169,1939,196"/>
<area shape="rect" href="stream-tcp-list_8h.html" title=" " alt="" coords="1567,169,1683,196"/>
<area shape="rect" href="stream-tcp-util_8h.html" title=" " alt="" coords="1309,169,1425,196"/>
<area shape="rect" href="app-layer_8h.html" title=" " alt="" coords="604,169,689,196"/>
<area shape="rect" href="app-layer-parser_8h.html" title=" " alt="" coords="2015,393,2140,420"/>
<area shape="rect" href="app-layer-frames_8h.html" title=" " alt="" coords="2065,95,2196,121"/>
<area shape="rect" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine." alt="" coords="2220,95,2364,121"/>
<area shape="rect" href="util-profiling_8h.html" title=" " alt="" coords="2388,95,2487,121"/>
<area shape="rect" href="util-validate_8h.html" title=" " alt="" coords="2511,95,2609,121"/>
<area shape="rect" href="tests_2stream-tcp-reassemble_8c.html" title=" " alt="" coords="911,95,1110,121"/>
<area shape="rect" title=" " alt="" coords="842,468,907,495"/>
<area shape="rect" title=" " alt="" coords="931,468,1010,495"/>
<area shape="rect" title=" " alt="" coords="1034,468,1099,495"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="817,692,919,719"/>
<area shape="rect" title=" " alt="" coords="1175,468,1249,495"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="401,468,551,495"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="941,543,1019,569"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="1324,468,1407,495"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="1586,468,1726,495"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="1431,468,1510,495"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="739,468,818,495"/>
<area shape="rect" href="detect-engine-proto_8h.html" title=" " alt="" coords="1373,617,1517,644"/>
<area shape="rect" href="detect-reference_8h.html" title=" " alt="" coords="1542,617,1669,644"/>
<area shape="rect" href="detect-metadata_8h.html" title=" " alt="" coords="1693,617,1819,644"/>
<area shape="rect" href="runmodes_8h.html" title=" " alt="" coords="1143,393,1233,420"/>
</map>
</div>
</div>
<p><a href="stream-tcp-reassemble_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6d42655f2e74046204602fc94fcb7a40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a6d42655f2e74046204602fc94fcb7a40">STREAMTCP_STREAM_FLAG_FLUSH_FLAGS</a></td></tr>
<tr class="separator:a6d42655f2e74046204602fc94fcb7a40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a6b38282497b5a13be2476ec12bffd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a03a6b38282497b5a13be2476ec12bffd">SET_ISN</a>(stream,  setseq)</td></tr>
<tr class="separator:a03a6b38282497b5a13be2476ec12bffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb701b825f138d34e863080701371aa0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#afb701b825f138d34e863080701371aa0">MISSED_START</a>(isn)</td></tr>
<tr class="separator:afb701b825f138d34e863080701371aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8587f808bf8849065793984b81046df5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a8587f808bf8849065793984b81046df5">MISSED_END</a></td></tr>
<tr class="separator:a8587f808bf8849065793984b81046df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3236de51324666d6aa0bb50ab3fcb8cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a3236de51324666d6aa0bb50ab3fcb8cb">MISSED_STEP</a>(<a class="el" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>,  seg,  seglen,  buf,  buflen)</td></tr>
<tr class="separator:a3236de51324666d6aa0bb50ab3fcb8cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a879a0399b47b9ecf4f72c0fdc3d30949"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a879a0399b47b9ecf4f72c0fdc3d30949">SC_ATOMIC_DECLARE</a> (uint64_t, ra_memuse)</td></tr>
<tr class="separator:a879a0399b47b9ecf4f72c0fdc3d30949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73328239ccee3f1597b9085df75faf2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aa73328239ccee3f1597b9085df75faf2">IsTcpSessionDumpingEnabled</a> (void)</td></tr>
<tr class="separator:aa73328239ccee3f1597b9085df75faf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35abd3b4853e4137e6c2d9739df2484f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a35abd3b4853e4137e6c2d9739df2484f">EnableTcpSessionDumping</a> (void)</td></tr>
<tr class="separator:a35abd3b4853e4137e6c2d9739df2484f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a58f1dc1eea7d2a17c2be618efe8cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTcpSegment.html">TcpSegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a97a58f1dc1eea7d2a17c2be618efe8cf">StreamTcpGetSegment</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx)</td></tr>
<tr class="memdesc:a97a58f1dc1eea7d2a17c2be618efe8cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a segment from the pool  <a href="stream-tcp-reassemble_8c.html#a97a58f1dc1eea7d2a17c2be618efe8cf">More...</a><br /></td></tr>
<tr class="separator:a97a58f1dc1eea7d2a17c2be618efe8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebcd5ac2135cd8053669a41272fe4b3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aebcd5ac2135cd8053669a41272fe4b3a">StreamTcpCreateTestPacket</a> (uint8_t *payload, uint8_t value, uint8_t <a class="el" href="stream-tcp-private_8h.html#a275f869dbba91f4716540a49b6c22532">payload_len</a>, uint8_t <a class="el" href="util-streaming-buffer_8h.html#a96bbf959016e4411c9e6b9812a8be60a">len</a>)</td></tr>
<tr class="memdesc:aebcd5ac2135cd8053669a41272fe4b3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function to create the packet with given payload, which is used to test the reassembly of the engine.  <a href="stream-tcp-reassemble_8c.html#aebcd5ac2135cd8053669a41272fe4b3a">More...</a><br /></td></tr>
<tr class="separator:aebcd5ac2135cd8053669a41272fe4b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa4f290ce0908537a1c3c879fec24dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a7fa4f290ce0908537a1c3c879fec24dd">StreamTcpReassembleInitMemuse</a> (void)</td></tr>
<tr class="separator:a7fa4f290ce0908537a1c3c879fec24dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0450f1665ff06a11cb08777c78eba9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b">StreamTcpReassembleIncrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:ae0450f1665ff06a11cb08777c78eba9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Increment the memory usage counter for the TCP reassembly segments.  <a href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b">More...</a><br /></td></tr>
<tr class="separator:ae0450f1665ff06a11cb08777c78eba9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1117512e3b998a56f41b4457da37c416"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416">StreamTcpReassembleDecrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:a1117512e3b998a56f41b4457da37c416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Decrease the memory usage counter for the TCP reassembly segments.  <a href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416">More...</a><br /></td></tr>
<tr class="separator:a1117512e3b998a56f41b4457da37c416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f">StreamTcpReassembleMemuseGlobalCounter</a> (void)</td></tr>
<tr class="separator:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b00d2144fbbf62514e68ba316903c62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a1b00d2144fbbf62514e68ba316903c62">StreamTcpReassembleCheckMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:a1b00d2144fbbf62514e68ba316903c62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP segments.  <a href="stream-tcp-reassemble_8c.html#a1b00d2144fbbf62514e68ba316903c62">More...</a><br /></td></tr>
<tr class="separator:a1b00d2144fbbf62514e68ba316903c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad7eea57c7056aa4bba068cf731d3d4a8">StreamTcpReassembleSetMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update memcap value.  <a href="stream-tcp-reassemble_8c.html#ad7eea57c7056aa4bba068cf731d3d4a8">More...</a><br /></td></tr>
<tr class="separator:ad7eea57c7056aa4bba068cf731d3d4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9a6d0fc7f36fd6440797bad7b303d4"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#abb9a6d0fc7f36fd6440797bad7b303d4">StreamTcpReassembleGetMemcap</a> ()</td></tr>
<tr class="memdesc:abb9a6d0fc7f36fd6440797bad7b303d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return memcap value.  <a href="stream-tcp-reassemble_8c.html#abb9a6d0fc7f36fd6440797bad7b303d4">More...</a><br /></td></tr>
<tr class="separator:abb9a6d0fc7f36fd6440797bad7b303d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a771b5f3f7ef9d74f05f4ce19b0a75b27"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27">StreamTcpReassembleRealloc</a> (void *optr, size_t orig_size, size_t size)</td></tr>
<tr class="separator:a771b5f3f7ef9d74f05f4ce19b0a75b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00">StreamTcpSegmentReturntoPool</a> (<a class="el" href="structTcpSegment.html">TcpSegment</a> *seg)</td></tr>
<tr class="memdesc:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the segment back to the pool.  <a href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00">More...</a><br /></td></tr>
<tr class="separator:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9e5351fc6f108c2c429436b49c8ace3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3">StreamTcpReturnStreamSegments</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="memdesc:ad9e5351fc6f108c2c429436b49c8ace3"><td class="mdescLeft">&#160;</td><td class="mdescRight">return all segments in this stream into the pool(s)  <a href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3">More...</a><br /></td></tr>
<tr class="separator:ad9e5351fc6f108c2c429436b49c8ace3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d180ff3e4e89f4afa3ea223588c8d5f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a6d180ff3e4e89f4afa3ea223588c8d5f">StreamTcpGetAcked</a> (const <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="separator:a6d180ff3e4e89f4afa3ea223588c8d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63df10c51382b7b37880fc72063e79ad"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a63df10c51382b7b37880fc72063e79ad">StreamTcpGetUsable</a> (const <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, const bool eof)</td></tr>
<tr class="separator:a63df10c51382b7b37880fc72063e79ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419339627115993b6ef9f55ebbd4365c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c">StreamTcpDisableAppLayer</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:a419339627115993b6ef9f55ebbd4365c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34cbaa81da49c7656535cebbca45ff1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad34cbaa81da49c7656535cebbca45ff1">StreamTcpAppLayerIsDisabled</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:ad34cbaa81da49c7656535cebbca45ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ddeaa2bb0f397d541844c4a5ac521a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aa6ddeaa2bb0f397d541844c4a5ac521a">StreamTcpReassembleInit</a> (bool quiet)</td></tr>
<tr class="separator:aa6ddeaa2bb0f397d541844c4a5ac521a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ae76565bf66071c8a1eb482bd0e3fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ae8ae76565bf66071c8a1eb482bd0e3fa">StreamTcpReassembleFree</a> (bool quiet)</td></tr>
<tr class="separator:ae8ae76565bf66071c8a1eb482bd0e3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53c19d8ac0e70cfa806afefc24b273c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad53c19d8ac0e70cfa806afefc24b273c">StreamTcpReassembleInitThreadCtx</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>)</td></tr>
<tr class="separator:ad53c19d8ac0e70cfa806afefc24b273c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a967e5a8d394fdac2878d63f01b9c87cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc">StreamTcpReassembleFreeThreadCtx</a> (<a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx)</td></tr>
<tr class="separator:a967e5a8d394fdac2878d63f01b9c87cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de7491805a4a77ffda933d5fbf566e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a3de7491805a4a77ffda933d5fbf566e4">StreamTcpReassembleDepthReached</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a3de7491805a4a77ffda933d5fbf566e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if stream in pkt direction has depth reached  <a href="stream-tcp-reassemble_8c.html#a3de7491805a4a77ffda933d5fbf566e4">More...</a><br /></td></tr>
<tr class="separator:a3de7491805a4a77ffda933d5fbf566e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8100dabd6d650899e0e52f84d72e13f"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ac8100dabd6d650899e0e52f84d72e13f">StreamDataAvailableForProtoDetect</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="separator:ac8100dabd6d650899e0e52f84d72e13f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f">StreamTcpReassembleHandleSegmentHandleData</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a packets TCP data into the stream reassembly engine.  <a href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f">More...</a><br /></td></tr>
<tr class="separator:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7b68229fb340e8623c137c9bde39064"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#af7b68229fb340e8623c137c9bde39064">StreamNeedsReassembly</a> (const <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, uint8_t direction)</td></tr>
<tr class="memdesc:af7b68229fb340e8623c137c9bde39064"><td class="mdescLeft">&#160;</td><td class="mdescRight">see what if any work the TCP session still needs  <a href="stream-tcp-reassemble_8c.html#af7b68229fb340e8623c137c9bde39064">More...</a><br /></td></tr>
<tr class="separator:af7b68229fb340e8623c137c9bde39064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fdc683cf890121b3aecc81bedc0bd8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a89fdc683cf890121b3aecc81bedc0bd8">StreamTcpReassembleAppLayer</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, enum <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a> dir)</td></tr>
<tr class="memdesc:a89fdc683cf890121b3aecc81bedc0bd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the stream reassembly upon receiving a packet.  <a href="stream-tcp-reassemble_8c.html#a89fdc683cf890121b3aecc81bedc0bd8">More...</a><br /></td></tr>
<tr class="separator:a89fdc683cf890121b3aecc81bedc0bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244d3a5e334392fa0091554609e55f71"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a244d3a5e334392fa0091554609e55f71">StreamReassembleRawHasDataReady</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a244d3a5e334392fa0091554609e55f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">does the stream engine have data to inspect?  <a href="stream-tcp-reassemble_8c.html#a244d3a5e334392fa0091554609e55f71">More...</a><br /></td></tr>
<tr class="separator:a244d3a5e334392fa0091554609e55f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fe43e2f76699eaceceffa72df0bd82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a12fe43e2f76699eaceceffa72df0bd82">StreamReassembleRawUpdateProgress</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, uint64_t progress)</td></tr>
<tr class="memdesc:a12fe43e2f76699eaceceffa72df0bd82"><td class="mdescLeft">&#160;</td><td class="mdescRight">update stream engine after detection  <a href="stream-tcp-reassemble_8c.html#a12fe43e2f76699eaceceffa72df0bd82">More...</a><br /></td></tr>
<tr class="separator:a12fe43e2f76699eaceceffa72df0bd82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9b7e4b8c7d793be7c8881fce794186"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#afe9b7e4b8c7d793be7c8881fce794186">StreamReassembleForFrame</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a> Callback, void *cb_data, const uint64_t <a class="el" href="util-streaming-buffer_8h.html#a612bb2807d848cca89ea1437cceea886">offset</a>, const bool eof)</td></tr>
<tr class="separator:afe9b7e4b8c7d793be7c8881fce794186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c38730e71715b22a87ee3c4a69ebbd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a31c38730e71715b22a87ee3c4a69ebbd">StreamReassembleRaw</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a> Callback, void *cb_data, uint64_t *progress_out, bool respect_inspect_depth)</td></tr>
<tr class="separator:a31c38730e71715b22a87ee3c4a69ebbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca3cbb43504b38e4cd31c4a543444a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aaca3cbb43504b38e4cd31c4a543444a7">StreamReassembleLog</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a> Callback, void *cb_data, uint64_t progress_in, uint64_t *progress_out, bool eof)</td></tr>
<tr class="separator:aaca3cbb43504b38e4cd31c4a543444a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a246e7261bcaaaf2d566533851838a32f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a246e7261bcaaaf2d566533851838a32f">StreamTcpReassembleHandleSegment</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *pq)</td></tr>
<tr class="separator:a246e7261bcaaaf2d566533851838a32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b6242829c9bcb2427947efa52ef80c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a39b6242829c9bcb2427947efa52ef80c">StreamTcpReassembleTriggerRawReassembly</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, int direction)</td></tr>
<tr class="memdesc:a39b6242829c9bcb2427947efa52ef80c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger RAW stream reassembly.  <a href="stream-tcp-reassemble_8c.html#a39b6242829c9bcb2427947efa52ef80c">More...</a><br /></td></tr>
<tr class="separator:a39b6242829c9bcb2427947efa52ef80c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cca677b3f6c60ab903b3246bcd5129f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a6cca677b3f6c60ab903b3246bcd5129f">StreamTcpReassemblySetMinInspectDepth</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, int direction, uint32_t depth)</td></tr>
<tr class="separator:a6cca677b3f6c60ab903b3246bcd5129f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcadd2509d3a2b16c9a1d04a52596a46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#abcadd2509d3a2b16c9a1d04a52596a46">StreamTcpCheckStreamContents</a> (uint8_t *stream_policy, uint16_t sp_size, <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="memdesc:abcadd2509d3a2b16c9a1d04a52596a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function Checks the reassembled stream contents against predefined stream contents according to OS policy used.  <a href="stream-tcp-reassemble_8c.html#abcadd2509d3a2b16c9a1d04a52596a46">More...</a><br /></td></tr>
<tr class="separator:abcadd2509d3a2b16c9a1d04a52596a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4894f48885e4926013c260b03f68685f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f">StreamTcpReassembleRegisterTests</a> (void)</td></tr>
<tr class="memdesc:a4894f48885e4926013c260b03f68685f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function Register the Unit tests to test the reassembly engine for various OS policies.  <a href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f">More...</a><br /></td></tr>
<tr class="separator:a4894f48885e4926013c260b03f68685f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a819fe1b32fe9d7dec8649ef7af7582d9"><td class="memItemLeft" align="right" valign="top">thread_local uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a819fe1b32fe9d7dec8649ef7af7582d9">t_pcapcnt</a> = UINT64_MAX</td></tr>
<tr class="separator:a819fe1b32fe9d7dec8649ef7af7582d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span class="obfuscator">.nosp@m.</span>nder<span class="obfuscator">.nosp@m.</span>singh<span class="obfuscator">.nosp@m.</span>dahi<span class="obfuscator">.nosp@m.</span>ya@gm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a> </dd>
<dd>
Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a></dd></dl>
<p>Reference: Judy Novak, Steve Sturges: Target-Based TCP Stream Reassembly August, 2007 </p>

<p class="definition">Definition in file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8587f808bf8849065793984b81046df5" name="a8587f808bf8849065793984b81046df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8587f808bf8849065793984b81046df5">&#9670;&nbsp;</a></span>MISSED_END</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MISSED_END</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9">StreamTcpUTClearSession</a>(&amp;ssn);              \</div>
<div class="line">    StreamTcpUTDeinit(ra_ctx);                  \</div>
<div class="line">    PASS</div>
<div class="ttc" id="astream-tcp-util_8c_html_a5bef4b33daf7e346128f449273fadda9"><div class="ttname"><a href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9">StreamTcpUTClearSession</a></div><div class="ttdeci">void StreamTcpUTClearSession(TcpSession *ssn)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-util_8c_source.html#l00071">stream-tcp-util.c:71</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02168">2168</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="afb701b825f138d34e863080701371aa0" name="afb701b825f138d34e863080701371aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb701b825f138d34e863080701371aa0">&#9670;&nbsp;</a></span>MISSED_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MISSED_START</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">isn</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_struct" href="structTcpReassemblyThreadCtx__.html">TcpReassemblyThreadCtx</a> *ra_ctx = NULL;      \</div>
<div class="line">    TcpSession ssn;                             \</div>
<div class="line">    ThreadVars <a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a>;                              \</div>
<div class="line">    memset(&amp;<a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a>));                 <a class="code hl_function" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4">\</a></div>
<div class="line"><a class="code hl_function" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4">                                                \</a></div>
<div class="line"><a class="code hl_function" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4">    StreamTcpUTInit</a>(&amp;ra_ctx);                   <a class="code hl_function" href="stream-tcp-util_8c.html#a2b9e9875517c1a624e9772a771b18fa8">\</a></div>
<div class="line"><a class="code hl_function" href="stream-tcp-util_8c.html#a2b9e9875517c1a624e9772a771b18fa8">                                                \</a></div>
<div class="line"><a class="code hl_function" href="stream-tcp-util_8c.html#a2b9e9875517c1a624e9772a771b18fa8">    StreamTcpUTSetupSession</a>(&amp;ssn);              \</div>
<div class="line">    StreamTcpUTSetupStream(&amp;ssn.server, (isn)); \</div>
<div class="line">    StreamTcpUTSetupStream(&amp;ssn.client, (isn)); \</div>
<div class="line">                                                \</div>
<div class="line">    TcpStream *stream = &amp;ssn.client;</div>
<div class="ttc" id="afuzz__decodepcapfile_8c_html_ab586e04d20a83310f10b8ca067fdc60c"><div class="ttname"><a href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a></div><div class="ttdeci">ThreadVars * tv</div><div class="ttdef"><b>Definition:</b> <a href="fuzz__decodepcapfile_8c_source.html#l00031">fuzz_decodepcapfile.c:31</a></div></div>
<div class="ttc" id="astream-tcp-util_8c_html_a2b9e9875517c1a624e9772a771b18fa8"><div class="ttname"><a href="stream-tcp-util_8c.html#a2b9e9875517c1a624e9772a771b18fa8">StreamTcpUTSetupSession</a></div><div class="ttdeci">void StreamTcpUTSetupSession(TcpSession *ssn)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-util_8c_source.html#l00062">stream-tcp-util.c:62</a></div></div>
<div class="ttc" id="astream-tcp-util_8c_html_ac334d8068855916fb7ceaf9fa01247a4"><div class="ttname"><a href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4">StreamTcpUTInit</a></div><div class="ttdeci">void StreamTcpUTInit(TcpReassemblyThreadCtx **ra_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-util_8c_source.html#l00044">stream-tcp-util.c:44</a></div></div>
<div class="ttc" id="astructTcpReassemblyThreadCtx___html"><div class="ttname"><a href="structTcpReassemblyThreadCtx__.html">TcpReassemblyThreadCtx_</a></div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-reassemble_8h_source.html#l00062">stream-tcp-reassemble.h:62</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02154">2154</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a3236de51324666d6aa0bb50ab3fcb8cb" name="a3236de51324666d6aa0bb50ab3fcb8cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3236de51324666d6aa0bb50ab3fcb8cb">&#9670;&nbsp;</a></span>MISSED_STEP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MISSED_STEP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">seg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">seglen, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buflen&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924">StreamTcpUTAddPayload</a>(&amp;<a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a>, ra_ctx, &amp;ssn, stream, (<a class="code hl_variable" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>), (uint8_t *)(seg), (seglen));    \</div>
<div class="line">    FAIL_IF(!(<a class="code hl_define" href="detect-content_8c.html#ac2c334584113fd306af1074f72ce008b">VALIDATE</a>(stream, (uint8_t *)(buf), (buflen))));</div>
<div class="ttc" id="adetect-content_8c_html_ac2c334584113fd306af1074f72ce008b"><div class="ttname"><a href="detect-content_8c.html#ac2c334584113fd306af1074f72ce008b">VALIDATE</a></div><div class="ttdeci">#define VALIDATE(e)</div></div>
<div class="ttc" id="astream-tcp-private_8h_html_aaf1b939170b82732448a965a5b33ad4e"><div class="ttname"><a href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a></div><div class="ttdeci">uint32_t seq</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00002">stream-tcp-private.h:2</a></div></div>
<div class="ttc" id="astream-tcp-util_8c_html_aed28f8b80426b663c024011be4356924"><div class="ttname"><a href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924">StreamTcpUTAddPayload</a></div><div class="ttdeci">int StreamTcpUTAddPayload(ThreadVars *tv, TcpReassemblyThreadCtx *ra_ctx, TcpSession *ssn, TcpStream *stream, uint32_t seq, uint8_t *payload, uint16_t len)</div><div class="ttdoc">wrapper for StreamTcpReassembleHandleSegmentHandleData</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-util_8c_source.html#l00097">stream-tcp-util.c:97</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02173">2173</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a03a6b38282497b5a13be2476ec12bffd" name="a03a6b38282497b5a13be2476ec12bffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a6b38282497b5a13be2476ec12bffd">&#9670;&nbsp;</a></span>SET_ISN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_ISN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">setseq&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    (stream)-&gt;isn = (setseq);               \</div>
<div class="line">    (stream)-&gt;base_seq = (setseq) + 1</div>
</div><!-- fragment --><p >unit tests and it's support functions below </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02101">2101</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a6d42655f2e74046204602fc94fcb7a40" name="a6d42655f2e74046204602fc94fcb7a40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d42655f2e74046204602fc94fcb7a40">&#9670;&nbsp;</a></span>STREAMTCP_STREAM_FLAG_FLUSH_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_STREAM_FLAG_FLUSH_FLAGS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        (   <a class="code hl_define" href="stream-tcp-private_8h.html#af8f0e8d628999596c6d563b9f23ea0f9">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a> \</div>
<div class="line">        |   <a class="code hl_define" href="stream-tcp-private_8h.html#a563a4f91134d3a7414a7634425f27a50">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a>   \</div>
<div class="line">        |   <a class="code hl_define" href="stream-tcp-private_8h.html#ab6d2f5e9091b690a26de77955123a470">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>)</div>
<div class="ttc" id="astream-tcp-private_8h_html_a563a4f91134d3a7414a7634425f27a50"><div class="ttname"><a href="stream-tcp-private_8h.html#a563a4f91134d3a7414a7634425f27a50">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a></div><div class="ttdeci">#define STREAMTCP_STREAM_FLAG_TRIGGER_RAW</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00217">stream-tcp-private.h:217</a></div></div>
<div class="ttc" id="astream-tcp-private_8h_html_ab6d2f5e9091b690a26de77955123a470"><div class="ttname"><a href="stream-tcp-private_8h.html#ab6d2f5e9091b690a26de77955123a470">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a></div><div class="ttdeci">#define STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00228">stream-tcp-private.h:228</a></div></div>
<div class="ttc" id="astream-tcp-private_8h_html_af8f0e8d628999596c6d563b9f23ea0f9"><div class="ttname"><a href="stream-tcp-private_8h.html#af8f0e8d628999596c6d563b9f23ea0f9">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a></div><div class="ttdeci">#define STREAMTCP_STREAM_FLAG_DEPTH_REACHED</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00215">stream-tcp-private.h:215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a35abd3b4853e4137e6c2d9739df2484f" name="a35abd3b4853e4137e6c2d9739df2484f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35abd3b4853e4137e6c2d9739df2484f">&#9670;&nbsp;</a></span>EnableTcpSessionDumping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnableTcpSessionDumping </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00093">93</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="aa73328239ccee3f1597b9085df75faf2" name="aa73328239ccee3f1597b9085df75faf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73328239ccee3f1597b9085df75faf2">&#9670;&nbsp;</a></span>IsTcpSessionDumpingEnabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool IsTcpSessionDumpingEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00088">88</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a879a0399b47b9ecf4f72c0fdc3d30949" name="a879a0399b47b9ecf4f72c0fdc3d30949"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879a0399b47b9ecf4f72c0fdc3d30949">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ra_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac8100dabd6d650899e0e52f84d72e13f" name="ac8100dabd6d650899e0e52f84d72e13f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8100dabd6d650899e0e52f84d72e13f">&#9670;&nbsp;</a></span>StreamDataAvailableForProtoDetect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t StreamDataAvailableForProtoDetect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00680">680</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00102">StreamingBuffer_::head</a>, <a class="el" href="tree_8h_source.html#l00327">RB_EMPTY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00103">StreamingBuffer_::sbb_size</a>, <a class="el" href="util-streaming-buffer_8h_source.html#l00101">StreamingBuffer_::sbb_tree</a>, and <a class="el" href="util-streaming-buffer_8h_source.html#l00095">StreamingBuffer_::stream_offset</a>.</p>

</div>
</div>
<a id="af7b68229fb340e8623c137c9bde39064" name="af7b68229fb340e8623c137c9bde39064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7b68229fb340e8623c137c9bde39064">&#9670;&nbsp;</a></span>StreamNeedsReassembly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t StreamNeedsReassembly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>see what if any work the TCP session still needs </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00878">878</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00144">STREAM_APP_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00143">STREAM_BASE_OFFSET</a>, <a class="el" href="stream-tcp_8h_source.html#l00185">STREAM_HAS_UNPROCESSED_SEGMENTS_NEED_ONLY_DETECTION</a>, <a class="el" href="stream-tcp_8h_source.html#l00182">STREAM_HAS_UNPROCESSED_SEGMENTS_NONE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00145">STREAM_RAW_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00230">STREAMTCP_STREAM_FLAG_DISABLE_RAW</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-timeout_8c_source.html#l00296">FlowForceReassemblyNeedReassembly()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_af7b68229fb340e8623c137c9bde39064_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_af7b68229fb340e8623c137c9bde39064_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_af7b68229fb340e8623c137c9bde39064_icgraph" id="astream-tcp-reassemble_8c_af7b68229fb340e8623c137c9bde39064_icgraph">
<area shape="rect" title="see what if any work the TCP session still needs" alt="" coords="313,5,488,32"/>
<area shape="rect" href="flow-timeout_8c.html#a75b170f1af2fed84c039969318b5edb9" title="Check if a flow needs forced reassembly, or any other processing." alt="" coords="5,5,265,32"/>
</map>
</div>

</div>
</div>
<a id="afe9b7e4b8c7d793be7c8881fce794186" name="afe9b7e4b8c7d793be7c8881fce794186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9b7e4b8c7d793be7c8881fce794186">&#9670;&nbsp;</a></span>StreamReassembleForFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamReassembleForFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a>&#160;</td>
          <td class="paramname"><em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>eof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01812">1812</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00144">STREAM_APP_PROGRESS</a>.</p>

</div>
</div>
<a id="aaca3cbb43504b38e4cd31c4a543444a7" name="aaca3cbb43504b38e4cd31c4a543444a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaca3cbb43504b38e4cd31c4a543444a7">&#9670;&nbsp;</a></span>StreamReassembleLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamReassembleLog </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a>&#160;</td>
          <td class="paramname"><em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>progress_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>progress_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>eof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01889">1889</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>.</p>

</div>
</div>
<a id="a31c38730e71715b22a87ee3c4a69ebbd" name="a31c38730e71715b22a87ee3c4a69ebbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c38730e71715b22a87ee3c4a69ebbd">&#9670;&nbsp;</a></span>StreamReassembleRaw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamReassembleRaw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#aaf79b3a5d0cda7b6d48fabad0958e753">StreamReassembleRawFunc</a>&#160;</td>
          <td class="paramname"><em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>progress_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>respect_inspect_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01824">1824</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>, and <a class="el" href="suricata-common_8h_source.html#l00033">TRUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="detect-engine-payload_8c_source.html#l00266">DetectEngineInspectStreamPayload()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_cgraph" id="astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,169,32"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="217,5,364,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_icgraph" id="astream-tcp-reassemble_8c_a31c38730e71715b22a87ee3c4a69ebbd_icgraph">
<area shape="rect" title=" " alt="" coords="240,13,404,39"/>
<area shape="rect" href="detect-engine-payload_8c.html#a0d743a50ec5612e0a9f97203da39b707" title="Do the content inspection &amp; validation for a signature on the raw stream." alt="" coords="5,5,192,47"/>
</map>
</div>

</div>
</div>
<a id="a244d3a5e334392fa0091554609e55f71" name="a244d3a5e334392fa0091554609e55f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a244d3a5e334392fa0091554609e55f71">&#9670;&nbsp;</a></span>StreamReassembleRawHasDataReady()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool StreamReassembleRawHasDataReady </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>does the stream engine have data to inspect? </p>
<p >Returns true if there is data to inspect. In IDS case this is about ACK'd data in the packet's direction.</p>
<p >In the IPS case this is about the packet itself. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01414">1414</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="tree_8h_source.html#l00327">RB_EMPTY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00143">STREAM_BASE_OFFSET</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00145">STREAM_RAW_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00230">STREAMTCP_STREAM_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, and <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a244d3a5e334392fa0091554609e55f71_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a244d3a5e334392fa0091554609e55f71_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a244d3a5e334392fa0091554609e55f71_cgraph" id="astream-tcp-reassemble_8c_a244d3a5e334392fa0091554609e55f71_cgraph">
<area shape="rect" title="does the stream engine have data to inspect?" alt="" coords="5,5,221,47"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="269,13,416,39"/>
</map>
</div>

</div>
</div>
<a id="a12fe43e2f76699eaceceffa72df0bd82" name="a12fe43e2f76699eaceceffa72df0bd82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12fe43e2f76699eaceceffa72df0bd82">&#9670;&nbsp;</a></span>StreamReassembleRawUpdateProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamReassembleRawUpdateProgress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update stream engine after detection </p>
<p >Tasked with progressing the 'progress' for Raw reassembly. 2 main scenario's:</p><ol type="1">
<li>progress is != 0, so we use this</li>
<li>progress is 0, meaning the detect engine didn't touch raw at all. In this case we need to look into progressing raw anyway.</li>
</ol>
<p >Additionally, this function is tasked with disabling raw reassembly if the app-layer requested to disable it. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01458">1458</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00595">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00127">TcpStream_::raw_progress_rel</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00144">STREAM_APP_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00143">STREAM_BASE_OFFSET</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00145">STREAM_RAW_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00230">STREAMTCP_STREAM_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00217">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00117">TcpStream_::window</a>.</p>

</div>
</div>
<a id="ad34cbaa81da49c7656535cebbca45ff1" name="ad34cbaa81da49c7656535cebbca45ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34cbaa81da49c7656535cebbca45ff1">&#9670;&nbsp;</a></span>StreamTcpAppLayerIsDisabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpAppLayerIsDisabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00446">446</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>.</p>

</div>
</div>
<a id="abcadd2509d3a2b16c9a1d04a52596a46" name="abcadd2509d3a2b16c9a1d04a52596a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcadd2509d3a2b16c9a1d04a52596a46">&#9670;&nbsp;</a></span>StreamTcpCheckStreamContents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpCheckStreamContents </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>stream_policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sp_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function Checks the reassembled stream contents against predefined stream contents according to OS policy used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream_policy</td><td>Predefined value of stream for different OS policies </td></tr>
    <tr><td class="paramname">stream</td><td>Reassembled stream returned from the reassembly functions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02132">2132</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, and <a class="el" href="util-streaming-buffer_8c_source.html#l00870">StreamingBufferCompareRawData()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_abcadd2509d3a2b16c9a1d04a52596a46_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_abcadd2509d3a2b16c9a1d04a52596a46_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_abcadd2509d3a2b16c9a1d04a52596a46_cgraph" id="astream-tcp-reassemble_8c_abcadd2509d3a2b16c9a1d04a52596a46_cgraph">
<area shape="rect" title="The Function Checks the reassembled stream contents against predefined stream contents according to O..." alt="" coords="5,31,223,57"/>
<area shape="rect" href="util-streaming-buffer_8c.html#a752f9a408bd7ee8cac07d3772d81cf07" title=" " alt="" coords="271,31,495,57"/>
<area shape="rect" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title=" " alt="" coords="566,5,685,32"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af6d76eb5aead49d5f5b16d48aac130ef" title=" " alt="" coords="543,56,708,83"/>
</map>
</div>

</div>
</div>
<a id="aebcd5ac2135cd8053669a41272fe4b3a" name="aebcd5ac2135cd8053669a41272fe4b3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebcd5ac2135cd8053669a41272fe4b3a">&#9670;&nbsp;</a></span>StreamTcpCreateTestPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpCreateTestPacket </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function to create the packet with given payload, which is used to test the reassembly of the engine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">payload</td><td>The variable used to store the payload contents of the current packet. </td></tr>
    <tr><td class="paramname">value</td><td>The value which current payload will have for this packet </td></tr>
    <tr><td class="paramname">payload_len</td><td>The length of the filed payload for current packet. </td></tr>
    <tr><td class="paramname">len</td><td>Length of the payload array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02115">2115</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer-dnp3_8h_source.html#l00002">len</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00001">payload_len</a>.</p>

</div>
</div>
<a id="a419339627115993b6ef9f55ebbd4365c" name="a419339627115993b6ef9f55ebbd4365c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419339627115993b6ef9f55ebbd4365c">&#9670;&nbsp;</a></span>StreamTcpDisableAppLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDisableAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00430">430</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00485">Flow_::alparser</a>, <a class="el" href="app-layer-parser_8h_source.html#l00040">APP_LAYER_PARSER_EOF_TC</a>, <a class="el" href="app-layer-parser_8h_source.html#l00039">APP_LAYER_PARSER_EOF_TS</a>, <a class="el" href="app-layer-parser_8c_source.html#l01718">AppLayerParserStateSetFlag()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00294">StreamTcpDisableAppLayerReassembly</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00288">StreamTcpSetStreamFlagAppProtoDetectionCompleted</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_cgraph" id="astream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,32"/>
<area shape="rect" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title=" " alt="" coords="236,5,427,32"/>
</map>
</div>

</div>
</div>
<a id="a6d180ff3e4e89f4afa3ea223588c8d5f" name="a6d180ff3e4e89f4afa3ea223588c8d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d180ff3e4e89f4afa3ea223588c8d5f">&#9670;&nbsp;</a></span>StreamTcpGetAcked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpGetAcked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00404">404</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a97a58f1dc1eea7d2a17c2be618efe8cf" name="a97a58f1dc1eea7d2a17c2be618efe8cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a58f1dc1eea7d2a17c2be618efe8cf">&#9670;&nbsp;</a></span>StreamTcpGetSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTcpSegment.html">TcpSegment</a> * StreamTcpGetSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a segment from the pool </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">seg</td><td>Segment from the pool or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02036">2036</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8c_source.html#l00168">PoolThreadGetById()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00136">StreamTcpUTAddSegmentWithByte()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00113">StreamTcpUTAddSegmentWithPayload()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_cgraph" id="astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_cgraph">
<area shape="rect" title="get a segment from the pool" alt="" coords="5,5,163,32"/>
<area shape="rect" href="group__utilpool.html#gabe3fd07a4b08ea4aa17e13b24ece9dbf" title="get data from thread pool by thread id" alt="" coords="211,5,347,32"/>
<area shape="rect" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9" title=" " alt="" coords="395,5,464,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_icgraph" id="astream-tcp-reassemble_8c_a97a58f1dc1eea7d2a17c2be618efe8cf_icgraph">
<area shape="rect" title="get a segment from the pool" alt="" coords="284,35,441,61"/>
<area shape="rect" href="stream-tcp-util_8c.html#a76e6bc7448ccad45a8955265ec14e40a" title=" " alt="" coords="5,5,236,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#aa95bbbdf447725bbfb4948657754d61f" title=" " alt="" coords="19,57,222,98"/>
</map>
</div>

</div>
</div>
<a id="a63df10c51382b7b37880fc72063e79ad" name="a63df10c51382b7b37880fc72063e79ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63df10c51382b7b37880fc72063e79ad">&#9670;&nbsp;</a></span>StreamTcpGetUsable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpGetUsable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>eof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00409">409</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-streaming-buffer_8h_source.html#l00099">StreamingBuffer_::buf_offset</a>, <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="suricata-common_8h_source.html#l00372">MIN</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00143">STREAM_BASE_OFFSET</a>, and <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>.</p>

<p class="reference">Referenced by <a class="el" href="output-json-frame_8c_source.html#l00217">FrameJsonLogOneFrame()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_cgraph" id="astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,32"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="200,5,347,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_icgraph" id="astream-tcp-reassemble_8c_a63df10c51382b7b37880fc72063e79ad_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,369,32"/>
<area shape="rect" href="output-json-frame_8c.html#a06235de1193e59f3af805d240ca6a7f8" title="log a single frame" alt="" coords="5,5,175,32"/>
</map>
</div>

</div>
</div>
<a id="a89fdc683cf890121b3aecc81bedc0bd8" name="a89fdc683cf890121b3aecc81bedc0bd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fdc683cf890121b3aecc81bedc0bd8">&#9670;&nbsp;</a></span>StreamTcpReassembleAppLayer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="stream-tcp-reassemble_8h.html#afa20e4335392804ebf882090830978c6">StreamUpdateDir</a>&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the stream reassembly upon receiving a packet. </p>
<p >For IDS mode, the stream is in the opposite direction of the packet, as the ACK-packet is ACK'ing the stream.</p>
<p >One of the utilities call by this function <a class="el" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app-layer.">AppLayerHandleTCPData()</a>, has a feature where it will call this very same function for the stream opposing the stream it is called with. This shouldn't cause any issues, since processing of each stream is independent of the other stream. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01301">1301</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer_8c_source.html#l00638">AppLayerHandleTCPData()</a>, <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="decode_8h_source.html#l01171">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="tree_8h_source.html#l00778">RB_MIN</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00273">TcpSession_::state</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00144">STREAM_APP_PROGRESS</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00104">STREAM_HAS_SEEN_DATA</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00102">STREAM_RIGHT_EDGE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00160">TCP_CLOSING</a>, and <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a89fdc683cf890121b3aecc81bedc0bd8_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a89fdc683cf890121b3aecc81bedc0bd8_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a89fdc683cf890121b3aecc81bedc0bd8_cgraph" id="astream-tcp-reassemble_8c_a89fdc683cf890121b3aecc81bedc0bd8_cgraph">
<area shape="rect" title="Update the stream reassembly upon receiving a packet." alt="" coords="5,107,217,133"/>
<area shape="rect" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app&#45;layer." alt="" coords="265,107,439,133"/>
<area shape="rect" href="app-layer-parser_8c.html#a7b0bc1a5a394504f629b6a9ab3ac33eb" title=" " alt="" coords="529,5,678,32"/>
<area shape="rect" href="util-exception-policy_8c.html#ac8f42e476206f6214c9704b16ec35155" title=" " alt="" coords="529,56,678,83"/>
<area shape="rect" href="flow_8c.html#acc4e426d680d8624300a2e3d8dfeffec" title="Check if change proto flag is set for flow." alt="" coords="540,107,667,133"/>
<area shape="rect" href="flow_8c.html#a71829515c7880d4089d0fb8422f2f912" title="Unset flag to indicate to change proto for the flow." alt="" coords="510,157,697,184"/>
<area shape="rect" href="stream-tcp_8c.html#afc4ebba3d55a0923ad8aee7f6a959bd0" title="update reassembly progress" alt="" coords="487,208,720,235"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="768,5,919,32"/>
<area shape="rect" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title=" " alt="" coords="780,56,907,83"/>
</map>
</div>

</div>
</div>
<a id="a1b00d2144fbbf62514e68ba316903c62" name="a1b00d2144fbbf62514e68ba316903c62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b00d2144fbbf62514e68ba316903c62">&#9670;&nbsp;</a></span>StreamTcpReassembleCheckMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">161</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-debug_8h_source.html#l00230">SCLogNotice</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00077">t_pcapcnt</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1b00d2144fbbf62514e68ba316903c62_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a1b00d2144fbbf62514e68ba316903c62_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a1b00d2144fbbf62514e68ba316903c62_icgraph" id="astream-tcp-reassemble_8c_a1b00d2144fbbf62514e68ba316903c62_icgraph">
<area shape="rect" title="Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP se..." alt="" coords="255,5,449,47"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,13,207,39"/>
</map>
</div>

</div>
</div>
<a id="a1117512e3b998a56f41b4457da37c416" name="a1117512e3b998a56f41b4457da37c416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1117512e3b998a56f41b4457da37c416">&#9670;&nbsp;</a></span>StreamTcpReassembleDecrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Decrease the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00126">126</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="suricata_8c_source.html#l00279">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00342">SC_ATOMIC_SUB</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">StreamTcpReassembleMemuseGlobalCounter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_cgraph" id="astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_cgraph">
<area shape="rect" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="5,35,240,61"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="320,5,463,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="288,57,495,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph" id="astream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph">
<area shape="rect" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="255,5,489,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="a3de7491805a4a77ffda933d5fbf566e4" name="a3de7491805a4a77ffda933d5fbf566e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3de7491805a4a77ffda933d5fbf566e4">&#9670;&nbsp;</a></span>StreamTcpReassembleDepthReached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleDepthReached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if stream in pkt direction has depth reached </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>packet with <em>LOCKED</em> flow</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>stream has depth reached </td></tr>
    <tr><td class="paramname">0</td><td>stream does not have depth reached </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00583">583</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00223">FLOW_PKT_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l00465">Packet_::flowflags</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00215">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>.</p>

</div>
</div>
<a id="ae8ae76565bf66071c8a1eb482bd0e3fa" name="ae8ae76565bf66071c8a1eb482bd0e3fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ae76565bf66071c8a1eb482bd0e3fa">&#9670;&nbsp;</a></span>StreamTcpReassembleFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFree </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">505</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00667">StreamTcpFreeConfig()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ae8ae76565bf66071c8a1eb482bd0e3fa_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ae8ae76565bf66071c8a1eb482bd0e3fa_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ae8ae76565bf66071c8a1eb482bd0e3fa_icgraph" id="astream-tcp-reassemble_8c_ae8ae76565bf66071c8a1eb482bd0e3fa_icgraph">
<area shape="rect" title=" " alt="" coords="385,5,568,32"/>
<area shape="rect" href="stream-tcp_8c.html#a6e1df383229e4ec307642c8770bf218a" title=" " alt="" coords="189,5,337,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#af08d2b5ca2d164e365b1fcd55cd3521a" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
<a id="a967e5a8d394fdac2878d63f01b9c87cc" name="a967e5a8d394fdac2878d63f01b9c87cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a967e5a8d394fdac2878d63f01b9c87cc">&#9670;&nbsp;</a></span>StreamTcpReassembleFreeThreadCtx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFreeThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00565">565</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00063">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l01004">AppLayerDestroyCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, and <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05455">StreamTcpThreadDeinit()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00051">StreamTcpUTDeinit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph" id="astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,249,98"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="297,71,481,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="529,42,732,69"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="534,93,727,135"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="780,5,989,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="785,71,985,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph" id="astream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph">
<area shape="rect" title=" " alt="" coords="212,31,456,57"/>
<area shape="rect" href="stream-tcp_8c.html#a108137f5e3fa9caa0aab96a14df9b1cc" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#af08d2b5ca2d164e365b1fcd55cd3521a" title=" " alt="" coords="17,56,153,83"/>
</map>
</div>

</div>
</div>
<a id="abb9a6d0fc7f36fd6440797bad7b303d4" name="abb9a6d0fc7f36fd6440797bad7b303d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9a6d0fc7f36fd6440797bad7b303d4">&#9670;&nbsp;</a></span>StreamTcpReassembleGetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleGetMemcap </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return memcap value. </p>
<dl class="section return"><dt>Returns</dt><dd>memcap memcap value </dd></dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00197">197</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a246e7261bcaaaf2d566533851838a32f" name="a246e7261bcaaaf2d566533851838a32f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a246e7261bcaaaf2d566533851838a32f">&#9670;&nbsp;</a></span>StreamTcpReassembleHandleSegment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01921">1921</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00108">FLOW_DIR_REVERSED</a>, <a class="el" href="decode_8h_source.html#l00575">Packet_::payload_len</a>, <a class="el" href="decode_8h_source.html#l01171">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00273">TcpSession_::state</a>, <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00161">TCP_CLOSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00157">TCP_TIME_WAIT</a>, <a class="el" href="decode_8h_source.html#l00554">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00038">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00034">TH_FIN</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_RST</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00059">UPDATE_DIR_BOTH</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00058">UPDATE_DIR_OPPOSING</a>, and <a class="el" href="stream-tcp-reassemble_8h_source.html#l00057">UPDATE_DIR_PACKET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a246e7261bcaaaf2d566533851838a32f_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a246e7261bcaaaf2d566533851838a32f_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a246e7261bcaaaf2d566533851838a32f_cgraph" id="astream-tcp-reassemble_8c_a246e7261bcaaaf2d566533851838a32f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,204,47"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="252,13,399,39"/>
</map>
</div>

</div>
</div>
<a id="a75ed0e6a51ad7ee4418623e1db12fc8f" name="a75ed0e6a51ad7ee4418623e1db12fc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ed0e6a51ad7ee4418623e1db12fc8f">&#9670;&nbsp;</a></span>StreamTcpReassembleHandleSegmentHandleData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegmentHandleData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a packets TCP data into the stream reassembly engine. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>good segment, as far as we checked. </td></tr>
    <tr><td class="paramname">-1</td><td>insert failure due to memcap</td></tr>
  </table>
  </dd>
</dl>
<p>If the retval is 0 the segment is inserted correctly, or overlap is handled, or it wasn't added because of reassembly depth. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00704">704</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00276">TcpSession_::data_first_seen_dir</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00110">TcpStream_::os_policy</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>, and <a class="el" href="stream-tcp_8c_source.html#l00773">StreamTcpSetOSPolicy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00097">StreamTcpUTAddPayload()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" id="astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph">
<area shape="rect" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="5,23,204,65"/>
<area shape="rect" href="stream-tcp_8c.html#a4bbabc99ab491dd9fa822fd5b3ade953" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="252,31,411,57"/>
<area shape="rect" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format." alt="" coords="459,5,669,32"/>
<area shape="rect" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format." alt="" coords="459,56,669,83"/>
<area shape="rect" href="util-radix-tree_8c.html#a3f0f2284278ce9b4b740e9c08d842652" title="Checks if an IPV4 address is present in the tree under a netblock." alt="" coords="717,5,932,32"/>
<area shape="rect" href="util-radix-tree_8c.html#a6cc3963f75cae4474ad3f63869860a98" title="Checks if an IPV6 address is present in the tree under a netblock." alt="" coords="717,56,932,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" id="astream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph">
<area shape="rect" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="224,5,423,47"/>
<area shape="rect" href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924" title="wrapper for StreamTcpReassembleHandleSegmentHandleData" alt="" coords="5,13,176,39"/>
</map>
</div>

</div>
</div>
<a id="ae0450f1665ff06a11cb08777c78eba9b" name="ae0450f1665ff06a11cb08777c78eba9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0450f1665ff06a11cb08777c78eba9b">&#9670;&nbsp;</a></span>StreamTcpReassembleIncrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Increment the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00113">113</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00333">SC_ATOMIC_ADD</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">StreamTcpReassembleMemuseGlobalCounter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">StreamTcpReassembleRealloc()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_cgraph" id="astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_cgraph">
<area shape="rect" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="5,13,235,39"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="283,5,489,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph" id="astream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph">
<area shape="rect" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="255,5,484,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,5,207,32"/>
</map>
</div>

</div>
</div>
<a id="aa6ddeaa2bb0f397d541844c4a5ac521a" name="aa6ddeaa2bb0f397d541844c4a5ac521a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6ddeaa2bb0f397d541844c4a5ac521a">&#9670;&nbsp;</a></span>StreamTcpReassembleInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleInit </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00489">489</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8c_source.html#l00102">StreamTcpReassembleInitMemuse()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aa6ddeaa2bb0f397d541844c4a5ac521a_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_aa6ddeaa2bb0f397d541844c4a5ac521a_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_aa6ddeaa2bb0f397d541844c4a5ac521a_cgraph" id="astream-tcp-reassemble_8c_aa6ddeaa2bb0f397d541844c4a5ac521a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a7fa4f290ce0908537a1c3c879fec24dd" title=" " alt="" coords="228,5,453,32"/>
</map>
</div>

</div>
</div>
<a id="a7fa4f290ce0908537a1c3c879fec24dd" name="a7fa4f290ce0908537a1c3c879fec24dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa4f290ce0908537a1c3c879fec24dd">&#9670;&nbsp;</a></span>StreamTcpReassembleInitMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleInitMemuse </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00102">102</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00315">SC_ATOMIC_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00489">StreamTcpReassembleInit()</a>, and <a class="el" href="util-unittest_8c_source.html#l00189">UtRunTests()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a7fa4f290ce0908537a1c3c879fec24dd_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a7fa4f290ce0908537a1c3c879fec24dd_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a7fa4f290ce0908537a1c3c879fec24dd_icgraph" id="astream-tcp-reassemble_8c_a7fa4f290ce0908537a1c3c879fec24dd_icgraph">
<area shape="rect" title=" " alt="" coords="228,31,453,57"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#aa6ddeaa2bb0f397d541844c4a5ac521a" title=" " alt="" coords="5,5,180,32"/>
<area shape="rect" href="group__Testing.html#ga961f4890d5ff5ef0e1b83e66b3255b6a" title="Run all registered unittests." alt="" coords="47,56,139,83"/>
</map>
</div>

</div>
</div>
<a id="ad53c19d8ac0e70cfa806afefc24b273c" name="ad53c19d8ac0e70cfa806afefc24b273c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53c19d8ac0e70cfa806afefc24b273c">&#9670;&nbsp;</a></span>StreamTcpReassembleInitThreadCtx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-reassemble_8h.html#a774d008ef52e7f248715dbb83bdb18aa">TcpReassemblyThreadCtx</a> * StreamTcpReassembleInitThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00524">524</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00063">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00982">AppLayerGetCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05389">StreamTcpThreadInit()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00044">StreamTcpUTInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_cgraph" id="astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_cgraph">
<area shape="rect" title=" " alt="" coords="5,130,241,157"/>
<area shape="rect" href="app-layer_8c.html#a0a0e638b06f49c80ad35efdf473f6556" title="Creates a new app layer thread context." alt="" coords="289,130,448,157"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="507,71,691,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a400a9d5e447fc436600350bdb157a64c" title="Gets a new app layer protocol&#39;s parser thread context." alt="" coords="496,130,701,157"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a56a48d357c05d7cfe483a1a213444664" title="Inits and returns an app layer protocol detection thread context." alt="" coords="504,181,693,223"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="749,13,952,39"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="754,64,947,105"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="1000,5,1209,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="1005,101,1205,127"/>
<area shape="rect" href="app-layer-parser_8c.html#a9f308874dc34fb891799d99c9beb7a84" title=" " alt="" coords="759,181,943,223"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_icgraph" id="astream-tcp-reassemble_8c_ad53c19d8ac0e70cfa806afefc24b273c_icgraph">
<area shape="rect" title=" " alt="" coords="196,31,432,57"/>
<area shape="rect" href="stream-tcp_8c.html#a0929f1a9b555b60d89e3ce16271f89b9" title=" " alt="" coords="5,5,148,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4" title=" " alt="" coords="17,56,137,83"/>
</map>
</div>

</div>
</div>
<a id="a477c59db3b1fef12cb9b1e5e5de0f59f" name="a477c59db3b1fef12cb9b1e5e5de0f59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477c59db3b1fef12cb9b1e5e5de0f59f">&#9670;&nbsp;</a></span>StreamTcpReassembleMemuseGlobalCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleMemuseGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">147</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00126">StreamTcpReassembleDecrMemuse()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00113">StreamTcpReassembleIncrMemuse()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" id="astream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph">
<area shape="rect" title=" " alt="" coords="537,23,744,65"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="255,5,489,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="257,56,487,83"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a771b5f3f7ef9d74f05f4ce19b0a75b27" title=" " alt="" coords="5,31,207,57"/>
</map>
</div>

</div>
</div>
<a id="a771b5f3f7ef9d74f05f4ce19b0a75b27" name="a771b5f3f7ef9d74f05f4ce19b0a75b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a771b5f3f7ef9d74f05f4ce19b0a75b27">&#9670;&nbsp;</a></span>StreamTcpReassembleRealloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * StreamTcpReassembleRealloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>optr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>orig_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00222">222</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-mem_8h_source.html#l00050">SCRealloc</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00126">StreamTcpReassembleDecrMemuse()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00113">StreamTcpReassembleIncrMemuse()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph" id="astream-tcp-reassemble_8c_a771b5f3f7ef9d74f05f4ce19b0a75b27_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,207,98"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a1b00d2144fbbf62514e68ba316903c62" title="Function to Check the reassembly memory usage counter against the allowed max memory usage for TCP se..." alt="" coords="275,5,469,47"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments." alt="" coords="255,71,489,98"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments." alt="" coords="257,122,487,149"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="569,63,712,90"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title=" " alt="" coords="537,115,744,156"/>
</map>
</div>

</div>
</div>
<a id="a4894f48885e4926013c260b03f68685f" name="a4894f48885e4926013c260b03f68685f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4894f48885e4926013c260b03f68685f">&#9670;&nbsp;</a></span>StreamTcpReassembleRegisterTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function Register the Unit tests to test the reassembly engine for various OS policies. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03755">3755</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-unittest_8c_source.html#l00103">UtRegisterTest()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph" id="astream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph">
<area shape="rect" title="The Function Register the Unit tests to test the reassembly engine for various OS policies." alt="" coords="5,5,212,47"/>
<area shape="rect" href="group__Testing.html#ga34617b41f44505d5c3938e4df12c264f" title="Register unit test." alt="" coords="260,13,371,39"/>
</map>
</div>

</div>
</div>
<a id="ad7eea57c7056aa4bba068cf731d3d4a8" name="ad7eea57c7056aa4bba068cf731d3d4a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7eea57c7056aa4bba068cf731d3d4a8">&#9670;&nbsp;</a></span>StreamTcpReassembleSetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleSetMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update memcap value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>new memcap value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00182">182</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a39b6242829c9bcb2427947efa52ef80c" name="a39b6242829c9bcb2427947efa52ef80c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b6242829c9bcb2427947efa52ef80c">&#9670;&nbsp;</a></span>StreamTcpReassembleTriggerRawReassembly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleTriggerRawReassembly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger RAW stream reassembly. </p>
<p >Used by AppLayerTriggerRawStreamReassembly to trigger RAW stream reassembly from the applayer, for example upon completion of a HTTP request.</p>
<p >It sets a flag in the stream so that the next Raw call will return the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TcpSession </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02064">2064</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00217">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer-parser_8c_source.html#l01499">AppLayerParserTriggerRawStreamReassembly()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a39b6242829c9bcb2427947efa52ef80c_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a39b6242829c9bcb2427947efa52ef80c_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a39b6242829c9bcb2427947efa52ef80c_icgraph" id="astream-tcp-reassemble_8c_a39b6242829c9bcb2427947efa52ef80c_icgraph">
<area shape="rect" title="Trigger RAW stream reassembly." alt="" coords="236,5,433,47"/>
<area shape="rect" href="app-layer-parser_8c.html#af660c95f302aa1c8f1737706c1714b5e" title=" " alt="" coords="5,5,188,47"/>
</map>
</div>

</div>
</div>
<a id="a6cca677b3f6c60ab903b3246bcd5129f" name="a6cca677b3f6c60ab903b3246bcd5129f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cca677b3f6c60ab903b3246bcd5129f">&#9670;&nbsp;</a></span>StreamTcpReassemblySetMinInspectDepth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassemblySetMinInspectDepth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02081">2081</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00130">TcpStream_::min_inspect_depth</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer-smtp_8c_source.html#l00479">SMTPProcessDataChunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a6cca677b3f6c60ab903b3246bcd5129f_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a6cca677b3f6c60ab903b3246bcd5129f_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a6cca677b3f6c60ab903b3246bcd5129f_icgraph" id="astream-tcp-reassemble_8c_a6cca677b3f6c60ab903b3246bcd5129f_icgraph">
<area shape="rect" title=" " alt="" coords="227,5,425,47"/>
<area shape="rect" href="app-layer-smtp_8c.html#aa8c9a12cd961cef05c8aad9e5a628eb1" title=" " alt="" coords="5,13,179,39"/>
</map>
</div>

</div>
</div>
<a id="ad9e5351fc6f108c2c429436b49c8ace3" name="ad9e5351fc6f108c2c429436b49c8ace3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9e5351fc6f108c2c429436b49c8ace3">&#9670;&nbsp;</a></span>StreamTcpReturnStreamSegments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReturnStreamSegments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return all segments in this stream into the pool(s) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>the stream to cleanup </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">385</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="tree_8h_source.html#l00791">RB_FOREACH_SAFE</a>, <a class="el" href="tree_8h_source.html#l00773">RB_REMOVE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00368">StreamTcpSegmentReturntoPool()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-list_8c_source.html#l00880">StreamTcpPruneSession()</a>, <a class="el" href="stream-tcp_8c_source.html#l00277">StreamTcpSessionPktFree()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00196">StreamTcpStreamCleanup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph" id="astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph">
<area shape="rect" title="return all segments in this stream into the pool(s)" alt="" coords="5,5,229,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="277,5,489,32"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="537,5,664,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="712,5,799,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph" id="astream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph">
<area shape="rect" title="return all segments in this stream into the pool(s)" alt="" coords="709,56,933,83"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,5,655,32"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,56,661,83"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,107,660,133"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,81,436,108"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,132,434,159"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,31,189,57"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,132,197,159"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,81,209,108"/>
</map>
</div>

</div>
</div>
<a id="a11fcdabd0f9f4889f7b15cd098e28c00" name="a11fcdabd0f9f4889f7b15cd098e28c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11fcdabd0f9f4889f7b15cd098e28c00">&#9670;&nbsp;</a></span>StreamTcpSegmentReturntoPool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSegmentReturntoPool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTcpSegment.html">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the segment back to the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seg</td><td>Segment which will be returned back to the pool. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00368">368</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00078">TcpSegment::pcap_hdr_storage</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00067">TcpSegmentPcapHdrStorage_::pktlen</a>, and <a class="el" href="util-pool-thread_8c_source.html#l00187">PoolThreadReturn()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">StreamTcpReturnStreamSegments()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph" id="astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph">
<area shape="rect" title="Function to return the segment back to the pool." alt="" coords="5,5,217,32"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="265,5,392,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="440,5,527,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph.png" border="0" usemap="#astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph" alt=""/></div>
<map name="astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph" id="astream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph">
<area shape="rect" title="Function to return the segment back to the pool." alt="" coords="981,56,1193,83"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="709,56,933,83"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,5,655,32"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,56,661,83"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,107,660,133"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,81,436,108"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,132,434,159"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,31,189,57"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,132,197,159"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,81,209,108"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a819fe1b32fe9d7dec8649ef7af7582d9" name="a819fe1b32fe9d7dec8649ef7af7582d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819fe1b32fe9d7dec8649ef7af7582d9">&#9670;&nbsp;</a></span>t_pcapcnt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">thread_local uint64_t t_pcapcnt = UINT64_MAX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00077">77</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05348">StreamTcp()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp-reassemble_8c.html">stream-tcp-reassemble.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:24 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
