<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/flow-hash.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('flow-hash_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">flow-hash.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-hash_8h_source.html">flow-hash.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-private_8h_source.html">flow-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-manager_8h_source.html">flow-manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-storage_8h_source.html">flow-storage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-timeout_8h_source.html">flow-timeout.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-spare-pool_8h_source.html">flow-spare-pool.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-hash-lookup3_8h_source.html">util-hash-lookup3.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="output_8h_source.html">output.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="output-flow_8h_source.html">output-flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-exception-policy_8h_source.html">util-exception-policy.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for flow-hash.c:</div>
<div class="dyncontent">
<div class="center"><img src="flow-hash_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2flow-hash_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2flow-hash_8c" id="a_2Users_2jlu_2suricata_2src_2flow-hash_8c">
<area shape="rect" title=" " alt="" coords="1373,5,1501,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="905,169,1039,196"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="85,468,161,495"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="145,393,234,420"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1065,319,1140,345"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="1147,468,1205,495"/>
<area shape="rect" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine." alt="" coords="791,95,935,121"/>
<area shape="rect" href="flow_8h.html" title=" " alt="" coords="1537,169,1591,196"/>
<area shape="rect" href="util-exception-policy_8h.html" title=" " alt="" coords="1765,244,1912,271"/>
<area shape="rect" href="flow-hash_8h.html" title=" " alt="" coords="1615,169,1705,196"/>
<area shape="rect" href="flow-util_8h.html" title=" " alt="" coords="1285,95,1363,121"/>
<area shape="rect" href="flow-private_8h.html" title=" " alt="" coords="1387,95,1487,121"/>
<area shape="rect" href="flow-manager_8h.html" title=" " alt="" coords="1511,95,1622,121"/>
<area shape="rect" href="flow-storage_8h.html" title=" " alt="" coords="1105,95,1209,121"/>
<area shape="rect" href="flow-timeout_8h.html" title=" " alt="" coords="1697,95,1801,121"/>
<area shape="rect" href="flow-spare-pool_8h.html" title=" " alt="" coords="959,95,1081,121"/>
<area shape="rect" href="app-layer-parser_8h.html" title=" " alt="" coords="1876,95,2001,121"/>
<area shape="rect" href="util-time_8h.html" title=" " alt="" coords="2026,95,2105,121"/>
<area shape="rect" href="util-hash-lookup3_8h.html" title=" " alt="" coords="2129,95,2260,121"/>
<area shape="rect" href="output_8h.html" title=" " alt="" coords="2284,95,2353,121"/>
<area shape="rect" href="output-flow_8h.html" title=" " alt="" coords="2307,169,2402,196"/>
<area shape="rect" href="stream-tcp_8h.html" title=" " alt="" coords="2429,95,2523,121"/>
<area shape="rect" title=" " alt="" coords="1153,244,1218,271"/>
<area shape="rect" title=" " alt="" coords="1242,244,1321,271"/>
<area shape="rect" title=" " alt="" coords="1345,244,1410,271"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="1537,244,1639,271"/>
<area shape="rect" title=" " alt="" coords="455,244,529,271"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="553,244,703,271"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="1779,468,1858,495"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="892,244,975,271"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="727,244,867,271"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="1050,244,1129,271"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="2009,319,2087,345"/>
<area shape="rect" href="util-cpu_8h.html" title=" " alt="" coords="36,543,111,569"/>
<area shape="rect" title=" " alt="" coords="135,543,211,569"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="1117,393,1235,420"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="1259,393,1354,420"/>
<area shape="rect" href="decode-events_8h.html" title=" " alt="" coords="1378,393,1497,420"/>
<area shape="rect" href="flow-worker_8h.html" title=" " alt="" coords="1521,393,1620,420"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="2154,393,2281,420"/>
<area shape="rect" href="util-napatech_8h.html" title=" " alt="" coords="1644,393,1751,420"/>
<area shape="rect" href="source-nflog_8h.html" title=" " alt="" coords="1775,393,1879,420"/>
<area shape="rect" href="source-nfq_8h.html" title=" " alt="" coords="258,393,353,420"/>
<area shape="rect" href="source-ipfw_8h.html" title=" " alt="" coords="1903,393,2001,420"/>
<area shape="rect" href="source-pcap_8h.html" title=" " alt="" coords="2025,393,2129,420"/>
<area shape="rect" href="source-af-packet_8h.html" title=" " alt="" coords="377,393,508,420"/>
<area shape="rect" href="source-netmap_8h.html" title=" " alt="" coords="533,393,651,420"/>
<area shape="rect" href="source-windivert_8h.html" title=" " alt="" coords="676,393,804,420"/>
<area shape="rect" href="action-globals_8h.html" title=" " alt="" coords="829,393,942,420"/>
<area shape="rect" href="decode-ethernet_8h.html" title=" " alt="" coords="966,393,1093,420"/>
</map>
</div>
</div>
<p><a href="flow-hash_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFlowHashKey4__.html">FlowHashKey4_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFlowHashKey6__.html">FlowHashKey6_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0365012aed687c52ff9cd97de38245e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a0365012aed687c52ff9cd97de38245e7">FLOW_GET_NEW_TRIES</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a0365012aed687c52ff9cd97de38245e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86f12d32a90b7b3a18ee01a831b0b27"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#ae86f12d32a90b7b3a18ee01a831b0b27">STATSADDUI64</a>(cnt,  value)</td></tr>
<tr class="separator:ae86f12d32a90b7b3a18ee01a831b0b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a529095eff8f42fce0b62b633aba7f702"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structFlowHashKey4__.html">FlowHashKey4_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a529095eff8f42fce0b62b633aba7f702">FlowHashKey4</a></td></tr>
<tr class="separator:a529095eff8f42fce0b62b633aba7f702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c610f890808927be87c2fa7b9a1ebf"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structFlowHashKey6__.html">FlowHashKey6_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#ae2c610f890808927be87c2fa7b9a1ebf">FlowHashKey6</a></td></tr>
<tr class="separator:ae2c610f890808927be87c2fa7b9a1ebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab6f562681fb19138ac40143ef183f761"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#ab6f562681fb19138ac40143ef183f761">SC_ATOMIC_EXTERN</a> (unsigned int, flow_prune_idx)</td></tr>
<tr class="separator:ab6f562681fb19138ac40143ef183f761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19cdc416533c97bf10a18e802256ee22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a19cdc416533c97bf10a18e802256ee22">SC_ATOMIC_EXTERN</a> (unsigned int, flow_flags)</td></tr>
<tr class="separator:a19cdc416533c97bf10a18e802256ee22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1d8a6ab9e4f357bceea9b15d3c24e1"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a5a1d8a6ab9e4f357bceea9b15d3c24e1">FlowKeyGetHash</a> (<a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *fk)</td></tr>
<tr class="separator:a5a1d8a6ab9e4f357bceea9b15d3c24e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a79d46fb8dfbc2ee5afefdb39f7d5f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a1a79d46fb8dfbc2ee5afefdb39f7d5f6">FlowSetupPacket</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a1a79d46fb8dfbc2ee5afefdb39f7d5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">prepare packet for a life with flow Set PKT_WANTS_FLOW flag to incidate workers should do a flow lookup and calc the hash value to be used in the lookup and autofp flow balancing.  <a href="flow-hash_8c.html#a1a79d46fb8dfbc2ee5afefdb39f7d5f6">More...</a><br /></td></tr>
<tr class="separator:a1a79d46fb8dfbc2ee5afefdb39f7d5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af46af06670840605dcd58e5432013a8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#af46af06670840605dcd58e5432013a8f">FlowGetFlowFromHash</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="flow_8h.html#a2d77f0373e685ff430a8f029f070a749">FlowLookupStruct</a> *fls, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> **dest)</td></tr>
<tr class="memdesc:af46af06670840605dcd58e5432013a8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Flow for packet.  <a href="flow-hash_8c.html#af46af06670840605dcd58e5432013a8f">More...</a><br /></td></tr>
<tr class="separator:af46af06670840605dcd58e5432013a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc925fee33bb2626efa046efa3e76cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a1dc925fee33bb2626efa046efa3e76cf">FlowGetFromFlowKey</a> (<a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *key, struct timespec *ttime, const uint32_t hash)</td></tr>
<tr class="memdesc:a1dc925fee33bb2626efa046efa3e76cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get or create a Flow using a FlowKey.  <a href="flow-hash_8c.html#a1dc925fee33bb2626efa046efa3e76cf">More...</a><br /></td></tr>
<tr class="separator:a1dc925fee33bb2626efa046efa3e76cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b135a7e4f59c71d902720b4bbed6037"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a4b135a7e4f59c71d902720b4bbed6037">FlowGetExistingFlowFromHash</a> (<a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *key, const uint32_t hash)</td></tr>
<tr class="memdesc:a4b135a7e4f59c71d902720b4bbed6037"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look for existing Flow using a FlowKey.  <a href="flow-hash_8c.html#a4b135a7e4f59c71d902720b4bbed6037">More...</a><br /></td></tr>
<tr class="separator:a4b135a7e4f59c71d902720b4bbed6037"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp_8h.html#a8908bce3b095fbb7526cafd3ffbabf2b">TcpStreamCnf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#ac6bed017a2a4f7ef805bd3b51a251d68">stream_config</a></td></tr>
<tr class="separator:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2cee129447a542d7c07362007c8ea2"><td class="memItemLeft" align="right" valign="top">FlowBucket *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-hash_8c.html#a0a2cee129447a542d7c07362007c8ea2">flow_hash</a></td></tr>
<tr class="separator:a0a2cee129447a542d7c07362007c8ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd>
<dd>
Pablo Rincon Crespo <a href="#" onclick="location.href='mai'+'lto:'+'pab'+'lo'+'.ri'+'nc'+'on.'+'cr'+'esp'+'o@'+'gma'+'il'+'.co'+'m'; return false;">pablo<span class="obfuscator">.nosp@m.</span>.rin<span class="obfuscator">.nosp@m.</span>con.c<span class="obfuscator">.nosp@m.</span>resp<span class="obfuscator">.nosp@m.</span>o@gma<span class="obfuscator">.nosp@m.</span>il.c<span class="obfuscator">.nosp@m.</span>om</a></dd></dl>
<p>Flow Hashing functions. </p>

<p class="definition">Definition in file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0365012aed687c52ff9cd97de38245e7" name="a0365012aed687c52ff9cd97de38245e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0365012aed687c52ff9cd97de38245e7">&#9670;&nbsp;</a></span>FLOW_GET_NEW_TRIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_GET_NEW_TRIES&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00979">979</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

</div>
</div>
<a id="ae86f12d32a90b7b3a18ee01a831b0b27" name="ae86f12d32a90b7b3a18ee01a831b0b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae86f12d32a90b7b3a18ee01a831b0b27">&#9670;&nbsp;</a></span>STATSADDUI64</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATSADDUI64</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cnt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">value&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a> &amp;&amp; <a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#a6471cbf93b5fa3fbc67bbafe52d29adb">dtv</a>) { \</div>
<div class="line">            StatsAddUI64(<a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a>, <a class="code hl_variable" href="fuzz__decodepcapfile_8c.html#a6471cbf93b5fa3fbc67bbafe52d29adb">dtv</a>-&gt;cnt, (value)); \</div>
<div class="line">        }</div>
<div class="ttc" id="afuzz__decodepcapfile_8c_html_a6471cbf93b5fa3fbc67bbafe52d29adb"><div class="ttname"><a href="fuzz__decodepcapfile_8c.html#a6471cbf93b5fa3fbc67bbafe52d29adb">dtv</a></div><div class="ttdeci">DecodeThreadVars * dtv</div><div class="ttdef"><b>Definition:</b> <a href="fuzz__decodepcapfile_8c_source.html#l00032">fuzz_decodepcapfile.c:32</a></div></div>
<div class="ttc" id="afuzz__decodepcapfile_8c_html_ab586e04d20a83310f10b8ca067fdc60c"><div class="ttname"><a href="fuzz__decodepcapfile_8c.html#ab586e04d20a83310f10b8ca067fdc60c">tv</a></div><div class="ttdeci">ThreadVars * tv</div><div class="ttdef"><b>Definition:</b> <a href="fuzz__decodepcapfile_8c_source.html#l00031">fuzz_decodepcapfile.c:31</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l01030">1030</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a529095eff8f42fce0b62b633aba7f702" name="a529095eff8f42fce0b62b633aba7f702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a529095eff8f42fce0b62b633aba7f702">&#9670;&nbsp;</a></span>FlowHashKey4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structFlowHashKey4__.html">FlowHashKey4_</a> <a class="el" href="flow-hash_8c.html#a529095eff8f42fce0b62b633aba7f702">FlowHashKey4</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae2c610f890808927be87c2fa7b9a1ebf" name="ae2c610f890808927be87c2fa7b9a1ebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2c610f890808927be87c2fa7b9a1ebf">&#9670;&nbsp;</a></span>FlowHashKey6</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structFlowHashKey6__.html">FlowHashKey6_</a> <a class="el" href="flow-hash_8c.html#ae2c610f890808927be87c2fa7b9a1ebf">FlowHashKey6</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4b135a7e4f59c71d902720b4bbed6037" name="a4b135a7e4f59c71d902720b4bbed6037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b135a7e4f59c71d902720b4bbed6037">&#9670;&nbsp;</a></span>FlowGetExistingFlowFromHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> * FlowGetExistingFlowFromHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Look for existing Flow using a FlowKey. </p>
<p >Hash retrieval function for flows. Looks up the hash bucket containing the flow pointer. Then compares the packet with the found flow to see if it is the flow we need. If it isn't, walk the list until the right flow is found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to FlowKey build using flow to look for </td></tr>
    <tr><td class="paramname">hash</td><td>Value of the flow hash </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">f</td><td><em>LOCKED</em> flow or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00935">935</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">References <a class="el" href="flow-hash_8h_source.html#l00071">FBLOCK_LOCK</a>, <a class="el" href="flow-hash_8h_source.html#l00073">FBLOCK_UNLOCK</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-hash_8c_source.html#l00873">FlowGetFromFlowKey()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-hash_8c_a4b135a7e4f59c71d902720b4bbed6037_icgraph.png" border="0" usemap="#aflow-hash_8c_a4b135a7e4f59c71d902720b4bbed6037_icgraph" alt=""/></div>
<map name="aflow-hash_8c_a4b135a7e4f59c71d902720b4bbed6037_icgraph" id="aflow-hash_8c_a4b135a7e4f59c71d902720b4bbed6037_icgraph">
<area shape="rect" title="Look for existing Flow using a FlowKey." alt="" coords="205,5,412,32"/>
<area shape="rect" href="flow-hash_8c.html#a1dc925fee33bb2626efa046efa3e76cf" title="Get or create a Flow using a FlowKey." alt="" coords="5,5,157,32"/>
</map>
</div>

</div>
</div>
<a id="af46af06670840605dcd58e5432013a8f" name="af46af06670840605dcd58e5432013a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46af06670840605dcd58e5432013a8f">&#9670;&nbsp;</a></span>FlowGetFlowFromHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> * FlowGetFlowFromHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a2d77f0373e685ff430a8f029f070a749">FlowLookupStruct</a> *&#160;</td>
          <td class="paramname"><em>fls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> **&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Flow for packet. </p>
<p >Hash retrieval function for flows. Looks up the hash bucket containing the flow pointer. Then compares the packet with the found flow to see if it is the flow we need. If it isn't, walk the list until the right flow is found.</p>
<p >If the flow is not found or the bucket was emtpy, a new flow is taken from the spare pool. The pool will alloc new flows as long as we stay within our memcap limit.</p>
<p >The p-&gt;flow pointer is updated to point to the flow.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>thread vars </td></tr>
    <tr><td class="paramname">dtv</td><td>decode thread vars (for flow log api thread data)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">f</td><td><em>LOCKED</em> flow or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00743">743</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">References <a class="el" href="flow-hash_8h_source.html#l00071">FBLOCK_LOCK</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="decode_8h_source.html#l00475">Packet_::flow_hash</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l00508">FlowHandlePacket()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-hash_8c_af46af06670840605dcd58e5432013a8f_icgraph.png" border="0" usemap="#aflow-hash_8c_af46af06670840605dcd58e5432013a8f_icgraph" alt=""/></div>
<map name="aflow-hash_8c_af46af06670840605dcd58e5432013a8f_icgraph" id="aflow-hash_8c_af46af06670840605dcd58e5432013a8f_icgraph">
<area shape="rect" title="Get Flow for packet." alt="" coords="403,5,563,32"/>
<area shape="rect" href="flow_8c.html#a045986b2e6fe1d286361da7b08c03c7f" title="Entry point for packet flow handling." alt="" coords="223,5,355,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#af06fe2a36e13018d41be2a28357f3032" title=" " alt="" coords="5,5,175,32"/>
</map>
</div>

</div>
</div>
<a id="a1dc925fee33bb2626efa046efa3e76cf" name="a1dc925fee33bb2626efa046efa3e76cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc925fee33bb2626efa046efa3e76cf">&#9670;&nbsp;</a></span>FlowGetFromFlowKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> * FlowGetFromFlowKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>ttime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get or create a Flow using a FlowKey. </p>
<p >Hash retrieval function for flows. Looks up the hash bucket containing the flow pointer. Then compares the packet with the found flow to see if it is the flow we need. If it isn't, walk the list until the right flow is found. Return a new Flow if ever no Flow was found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Pointer to FlowKey build using flow to look for </td></tr>
    <tr><td class="paramname">ttime</td><td>time to use for flow creation </td></tr>
    <tr><td class="paramname">hash</td><td>Value of the flow hash </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">f</td><td><em>LOCKED</em> flow or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00873">873</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">References <a class="el" href="flow_8h_source.html#l00309">FlowKey_::dp</a>, <a class="el" href="flow_8h_source.html#l00369">Flow_::dp</a>, <a class="el" href="flow_8h_source.html#l00308">FlowKey_::dst</a>, <a class="el" href="flow_8h_source.html#l00356">Flow_::dst</a>, <a class="el" href="decode_8h_source.html#l00114">Address_::family</a>, <a class="el" href="flow_8h_source.html#l00498">Flow_::fb</a>, <a class="el" href="flow-hash_8h_source.html#l00071">FBLOCK_LOCK</a>, <a class="el" href="flow-hash_8h_source.html#l00073">FBLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00431">Flow_::flags</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="flow-hash_8c_source.html#l00057">flow_hash</a>, <a class="el" href="flow_8h_source.html#l00409">Flow_::flow_hash</a>, <a class="el" href="flow_8h_source.html#l00096">FLOW_IPV4</a>, <a class="el" href="flow_8h_source.html#l00098">FLOW_IPV6</a>, <a class="el" href="flow-util_8c_source.html#l00052">FlowAlloc()</a>, <a class="el" href="flow-hash_8c_source.html#l00935">FlowGetExistingFlowFromHash()</a>, <a class="el" href="flow-util_8c_source.html#l00096">FlowGetProtoMapping()</a>, <a class="el" href="flow_8h_source.html#l00265">FLOWLOCK_WRLOCK</a>, <a class="el" href="flow_8h_source.html#l00289">FlowCnf_::hash_size</a>, <a class="el" href="flow_8h_source.html#l00414">Flow_::lastts</a>, <a class="el" href="flow_8h_source.html#l00404">Flow_::next</a>, <a class="el" href="flow_8h_source.html#l00310">FlowKey_::proto</a>, <a class="el" href="flow_8h_source.html#l00375">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00455">Flow_::protomap</a>, <a class="el" href="flow_8h_source.html#l00376">Flow_::recursion_level</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="flow_8h_source.html#l00309">FlowKey_::sp</a>, <a class="el" href="flow_8h_source.html#l00358">Flow_::sp</a>, <a class="el" href="flow_8h_source.html#l00308">FlowKey_::src</a>, <a class="el" href="flow_8h_source.html#l00356">Flow_::src</a>, <a class="el" href="flow_8h_source.html#l00500">Flow_::startts</a>, <a class="el" href="flow_8h_source.html#l00312">FlowKey_::vlan_id</a>, and <a class="el" href="flow_8h_source.html#l00377">Flow_::vlan_id</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-hash_8c_a1dc925fee33bb2626efa046efa3e76cf_cgraph.png" border="0" usemap="#aflow-hash_8c_a1dc925fee33bb2626efa046efa3e76cf_cgraph" alt=""/></div>
<map name="aflow-hash_8c_a1dc925fee33bb2626efa046efa3e76cf_cgraph" id="aflow-hash_8c_a1dc925fee33bb2626efa046efa3e76cf_cgraph">
<area shape="rect" title="Get or create a Flow using a FlowKey." alt="" coords="5,56,157,83"/>
<area shape="rect" href="flow-util_8c.html#a6c7b29f3d513187227f7b49c673cd9bb" title="allocate a flow" alt="" coords="269,5,348,32"/>
<area shape="rect" href="flow-hash_8c.html#a4b135a7e4f59c71d902720b4bbed6037" title="Look for existing Flow using a FlowKey." alt="" coords="205,56,412,83"/>
<area shape="rect" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration." alt="" coords="233,107,384,133"/>
<area shape="rect" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title=" " alt="" coords="460,5,581,32"/>
<area shape="rect" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers" alt="" coords="629,5,744,32"/>
</map>
</div>

</div>
</div>
<a id="a5a1d8a6ab9e4f357bceea9b15d3c24e1" name="a5a1d8a6ab9e4f357bceea9b15d3c24e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1d8a6ab9e4f357bceea9b15d3c24e1">&#9670;&nbsp;</a></span>FlowKeyGetHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t FlowKeyGetHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#ab6c712ecc39a712fa9fd7acd537871dc">FlowKey</a> *&#160;</td>
          <td class="paramname"><em>fk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Basic hashing function for FlowKey</p>
<dl class="section note"><dt>Note</dt><dd>Function only used for bypass and TCP or UDP flows</dd>
<dd>
this is only used at start to create Flow from pinned maps so fairness is not an issue </dd></dl>

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00227">227</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">References <a class="el" href="structAddress__.html#acb85ab4bd0505d475a60fc175a85f6a8">Address_::address</a>, <a class="el" href="decode_8h_source.html#l00116">Address_::address_un_data32</a>, <a class="el" href="flow-hash_8c_source.html#l00088">FlowHashKey4_::addrs</a>, <a class="el" href="flow_8h_source.html#l00309">FlowKey_::dp</a>, <a class="el" href="flow_8h_source.html#l00308">FlowKey_::dst</a>, <a class="el" href="decode_8h_source.html#l00114">Address_::family</a>, <a class="el" href="flow_8c_source.html#l00099">flow_config</a>, <a class="el" href="suricata_8c_source.html#l00244">g_vlan_mask</a>, <a class="el" href="flow_8h_source.html#l00288">FlowCnf_::hash_rand</a>, <a class="el" href="util-hash-lookup3_8c_source.html#l00174">hashword()</a>, <a class="el" href="flow-hash_8c_source.html#l00089">FlowHashKey4_::ports</a>, <a class="el" href="flow-hash_8c_source.html#l00090">FlowHashKey4_::proto</a>, <a class="el" href="flow_8h_source.html#l00310">FlowKey_::proto</a>, <a class="el" href="flow-hash_8c_source.html#l00091">FlowHashKey4_::recur</a>, <a class="el" href="flow_8h_source.html#l00311">FlowKey_::recursion_level</a>, <a class="el" href="flow_8h_source.html#l00309">FlowKey_::sp</a>, <a class="el" href="flow_8h_source.html#l00308">FlowKey_::src</a>, <a class="el" href="flow-hash_8c_source.html#l00094">FlowHashKey4_::u32</a>, <a class="el" href="flow-hash_8c_source.html#l00092">FlowHashKey4_::vlan_id</a>, and <a class="el" href="flow_8h_source.html#l00312">FlowKey_::vlan_id</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-hash_8c_a5a1d8a6ab9e4f357bceea9b15d3c24e1_cgraph.png" border="0" usemap="#aflow-hash_8c_a5a1d8a6ab9e4f357bceea9b15d3c24e1_cgraph" alt=""/></div>
<map name="aflow-hash_8c_a5a1d8a6ab9e4f357bceea9b15d3c24e1_cgraph" id="aflow-hash_8c_a5a1d8a6ab9e4f357bceea9b15d3c24e1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,131,32"/>
<area shape="rect" href="util-hash-lookup3_8c.html#a6b57e35d1649b351ed629d3e022bf85f" title=" " alt="" coords="179,5,257,32"/>
</map>
</div>

</div>
</div>
<a id="a1a79d46fb8dfbc2ee5afefdb39f7d5f6" name="a1a79d46fb8dfbc2ee5afefdb39f7d5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a79d46fb8dfbc2ee5afefdb39f7d5f6">&#9670;&nbsp;</a></span>FlowSetupPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetupPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prepare packet for a life with flow Set PKT_WANTS_FLOW flag to incidate workers should do a flow lookup and calc the hash value to be used in the lookup and autofp flow balancing. </p>

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00424">424</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00475">Packet_::flow_hash</a>, and <a class="el" href="decode_8h_source.html#l01199">PKT_WANTS_FLOW</a>.</p>

</div>
</div>
<a id="a19cdc416533c97bf10a18e802256ee22" name="a19cdc416533c97bf10a18e802256ee22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19cdc416533c97bf10a18e802256ee22">&#9670;&nbsp;</a></span>SC_ATOMIC_EXTERN() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_EXTERN </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_flags&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab6f562681fb19138ac40143ef183f761" name="ab6f562681fb19138ac40143ef183f761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6f562681fb19138ac40143ef183f761">&#9670;&nbsp;</a></span>SC_ATOMIC_EXTERN() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_EXTERN </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_prune_idx&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0a2cee129447a542d7c07362007c8ea2" name="a0a2cee129447a542d7c07362007c8ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a2cee129447a542d7c07362007c8ea2">&#9670;&nbsp;</a></span>flow_hash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FlowBucket* flow_hash</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="flow-hash_8c_source.html#l00057">57</a> of file <a class="el" href="flow-hash_8c_source.html">flow-hash.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-hash_8c_source.html#l00935">FlowGetExistingFlowFromHash()</a>, <a class="el" href="flow-hash_8c_source.html#l00743">FlowGetFlowFromHash()</a>, <a class="el" href="flow-hash_8c_source.html#l00873">FlowGetFromFlowKey()</a>, <a class="el" href="flow_8c_source.html#l00524">FlowInitConfig()</a>, <a class="el" href="flow_8c_source.html#l00653">FlowReset()</a>, and <a class="el" href="flow_8c_source.html#l00671">FlowShutdown()</a>.</p>

</div>
</div>
<a id="ac6bed017a2a4f7ef805bd3b51a251d68" name="ac6bed017a2a4f7ef805bd3b51a251d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bed017a2a4f7ef805bd3b51a251d68">&#9670;&nbsp;</a></span>stream_config</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp_8h.html#a8908bce3b095fbb7526cafd3ffbabf2b">TcpStreamCnf</a> stream_config</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00113">113</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-napatech_8c_source.html#l00804">NapatechGetStreamConfig()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00197">StreamTcpReassembleGetMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00182">StreamTcpReassembleSetMemcap()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00051">StreamTcpUTDeinit()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00058">StreamTcpUTInitInline()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00062">StreamTcpUTSetupSession()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00079">StreamTcpUTSetupStream()</a>, and <a class="el" href="util-unittest-helper_8c_source.html#l00550">UTHAddSessionToFlow()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="flow-hash_8c.html">flow-hash.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:23 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
