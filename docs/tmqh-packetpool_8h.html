<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/tmqh-packetpool.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('tmqh-packetpool_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">tmqh-packetpool.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tmqh-packetpool.h:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8h" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8h" id="a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8h">
<area shape="rect" title=" " alt="" coords="3015,5,3169,47"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1979,95,2053,121"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="4090,319,4166,345"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="3451,169,3584,196"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="4026,244,4115,271"/>
<area shape="rect" href="suricata-plugin_8h.html" title=" " alt="" coords="5,169,123,196"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="147,169,242,196"/>
<area shape="rect" href="decode-events_8h.html" title=" " alt="" coords="318,169,437,196"/>
<area shape="rect" href="flow-worker_8h.html" title=" " alt="" coords="461,169,560,196"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="585,169,711,196"/>
<area shape="rect" href="util-napatech_8h.html" title=" " alt="" coords="736,169,843,196"/>
<area shape="rect" href="source-nflog_8h.html" title=" " alt="" coords="867,169,971,196"/>
<area shape="rect" href="source-nfq_8h.html" title=" " alt="" coords="4139,244,4234,271"/>
<area shape="rect" href="source-ipfw_8h.html" title=" " alt="" coords="1045,169,1144,196"/>
<area shape="rect" href="source-pcap_8h.html" title=" " alt="" coords="1168,169,1272,196"/>
<area shape="rect" href="source-af-packet_8h.html" title=" " alt="" coords="1296,169,1427,196"/>
<area shape="rect" href="source-netmap_8h.html" title=" " alt="" coords="1451,169,1570,196"/>
<area shape="rect" href="source-windivert_8h.html" title=" " alt="" coords="1595,169,1723,196"/>
<area shape="rect" href="action-globals_8h.html" title=" " alt="" coords="1747,169,1861,196"/>
<area shape="rect" href="decode-ethernet_8h.html" title=" " alt="" coords="1885,169,2011,196"/>
<area shape="rect" href="decode-gre_8h.html" title=" " alt="" coords="2035,169,2133,196"/>
<area shape="rect" href="decode-ppp_8h.html" title=" " alt="" coords="2157,169,2257,196"/>
<area shape="rect" href="decode-pppoe_8h.html" title=" " alt="" coords="2281,169,2396,196"/>
<area shape="rect" href="decode-ipv4_8h.html" title=" " alt="" coords="2421,169,2523,196"/>
<area shape="rect" href="decode-ipv6_8h.html" title=" " alt="" coords="1386,244,1489,271"/>
<area shape="rect" href="decode-icmpv4_8h.html" title=" " alt="" coords="2693,169,2814,196"/>
<area shape="rect" href="decode-tcp_8h.html" title=" " alt="" coords="2522,244,2619,271"/>
<area shape="rect" href="decode-udp_8h.html" title=" " alt="" coords="2643,244,2743,271"/>
<area shape="rect" href="decode-icmpv6_8h.html" title=" " alt="" coords="2547,169,2669,196"/>
<area shape="rect" href="decode-sctp_8h.html" title=" " alt="" coords="2940,169,3044,196"/>
<area shape="rect" href="decode-esp_8h.html" title=" " alt="" coords="3069,169,3169,196"/>
<area shape="rect" href="decode-vlan_8h.html" title=" " alt="" coords="3193,169,3295,196"/>
<area shape="rect" href="decode-mpls_8h.html" title=" " alt="" coords="3320,169,3427,196"/>
<area shape="rect" title=" " alt="" coords="3034,244,3099,271"/>
<area shape="rect" title=" " alt="" coords="3123,244,3202,271"/>
<area shape="rect" title=" " alt="" coords="3226,244,3291,271"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="3315,244,3418,271"/>
<area shape="rect" title=" " alt="" coords="3442,244,3515,271"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="3591,244,3740,271"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="3750,319,3829,345"/>
<area shape="rect" href="util-mem_8h.html" title=" " alt="" coords="3764,244,3847,271"/>
<area shape="rect" href="detect-engine-alert_8h.html" title=" " alt="" coords="2767,244,2907,271"/>
<area shape="rect" href="util-path_8h.html" title=" " alt="" coords="3871,244,3950,271"/>
<area shape="rect" href="util-conf_8h.html" title=" " alt="" coords="2931,244,3010,271"/>
<area shape="rect" href="util-cpu_8h.html" title=" " alt="" coords="4040,393,4115,420"/>
<area shape="rect" title=" " alt="" coords="4139,393,4215,420"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="1471,319,1529,345"/>
<area shape="rect" title=" " alt="" coords="31,244,97,271"/>
<area shape="rect" title=" " alt="" coords="121,244,196,271"/>
<area shape="rect" href="tm-queues_8h.html" title=" " alt="" coords="221,244,315,271"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h__dep__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8hdep" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8hdep" id="a_2Users_2jlu_2suricata_2src_2tmqh-packetpool_8hdep">
<area shape="rect" title=" " alt="" coords="1440,5,1595,47"/>
<area shape="rect" href="decode_8c.html" title=" " alt="" coords="5,206,133,247"/>
<area shape="rect" href="defrag_8c.html" title=" " alt="" coords="2913,102,3041,143"/>
<area shape="rect" href="flow-worker_8c.html" title=" " alt="" coords="3065,102,3193,143"/>
<area shape="rect" href="runmode-unittests_8c.html" title=" " alt="" coords="3217,102,3380,143"/>
<area shape="rect" href="source-af-packet_8c.html" title=" " alt="" coords="158,206,314,247"/>
<area shape="rect" href="source-dpdk_8c.html" title=" " alt="" coords="339,206,469,247"/>
<area shape="rect" href="source-erf-dag_8c.html" title=" " alt="" coords="494,206,637,247"/>
<area shape="rect" href="source-napatech_8c.html" title=" " alt="" coords="661,206,816,247"/>
<area shape="rect" href="source-nflog_8c.html" title=" " alt="" coords="840,206,971,247"/>
<area shape="rect" href="source-nfq_8c.html" title=" " alt="" coords="995,206,1123,247"/>
<area shape="rect" href="source-pcap_8c.html" title=" " alt="" coords="1147,206,1277,247"/>
<area shape="rect" href="suricata_8c.html" title=" " alt="" coords="1301,206,1429,247"/>
<area shape="rect" href="fuzz__predefpcap__aware_8c.html" title=" " alt="" coords="3404,95,3551,151"/>
<area shape="rect" href="fuzz__sigpcap_8c.html" title=" " alt="" coords="3575,95,3710,151"/>
<area shape="rect" href="fuzz__sigpcap__aware_8c.html" title=" " alt="" coords="3734,95,3869,151"/>
<area shape="rect" href="tm-queuehandlers_8c.html" title=" " alt="" coords="3893,102,4056,143"/>
<area shape="rect" href="tm-threads_8c.html" title=" " alt="" coords="1453,206,1581,247"/>
<area shape="rect" href="tm-threads_8h.html" title=" " alt="" coords="2711,102,2839,143"/>
<area shape="rect" href="tmqh-packetpool_8c.html" title=" " alt="" coords="6715,206,6869,247"/>
<area shape="rect" href="alert-debuglog_8c.html" title=" " alt="" coords="6246,206,6386,247"/>
<area shape="rect" href="alert-fastlog_8c.html" title=" " alt="" coords="6411,206,6539,247"/>
<area shape="rect" href="alert-syslog_8c.html" title=" " alt="" coords="6563,206,6691,247"/>
<area shape="rect" href="app-layer-detect-proto_8c.html" title=" " alt="" coords="1605,199,1747,255"/>
<area shape="rect" href="counters_8c.html" title=" " alt="" coords="1771,206,1899,247"/>
<area shape="rect" href="detect-engine-loader_8c.html" title=" " alt="" coords="1923,206,2098,247"/>
<area shape="rect" href="detect-engine-register_8c.html" title=" " alt="" coords="2122,206,2305,247"/>
<area shape="rect" href="detect-engine-threshold_8c.html" title=" " alt="" coords="2329,206,2524,247"/>
<area shape="rect" href="detect-engine_8c.html" title=" " alt="" coords="2549,206,2686,247"/>
<area shape="rect" href="flow-bypass_8c.html" title=" " alt="" coords="2710,206,2839,247"/>
<area shape="rect" href="flow-manager_8c.html" title=" " alt="" coords="2864,206,3000,247"/>
<area shape="rect" href="flow-timeout_8c.html" title=" " alt="" coords="3024,206,3155,247"/>
<area shape="rect" href="flow_8c.html" title=" " alt="" coords="3179,206,3307,247"/>
<area shape="rect" href="log-httplog_8c.html" title=" " alt="" coords="3331,206,3459,247"/>
<area shape="rect" href="log-pcap_8c.html" title=" " alt="" coords="3483,206,3611,247"/>
<area shape="rect" href="log-stats_8c.html" title=" " alt="" coords="3635,206,3763,247"/>
<area shape="rect" href="log-tcp-data_8c.html" title=" " alt="" coords="3787,206,3915,247"/>
<area shape="rect" href="log-tlslog_8c.html" title=" " alt="" coords="3939,206,4067,247"/>
<area shape="rect" href="log-tlsstore_8c.html" title=" " alt="" coords="4091,206,4219,247"/>
<area shape="rect" href="output-json-alert_8c.html" title=" " alt="" coords="4243,206,4395,247"/>
<area shape="rect" href="output-json-anomaly_8c.html" title=" " alt="" coords="4419,206,4594,247"/>
<area shape="rect" href="output-json-common_8c.html" title=" " alt="" coords="4618,206,4795,247"/>
<area shape="rect" href="output-json-dcerpc_8c.html" title=" " alt="" coords="4819,206,4986,247"/>
<area shape="rect" href="output-json-dhcp_8c.html" title=" " alt="" coords="5011,206,5165,247"/>
<area shape="rect" href="output-json-dnp3_8c.html" title=" " alt="" coords="5189,206,5344,247"/>
<area shape="rect" href="output-json-dns_8c.html" title=" " alt="" coords="5369,206,5517,247"/>
<area shape="rect" href="output-json-drop_8c.html" title=" " alt="" coords="5541,206,5693,247"/>
<area shape="rect" href="output-json-email-common_8c.html" title=" " alt="" coords="5717,199,5864,255"/>
<area shape="rect" href="output-json-flow_8c.html" title=" " alt="" coords="5888,206,6037,247"/>
<area shape="rect" href="output-json-frame_8c.html" title=" " alt="" coords="6061,206,6221,247"/>
</map>
</div>
</div>
<p><a href="tmqh-packetpool_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPktPoolLockedStack__.html">PktPoolLockedStack_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPktPool__.html">PktPool_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6c7e47c0ea2619dc10444d0112ccc3a9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structPktPool__.html">PktPool_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a6c7e47c0ea2619dc10444d0112ccc3a9">PktPool</a></td></tr>
<tr class="separator:a6c7e47c0ea2619dc10444d0112ccc3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a664fda51f28c1f8a644768eccf11f4c6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structPktPoolLockedStack__.html">PktPoolLockedStack_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a664fda51f28c1f8a644768eccf11f4c6">__attribute__</a> ((aligned(<a class="el" href="suricata-common_8h.html#ada59561816893aa39c4aa41f1043c554">CLS</a>))) PktPoolLockedStack</td></tr>
<tr class="separator:a664fda51f28c1f8a644768eccf11f4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72d88c9ad8081992b892b02282eb752"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#ad72d88c9ad8081992b892b02282eb752">SC_ATOMIC_DECLARE</a> (int, sync_now)</td></tr>
<tr class="separator:ad72d88c9ad8081992b892b02282eb752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b7aec6d0f16ce3ecb1b5c853df4229"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a83b7aec6d0f16ce3ecb1b5c853df4229">TmqhInputPacketpool</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *)</td></tr>
<tr class="separator:a83b7aec6d0f16ce3ecb1b5c853df4229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd391771695d5ca519b327487929be4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#aecd391771695d5ca519b327487929be4">TmqhOutputPacketpool</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *)</td></tr>
<tr class="separator:aecd391771695d5ca519b327487929be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4e9d711280d1e9d5a1e6abef1f0def"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a9f4e9d711280d1e9d5a1e6abef1f0def">TmqhReleasePacketsToPacketPool</a> (<a class="el" href="packet-queue_8h.html#a01f3dbc5fb0281e026d4f456c22e5f5c">PacketQueue</a> *)</td></tr>
<tr class="memdesc:a9f4e9d711280d1e9d5a1e6abef1f0def"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed, and wants to return the packets back to the packetpool.  <a href="tmqh-packetpool_8h.html#a9f4e9d711280d1e9d5a1e6abef1f0def">More...</a><br /></td></tr>
<tr class="separator:a9f4e9d711280d1e9d5a1e6abef1f0def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bb62794ff6a8f547995c9128d5d8326"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a5bb62794ff6a8f547995c9128d5d8326">TmqhPacketpoolRegister</a> (void)</td></tr>
<tr class="memdesc:a5bb62794ff6a8f547995c9128d5d8326"><td class="mdescLeft">&#160;</td><td class="mdescRight">TmqhPacketpoolRegister \initonly.  <a href="tmqh-packetpool_8h.html#a5bb62794ff6a8f547995c9128d5d8326">More...</a><br /></td></tr>
<tr class="separator:a5bb62794ff6a8f547995c9128d5d8326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3933faec8b723a5f7192f30573e85647"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a3933faec8b723a5f7192f30573e85647">PacketPoolGetPacket</a> (void)</td></tr>
<tr class="memdesc:a3933faec8b723a5f7192f30573e85647"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a new packet from the packet pool.  <a href="tmqh-packetpool_8h.html#a3933faec8b723a5f7192f30573e85647">More...</a><br /></td></tr>
<tr class="separator:a3933faec8b723a5f7192f30573e85647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb91dedd8892e2dcdf907f83ff54fe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a2cb91dedd8892e2dcdf907f83ff54fe9">PacketPoolWait</a> (void)</td></tr>
<tr class="separator:a2cb91dedd8892e2dcdf907f83ff54fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986a0cbb8283d55f10d52f2aab29d761"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a986a0cbb8283d55f10d52f2aab29d761">PacketPoolWaitForN</a> (int n)</td></tr>
<tr class="memdesc:a986a0cbb8283d55f10d52f2aab29d761"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until we have the requested amount of packets in the pool.  <a href="tmqh-packetpool_8h.html#a986a0cbb8283d55f10d52f2aab29d761">More...</a><br /></td></tr>
<tr class="separator:a986a0cbb8283d55f10d52f2aab29d761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecfd7fbbc040386dbe6546236b7d20b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#aecfd7fbbc040386dbe6546236b7d20b7">PacketPoolReturnPacket</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:aecfd7fbbc040386dbe6546236b7d20b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return packet to Packet pool.  <a href="tmqh-packetpool_8h.html#aecfd7fbbc040386dbe6546236b7d20b7">More...</a><br /></td></tr>
<tr class="separator:aecfd7fbbc040386dbe6546236b7d20b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56fafc07686d12d34251bbc629005441"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a56fafc07686d12d34251bbc629005441">PacketPoolInit</a> (void)</td></tr>
<tr class="separator:a56fafc07686d12d34251bbc629005441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac12e370bb1f5ccbe943cf34454ab7b11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#ac12e370bb1f5ccbe943cf34454ab7b11">PacketPoolInitEmpty</a> (void)</td></tr>
<tr class="separator:ac12e370bb1f5ccbe943cf34454ab7b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e71693c415a1b0f3820cc0c186808d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a31e71693c415a1b0f3820cc0c186808d">PacketPoolDestroy</a> (void)</td></tr>
<tr class="separator:a31e71693c415a1b0f3820cc0c186808d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab91c961c33b49aff67cabd5e6e6384e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#ab91c961c33b49aff67cabd5e6e6384e8">PacketPoolPostRunmodes</a> (void)</td></tr>
<tr class="memdesc:ab91c961c33b49aff67cabd5e6e6384e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the max_pending_return_packets value.  <a href="tmqh-packetpool_8h.html#ab91c961c33b49aff67cabd5e6e6384e8">More...</a><br /></td></tr>
<tr class="separator:ab91c961c33b49aff67cabd5e6e6384e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab165523fdfdff0676c7c61d9ea969163"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threads_8h.html#a93b9e097562019ea65191bd846ecf3ae">SCMutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#ab165523fdfdff0676c7c61d9ea969163">mutex</a></td></tr>
<tr class="separator:ab165523fdfdff0676c7c61d9ea969163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fc6ec04170cd4bb821cb627e81b3d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threads_8h.html#a62e7c271915e245efc6c445145435400">SCCondT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a51fc6ec04170cd4bb821cb627e81b3d1">cond</a></td></tr>
<tr class="separator:a51fc6ec04170cd4bb821cb627e81b3d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e8a95b1add8e9be0df059a19dab517"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tmqh-packetpool_8h.html#a43e8a95b1add8e9be0df059a19dab517">head</a></td></tr>
<tr class="separator:a43e8a95b1add8e9be0df059a19dab517"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="tmqh-packetpool_8h_source.html">tmqh-packetpool.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a6c7e47c0ea2619dc10444d0112ccc3a9" name="a6c7e47c0ea2619dc10444d0112ccc3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7e47c0ea2619dc10444d0112ccc3a9">&#9670;&nbsp;</a></span>PktPool</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structPktPool__.html">PktPool_</a> <a class="el" href="tmqh-packetpool_8h.html#a6c7e47c0ea2619dc10444d0112ccc3a9">PktPool</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a664fda51f28c1f8a644768eccf11f4c6" name="a664fda51f28c1f8a644768eccf11f4c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a664fda51f28c1f8a644768eccf11f4c6">&#9670;&nbsp;</a></span>__attribute__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structPktPoolLockedStack__.html">PktPoolLockedStack_</a> __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(aligned(<a class="el" href="suricata-common_8h.html#ada59561816893aa39c4aa41f1043c554">CLS</a>))&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a31e71693c415a1b0f3820cc0c186808d" name="a31e71693c415a1b0f3820cc0c186808d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e71693c415a1b0f3820cc0c186808d">&#9670;&nbsp;</a></span>PacketPoolDestroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolDestroy </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00336">336</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

</div>
</div>
<a id="a3933faec8b723a5f7192f30573e85647" name="a3933faec8b723a5f7192f30573e85647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3933faec8b723a5f7192f30573e85647">&#9670;&nbsp;</a></span>PacketPoolGetPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> * PacketPoolGetPacket </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a new packet from the packet pool. </p>
<p >Only allocates from the thread's local stack, or mallocs new packets. If the local stack is empty, first move all the return stack packets to the local stack. </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Packet</td><td>pointer, or NULL on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00186">186</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-timeout_8c_source.html#l00273">FlowForceReassemblyPseudoPacketGet()</a>, <a class="el" href="decode_8c_source.html#l00214">PacketGetFromQueueOrAlloc()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00371">TmqhInputPacketpool()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a3933faec8b723a5f7192f30573e85647_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_a3933faec8b723a5f7192f30573e85647_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a3933faec8b723a5f7192f30573e85647_icgraph" id="atmqh-packetpool_8h_a3933faec8b723a5f7192f30573e85647_icgraph">
<area shape="rect" title="Get a new packet from the packet pool." alt="" coords="1067,132,1217,159"/>
<area shape="rect" href="flow-timeout_8c.html#a3c1e9e5229e4ffacc9827db5a6de93a2" title=" " alt="" coords="819,66,1019,107"/>
<area shape="rect" href="group__decode.html#ga16dce3a48e71dd5b13fb4c401f5f4a9c" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="821,132,1016,159"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a4f05bdfc946ea5e4020efa5eae2f3d7f" title=" " alt="" coords="844,208,993,235"/>
<area shape="rect" href="group__decode.html#gac9c52a724280a0180fd4b9afb33dce83" title="Setup a pseudo packet (reassembled frags)" alt="" coords="608,5,764,32"/>
<area shape="rect" href="group__decode.html#gaa23fca189120a210d3f5e887835e9282" title="Setup a pseudo packet (tunnel)" alt="" coords="608,56,764,83"/>
<area shape="rect" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop." alt="" coords="618,107,754,133"/>
<area shape="rect" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring." alt="" coords="620,157,752,184"/>
<area shape="rect" href="stream-tcp_8c.html#a3afba214a95265afcf490b5a85cbffc4" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="605,208,767,235"/>
<area shape="rect" href="source-erf-file_8c.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module." alt="" coords="335,107,553,133"/>
<area shape="rect" href="suricata_8c.html#aa0371b3074789f2a4d26e7d49f182b13" title=" " alt="" coords="152,157,287,184"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,195,104,221"/>
<area shape="rect" href="source-pfring_8c.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring." alt="" coords="337,157,551,184"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a5bb62794ff6a8f547995c9128d5d8326" title="TmqhPacketpoolRegister \initonly." alt="" coords="601,259,771,285"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a58283282aed172d5cc1839bf01c21bc2" title=" " alt="" coords="175,220,264,247"/>
</map>
</div>

</div>
</div>
<a id="a56fafc07686d12d34251bbc629005441" name="a56fafc07686d12d34251bbc629005441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56fafc07686d12d34251bbc629005441">&#9670;&nbsp;</a></span>PacketPoolInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00303">303</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="suricata_8c_source.html#l00222">max_pending_packets</a>.</p>

<p class="reference">Referenced by <a class="el" href="suricata_8c_source.html#l02201">PostRunDeinit()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a56fafc07686d12d34251bbc629005441_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_a56fafc07686d12d34251bbc629005441_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a56fafc07686d12d34251bbc629005441_icgraph" id="atmqh-packetpool_8h_a56fafc07686d12d34251bbc629005441_icgraph">
<area shape="rect" title=" " alt="" coords="377,5,484,32"/>
<area shape="rect" href="suricata_8c.html#a171efb32813007e7e4d3469a54b0bf66" title=" " alt="" coords="223,5,329,32"/>
<area shape="rect" href="suricata_8c.html#a28aa85b59c264490dd53beaf400ce5b4" title=" " alt="" coords="5,5,175,32"/>
</map>
</div>

</div>
</div>
<a id="ac12e370bb1f5ccbe943cf34454ab7b11" name="ac12e370bb1f5ccbe943cf34454ab7b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac12e370bb1f5ccbe943cf34454ab7b11">&#9670;&nbsp;</a></span>PacketPoolInitEmpty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolInitEmpty </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00288">288</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

</div>
</div>
<a id="ab91c961c33b49aff67cabd5e6e6384e8" name="ab91c961c33b49aff67cabd5e6e6384e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab91c961c33b49aff67cabd5e6e6384e8">&#9670;&nbsp;</a></span>PacketPoolPostRunmodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolPostRunmodes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the max_pending_return_packets value. </p>
<p >Set it to the max pending packets value, devided by the number of lister threads. Normally, in autofp these are the stream/detect/log worker threads.</p>
<p >The max_pending_return_packets value needs to stay below the packet pool size of the 'producers' (normally pkt capture threads but also flow timeout injection ) to avoid a deadlock where all the 'workers' keep packets in their return pools, while the capture thread can't continue because its pool is empty. </p>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00521">521</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="suricata_8c_source.html#l00222">max_pending_packets</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00506">RESERVED_PACKETS</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="tm-modules_8h_source.html#l00034">TM_FLAG_DETECT_TM</a>, and <a class="el" href="tm-threads_8c_source.html#l01935">TmThreadCountThreadsByTmmFlags()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_ab91c961c33b49aff67cabd5e6e6384e8_cgraph.png" border="0" usemap="#atmqh-packetpool_8h_ab91c961c33b49aff67cabd5e6e6384e8_cgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_ab91c961c33b49aff67cabd5e6e6384e8_cgraph" id="atmqh-packetpool_8h_ab91c961c33b49aff67cabd5e6e6384e8_cgraph">
<area shape="rect" title="Set the max_pending_return_packets value." alt="" coords="5,13,184,39"/>
<area shape="rect" href="tm-threads_8c.html#aa7caef5a78841ac82554ee5d55f0d9db" title="returns a count of all the threads that match the flag" alt="" coords="232,5,441,47"/>
</map>
</div>

</div>
</div>
<a id="aecfd7fbbc040386dbe6546236b7d20b7" name="aecfd7fbbc040386dbe6546236b7d20b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecfd7fbbc040386dbe6546236b7d20b7">&#9670;&nbsp;</a></span>PacketPoolReturnPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolReturnPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return packet to Packet pool. </p>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00226">226</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="decode_8c_source.html#l00197">PacketFreeOrRelease()</a>, and <a class="el" href="decode_8c_source.html#l00214">PacketGetFromQueueOrAlloc()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_aecfd7fbbc040386dbe6546236b7d20b7_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_aecfd7fbbc040386dbe6546236b7d20b7_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_aecfd7fbbc040386dbe6546236b7d20b7_icgraph" id="atmqh-packetpool_8h_aecfd7fbbc040386dbe6546236b7d20b7_icgraph">
<area shape="rect" title="Return packet to Packet pool." alt="" coords="1055,81,1224,108"/>
<area shape="rect" href="group__decode.html#gad9ba0322fe2563acde4b409301b9a39d" title="Return a packet to where it was allocated." alt="" coords="834,56,985,83"/>
<area shape="rect" href="group__decode.html#ga16dce3a48e71dd5b13fb4c401f5f4a9c" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="812,107,1007,133"/>
<area shape="rect" href="group__decode.html#gac9c52a724280a0180fd4b9afb33dce83" title="Setup a pseudo packet (reassembled frags)" alt="" coords="605,5,761,32"/>
<area shape="rect" href="group__decode.html#gaa23fca189120a210d3f5e887835e9282" title="Setup a pseudo packet (tunnel)" alt="" coords="605,56,761,83"/>
<area shape="rect" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop." alt="" coords="615,107,751,133"/>
<area shape="rect" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring." alt="" coords="617,157,749,184"/>
<area shape="rect" href="stream-tcp_8c.html#a3afba214a95265afcf490b5a85cbffc4" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="601,208,764,235"/>
<area shape="rect" href="source-erf-file_8c.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module." alt="" coords="335,107,553,133"/>
<area shape="rect" href="suricata_8c.html#aa0371b3074789f2a4d26e7d49f182b13" title=" " alt="" coords="152,132,287,159"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,132,104,159"/>
<area shape="rect" href="source-pfring_8c.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring." alt="" coords="337,157,551,184"/>
</map>
</div>

</div>
</div>
<a id="a2cb91dedd8892e2dcdf907f83ff54fe9" name="a2cb91dedd8892e2dcdf907f83ff54fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb91dedd8892e2dcdf907f83ff54fe9">&#9670;&nbsp;</a></span>PacketPoolWait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolWait </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00085">85</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow-timeout_8c_source.html#l00273">FlowForceReassemblyPseudoPacketGet()</a>, <a class="el" href="source-erf-file_8c_source.html#l00112">ReceiveErfFileLoop()</a>, and <a class="el" href="source-pfring_8c_source.html#l00342">ReceivePfringLoop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a2cb91dedd8892e2dcdf907f83ff54fe9_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_a2cb91dedd8892e2dcdf907f83ff54fe9_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a2cb91dedd8892e2dcdf907f83ff54fe9_icgraph" id="atmqh-packetpool_8h_a2cb91dedd8892e2dcdf907f83ff54fe9_icgraph">
<area shape="rect" title=" " alt="" coords="849,71,964,98"/>
<area shape="rect" href="flow-timeout_8c.html#a3c1e9e5229e4ffacc9827db5a6de93a2" title=" " alt="" coords="601,5,801,47"/>
<area shape="rect" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop." alt="" coords="633,71,769,98"/>
<area shape="rect" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring." alt="" coords="635,122,767,149"/>
<area shape="rect" href="source-erf-file_8c.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module." alt="" coords="335,71,553,98"/>
<area shape="rect" href="suricata_8c.html#aa0371b3074789f2a4d26e7d49f182b13" title=" " alt="" coords="152,97,287,123"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,97,104,123"/>
<area shape="rect" href="source-pfring_8c.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring." alt="" coords="337,122,551,149"/>
</map>
</div>

</div>
</div>
<a id="a986a0cbb8283d55f10d52f2aab29d761" name="a986a0cbb8283d55f10d52f2aab29d761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986a0cbb8283d55f10d52f2aab29d761">&#9670;&nbsp;</a></span>PacketPoolWaitForN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketPoolWaitForN </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait until we have the requested amount of packets in the pool. </p>
<p >In some cases waiting for packets is undesirable. Especially when a wait would happen under a lock of some kind, other parts of the engine could have to wait.</p>
<p >This function only returns when at least N packets are in our pool.</p>
<p >If counting in our pool's main stack didn't give us the number we are seeking, we check if the return stack is filled and add those to our main stack. Then we retry.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>number of packets needed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00114">114</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

</div>
</div>
<a id="ad72d88c9ad8081992b892b02282eb752" name="ad72d88c9ad8081992b892b02282eb752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72d88c9ad8081992b892b02282eb752">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__attribute__::SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sync_now&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a83b7aec6d0f16ce3ecb1b5c853df4229" name="a83b7aec6d0f16ce3ecb1b5c853df4229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83b7aec6d0f16ce3ecb1b5c853df4229">&#9670;&nbsp;</a></span>TmqhInputPacketpool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> * TmqhInputPacketpool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00371">371</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="tmqh-packetpool_8c_source.html#l00186">PacketPoolGetPacket()</a>.</p>

<p class="reference">Referenced by <a class="el" href="tmqh-packetpool_8c_source.html#l00069">TmqhPacketpoolRegister()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_cgraph.png" border="0" usemap="#atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_cgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_cgraph" id="atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,32"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a3933faec8b723a5f7192f30573e85647" title="Get a new packet from the packet pool." alt="" coords="203,5,353,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_icgraph" id="atmqh-packetpool_8h_a83b7aec6d0f16ce3ecb1b5c853df4229_icgraph">
<area shape="rect" title=" " alt="" coords="507,5,656,32"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a5bb62794ff6a8f547995c9128d5d8326" title="TmqhPacketpoolRegister \initonly." alt="" coords="289,5,459,32"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a58283282aed172d5cc1839bf01c21bc2" title=" " alt="" coords="152,5,241,32"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,5,104,32"/>
</map>
</div>

</div>
</div>
<a id="aecd391771695d5ca519b327487929be4" name="aecd391771695d5ca519b327487929be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd391771695d5ca519b327487929be4">&#9670;&nbsp;</a></span>TmqhOutputPacketpool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmqhOutputPacketpool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00376">376</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="action-globals_8h_source.html#l00030">ACTION_DROP</a>, <a class="el" href="util-validate_8h_source.html#l00111">DEBUG_VALIDATE_BUG_ON</a>, <a class="el" href="decode_8h_source.html#l00469">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00963">IS_TUNNEL_PKT</a>, <a class="el" href="decode_8h_source.html#l00968">IS_TUNNEL_PKT_VERDICTED</a>, <a class="el" href="decode_8h_source.html#l00966">IS_TUNNEL_ROOT_PKT</a>, <a class="el" href="flow-hash_8h_source.html#l00006">m</a>, <a class="el" href="util-profiling_8h_source.html#l00103">PACKET_PROFILING_END</a>, <a class="el" href="decode_8h_source.html#l00791">PACKET_RELEASE_REFS</a>, <a class="el" href="decode_8h_source.html#l00916">PACKET_TEST_ACTION</a>, <a class="el" href="decode_8h_source.html#l01160">PKT_ALLOC</a>, <a class="el" href="decode_8h_source.html#l00399">PKT_DROP_REASON_NOT_SET</a>, <a class="el" href="decode_8h_source.html#l00516">Packet_::ReleasePacket</a>, <a class="el" href="decode_8h_source.html#l00619">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="threads-debug_8h_source.html#l00114">SCMutex</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>, <a class="el" href="decode_8h_source.html#l00969">SET_TUNNEL_PKT_VERDICTED</a>, <a class="el" href="decode_8h_source.html#l00950">TUNNEL_INCR_PKT_RTV_NOLOCK</a>, <a class="el" href="decode_8h_source.html#l00629">Packet_::tunnel_mutex</a>, <a class="el" href="decode_8h_source.html#l00960">TUNNEL_PKT_RTV</a>, and <a class="el" href="decode_8h_source.html#l00961">TUNNEL_PKT_TPR</a>.</p>

<p class="reference">Referenced by <a class="el" href="tmqh-packetpool_8c_source.html#l00069">TmqhPacketpoolRegister()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00489">TmqhReleasePacketsToPacketPool()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_aecd391771695d5ca519b327487929be4_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_aecd391771695d5ca519b327487929be4_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_aecd391771695d5ca519b327487929be4_icgraph" id="atmqh-packetpool_8h_aecd391771695d5ca519b327487929be4_icgraph">
<area shape="rect" title=" " alt="" coords="569,31,728,57"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a5bb62794ff6a8f547995c9128d5d8326" title="TmqhPacketpoolRegister \initonly." alt="" coords="321,5,490,32"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed,..." alt="" coords="289,56,521,83"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a58283282aed172d5cc1839bf01c21bc2" title=" " alt="" coords="152,5,241,32"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,5,104,32"/>
</map>
</div>

</div>
</div>
<a id="a5bb62794ff6a8f547995c9128d5d8326" name="a5bb62794ff6a8f547995c9128d5d8326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bb62794ff6a8f547995c9128d5d8326">&#9670;&nbsp;</a></span>TmqhPacketpoolRegister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmqhPacketpoolRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TmqhPacketpoolRegister \initonly. </p>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00069">69</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="tm-queuehandlers_8h_source.html#l00038">Tmqh_::InHandler</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00037">Tmqh_::name</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00040">Tmqh_::OutHandler</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00030">TMQH_PACKETPOOL</a>, <a class="el" href="tm-queuehandlers_8c_source.html#l00037">tmqh_table</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00371">TmqhInputPacketpool()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00376">TmqhOutputPacketpool()</a>.</p>

<p class="reference">Referenced by <a class="el" href="tm-queuehandlers_8c_source.html#l00039">TmqhSetup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_cgraph.png" border="0" usemap="#atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_cgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_cgraph" id="atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_cgraph">
<area shape="rect" title="TmqhPacketpoolRegister \initonly." alt="" coords="5,31,175,57"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a4f05bdfc946ea5e4020efa5eae2f3d7f" title=" " alt="" coords="227,5,377,32"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title=" " alt="" coords="223,56,381,83"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a3933faec8b723a5f7192f30573e85647" title="Get a new packet from the packet pool." alt="" coords="429,5,580,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_icgraph.png" border="0" usemap="#atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_icgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_icgraph" id="atmqh-packetpool_8h_a5bb62794ff6a8f547995c9128d5d8326_icgraph">
<area shape="rect" title="TmqhPacketpoolRegister \initonly." alt="" coords="289,5,459,32"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a58283282aed172d5cc1839bf01c21bc2" title=" " alt="" coords="152,5,241,32"/>
<area shape="rect" href="runmode-unittests_8c.html#a9af3110b9567dff662af88ee42b5cba7" title=" " alt="" coords="5,5,104,32"/>
</map>
</div>

</div>
</div>
<a id="a9f4e9d711280d1e9d5a1e6abef1f0def" name="a9f4e9d711280d1e9d5a1e6abef1f0def"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4e9d711280d1e9d5a1e6abef1f0def">&#9670;&nbsp;</a></span>TmqhReleasePacketsToPacketPool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmqhReleasePacketsToPacketPool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a01f3dbc5fb0281e026d4f456c22e5f5c">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed, and wants to return the packets back to the packetpool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pq</td><td>Pointer to the packetqueue from which the packets have to be returned back to the packetpool</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>this function assumes that the pq does not use locking </dd></dl>

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8c_source.html#l00489">489</a> of file <a class="el" href="tmqh-packetpool_8c_source.html">tmqh-packetpool.c</a>.</p>

<p class="reference">References <a class="el" href="packet-queue_8c_source.html#l00212">PacketDequeue()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00376">TmqhOutputPacketpool()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tmqh-packetpool_8h_a9f4e9d711280d1e9d5a1e6abef1f0def_cgraph.png" border="0" usemap="#atmqh-packetpool_8h_a9f4e9d711280d1e9d5a1e6abef1f0def_cgraph" alt=""/></div>
<map name="atmqh-packetpool_8h_a9f4e9d711280d1e9d5a1e6abef1f0def_cgraph" id="atmqh-packetpool_8h_a9f4e9d711280d1e9d5a1e6abef1f0def_cgraph">
<area shape="rect" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed,..." alt="" coords="5,31,237,57"/>
<area shape="rect" href="packet-queue_8c.html#ac4b5ec1da525f7fea21bab5378d754e7" title=" " alt="" coords="307,5,422,32"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title=" " alt="" coords="285,56,444,83"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a51fc6ec04170cd4bb821cb627e81b3d1" name="a51fc6ec04170cd4bb821cb627e81b3d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fc6ec04170cd4bb821cb627e81b3d1">&#9670;&nbsp;</a></span>cond</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threads_8h.html#a62e7c271915e245efc6c445145435400">SCCondT</a> cond</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8h_source.html#l00002">2</a> of file <a class="el" href="tmqh-packetpool_8h_source.html">tmqh-packetpool.h</a>.</p>

</div>
</div>
<a id="a43e8a95b1add8e9be0df059a19dab517" name="a43e8a95b1add8e9be0df059a19dab517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43e8a95b1add8e9be0df059a19dab517">&#9670;&nbsp;</a></span>head</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a>* head</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8h_source.html#l00004">4</a> of file <a class="el" href="tmqh-packetpool_8h_source.html">tmqh-packetpool.h</a>.</p>

</div>
</div>
<a id="ab165523fdfdff0676c7c61d9ea969163" name="ab165523fdfdff0676c7c61d9ea969163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab165523fdfdff0676c7c61d9ea969163">&#9670;&nbsp;</a></span>mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threads_8h.html#a93b9e097562019ea65191bd846ecf3ae">SCMutex</a> mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tmqh-packetpool_8h_source.html#l00001">1</a> of file <a class="el" href="tmqh-packetpool_8h_source.html">tmqh-packetpool.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="tmqh-packetpool_8h.html">tmqh-packetpool.h</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:24 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
