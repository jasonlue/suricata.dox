<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: Application Layer Expectation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__applayerexpectation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Application Layer Expectation</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:app-layer-expectation_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-expectation_8c.html">app-layer-expectation.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structExpectation__.html">Expectation_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structExpectationData__.html">ExpectationData_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structExpectationList__.html">ExpectationList_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gafea41b1fc5c5ffa00b2196647481f4be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gafea41b1fc5c5ffa00b2196647481f4be">EXPECTATION_TIMEOUT</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:gafea41b1fc5c5ffa00b2196647481f4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5fd49196d7c2b98a674f88d4b69a7df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gac5fd49196d7c2b98a674f88d4b69a7df">EXPECTATION_MAX_LEVEL</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:gac5fd49196d7c2b98a674f88d4b69a7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga2c868db3a37794fdc55e3155fe7d01f3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structExpectation__.html">Expectation_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga2c868db3a37794fdc55e3155fe7d01f3">Expectation</a></td></tr>
<tr class="separator:ga2c868db3a37794fdc55e3155fe7d01f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab896b700095597dcc3a8a8e7f593583e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structExpectationData__.html">ExpectationData_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gab896b700095597dcc3a8a8e7f593583e">ExpectationData</a></td></tr>
<tr class="separator:gab896b700095597dcc3a8a8e7f593583e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadad28f245e7c36f0b0bace8f50c1ffa9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structExpectationList__.html">ExpectationList_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gadad28f245e7c36f0b0bace8f50c1ffa9">ExpectationList</a></td></tr>
<tr class="separator:gadad28f245e7c36f0b0bace8f50c1ffa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac264e37e2a2b7313b33114053c6d9914"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gac264e37e2a2b7313b33114053c6d9914">SC_ATOMIC_DECLARE</a> (uint32_t, expectation_count)</td></tr>
<tr class="separator:gac264e37e2a2b7313b33114053c6d9914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58b62836a5fee74b44bbc864ce144e28"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga58b62836a5fee74b44bbc864ce144e28">ExpectationGetCounter</a> (void)</td></tr>
<tr class="separator:ga58b62836a5fee74b44bbc864ce144e28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a6b6f83e48ff3a196b078531034f895"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga9a6b6f83e48ff3a196b078531034f895">AppLayerExpectationSetup</a> (void)</td></tr>
<tr class="separator:ga9a6b6f83e48ff3a196b078531034f895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa43a8dbbeeed0b38f565883af74d9f6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#gaa43a8dbbeeed0b38f565883af74d9f6b">AppLayerExpectationCreate</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, int direction, <a class="el" href="decode_8h.html#aebfc8a43171a8d87a23423fb4725bea4">Port</a> <a class="el" href="app-layer-dnp3_8h.html#ac87170cf133e48fc4c61ea4b90bfb515">src</a>, <a class="el" href="decode_8h.html#aebfc8a43171a8d87a23423fb4725bea4">Port</a> <a class="el" href="app-layer-dnp3_8h.html#a74794ae4e53b0a5e847a8f33fc5fbd6e">dst</a>, <a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, void *data)</td></tr>
<tr class="separator:gaa43a8dbbeeed0b38f565883af74d9f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65fbe6e43473f0c057cfc1eed8088089"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFlowStorageId.html">FlowStorageId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga65fbe6e43473f0c057cfc1eed8088089">AppLayerExpectationGetFlowId</a> (void)</td></tr>
<tr class="separator:ga65fbe6e43473f0c057cfc1eed8088089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d9613cfc2c836daaab126445acaf3a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga1d9613cfc2c836daaab126445acaf3a5">AppLayerExpectationHandle</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="separator:ga1d9613cfc2c836daaab126445acaf3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga021149ff14858903860941e3486dbe1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applayerexpectation.html#ga021149ff14858903860941e3486dbe1c">AppLayerExpectationClean</a> (<a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f)</td></tr>
<tr class="separator:ga021149ff14858903860941e3486dbe1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Handling of dynamic parallel connection for application layer similar to FTP.</p>
<p >Some protocols like FTP create dynamic parallel flow (called expectation). In order to assign a application layer protocol to these expectation, Suricata needs to parse message of the initial protocol and create and maintain a list of expected flow.</p>
<p >Application layers must use the here described API to implement this mechanism.</p>
<p >When parsing a application layer message describing a parallel flow, the application layer can call <a class="el" href="group__applayerexpectation.html#gaa43a8dbbeeed0b38f565883af74d9f6b">AppLayerExpectationCreate()</a> to declare an expectation. By doing that the next flow coming with corresponding IP parameters will be assigned the specified application layer. The resulting Flow will also have a Flow storage set that can be retrieved at index AppLayerExpectationGetDataId():</p>
<div class="fragment"><div class="line">data = (<span class="keywordtype">char</span> *)<a class="code hl_function" href="flow-storage_8c.html#abcfd6c429fcc2dec96d1adf5d3ca162b">FlowGetStorageById</a>(f, <a class="code hl_function" href="group__applayerexpectation.html#ga65fbe6e43473f0c057cfc1eed8088089">AppLayerExpectationGetFlowId</a>());</div>
<div class="ttc" id="aflow-storage_8c_html_abcfd6c429fcc2dec96d1adf5d3ca162b"><div class="ttname"><a href="flow-storage_8c.html#abcfd6c429fcc2dec96d1adf5d3ca162b">FlowGetStorageById</a></div><div class="ttdeci">void * FlowGetStorageById(Flow *f, FlowStorageId id)</div><div class="ttdef"><b>Definition:</b> <a href="flow-storage_8c_source.html#l00039">flow-storage.c:39</a></div></div>
<div class="ttc" id="agroup__applayerexpectation_html_ga65fbe6e43473f0c057cfc1eed8088089"><div class="ttname"><a href="group__applayerexpectation.html#ga65fbe6e43473f0c057cfc1eed8088089">AppLayerExpectationGetFlowId</a></div><div class="ttdeci">FlowStorageId AppLayerExpectationGetFlowId(void)</div><div class="ttdef"><b>Definition:</b> <a href="app-layer-expectation_8c_source.html#l00288">app-layer-expectation.c:288</a></div></div>
</div><!-- fragment --><p> This storage can be used to store information that are only available in the parent connection and could be useful in the parent connection. For instance this is used by the FTP protocol to propagate information such as file name and ftp operation to the FTP data connection. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gac5fd49196d7c2b98a674f88d4b69a7df" name="gac5fd49196d7c2b98a674f88d4b69a7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5fd49196d7c2b98a674f88d4b69a7df">&#9670;&nbsp;</a></span>EXPECTATION_MAX_LEVEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXPECTATION_MAX_LEVEL&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00071">71</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

</div>
</div>
<a id="gafea41b1fc5c5ffa00b2196647481f4be" name="gafea41b1fc5c5ffa00b2196647481f4be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafea41b1fc5c5ffa00b2196647481f4be">&#9670;&nbsp;</a></span>EXPECTATION_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXPECTATION_TIMEOUT&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00070">70</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga2c868db3a37794fdc55e3155fe7d01f3" name="ga2c868db3a37794fdc55e3155fe7d01f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2c868db3a37794fdc55e3155fe7d01f3">&#9670;&nbsp;</a></span>Expectation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structExpectation__.html">Expectation_</a> <a class="el" href="group__applayerexpectation.html#ga2c868db3a37794fdc55e3155fe7d01f3">Expectation</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gab896b700095597dcc3a8a8e7f593583e" name="gab896b700095597dcc3a8a8e7f593583e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab896b700095597dcc3a8a8e7f593583e">&#9670;&nbsp;</a></span>ExpectationData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structExpectationData__.html">ExpectationData_</a> <a class="el" href="group__applayerexpectation.html#gab896b700095597dcc3a8a8e7f593583e">ExpectationData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gadad28f245e7c36f0b0bace8f50c1ffa9" name="gadad28f245e7c36f0b0bace8f50c1ffa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadad28f245e7c36f0b0bace8f50c1ffa9">&#9670;&nbsp;</a></span>ExpectationList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structExpectationList__.html">ExpectationList_</a> <a class="el" href="group__applayerexpectation.html#gadad28f245e7c36f0b0bace8f50c1ffa9">ExpectationList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga021149ff14858903860941e3486dbe1c" name="ga021149ff14858903860941e3486dbe1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga021149ff14858903860941e3486dbe1c">&#9670;&nbsp;</a></span>AppLayerExpectationClean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AppLayerExpectationClean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00363">363</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

<p class="reference">Referenced by <a class="el" href="flow_8c_source.html#l01087">FlowClearMemory()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__applayerexpectation_ga021149ff14858903860941e3486dbe1c_icgraph.png" border="0" usemap="#agroup__applayerexpectation_ga021149ff14858903860941e3486dbe1c_icgraph" alt=""/></div>
<map name="agroup__applayerexpectation_ga021149ff14858903860941e3486dbe1c_icgraph" id="agroup__applayerexpectation_ga021149ff14858903860941e3486dbe1c_icgraph">
<area shape="rect" title=" " alt="" coords="337,31,517,57"/>
<area shape="rect" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a" title="Function clear the flow memory before queueing it to spare flow queue." alt="" coords="161,31,289,57"/>
<area shape="rect" href="flow_8c.html#adc1589cef09521a8894aed9e365b5f7a" title=" " alt="" coords="17,5,102,32"/>
<area shape="rect" href="flow_8c.html#a8dae51c56800ed0e22279e49913cd15a" title="shutdown the flow engine" alt="" coords="5,56,113,83"/>
</map>
</div>

</div>
</div>
<a id="gaa43a8dbbeeed0b38f565883af74d9f6b" name="gaa43a8dbbeeed0b38f565883af74d9f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa43a8dbbeeed0b38f565883af74d9f6b">&#9670;&nbsp;</a></span>AppLayerExpectationCreate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AppLayerExpectationCreate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aebfc8a43171a8d87a23423fb4725bea4">Port</a>&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aebfc8a43171a8d87a23423fb4725bea4">Port</a>&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td>
          <td class="paramname"><em>alproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Create an entry in expectation list</p>
<p >Create a expectation from an existing Flow. Currently, only Flow between the two original IP addresses are supported. In case of success, the ownership of the data pointer is taken. In case of error, the pointer to data has to be freed by the caller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>a pointer to the original Flow </td></tr>
    <tr><td class="paramname">direction</td><td>the direction of the data in the expectation flow </td></tr>
    <tr><td class="paramname">src</td><td>source port of the expected flow, use 0 for any </td></tr>
    <tr><td class="paramname">dst</td><td>destination port of the expected flow, use 0 for any </td></tr>
    <tr><td class="paramname">alproto</td><td>the protocol that need to be set on the expected flow </td></tr>
    <tr><td class="paramname">data</td><td>pointer to data that will be attached to the expected flow</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 if error </dd>
<dd>
0 if success </dd></dl>

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00219">219</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer-expectation_8c_source.html#l00077">Expectation_::alproto</a>, <a class="el" href="app-layer-expectation_8c_source.html#l00081">Expectation_::data</a>, <a class="el" href="app-layer-expectation_8c_source.html#l00078">Expectation_::direction</a>, <a class="el" href="app-layer-expectation_8c_source.html#l00076">Expectation_::dp</a>, <a class="el" href="app-layer-dnp3_8h_source.html#l00004">dst</a>, <a class="el" href="flow_8h_source.html#l00414">Flow_::lastts</a>, <a class="el" href="app-layer-expectation_8c_source.html#l00080">Expectation_::orig_f</a>, <a class="el" href="util-mem_8h_source.html#l00053">SCCalloc</a>, <a class="el" href="app-layer-expectation_8c_source.html#l00075">Expectation_::sp</a>, <a class="el" href="app-layer-dnp3_8h_source.html#l00005">src</a>, and <a class="el" href="app-layer-expectation_8c_source.html#l00074">Expectation_::ts</a>.</p>

</div>
</div>
<a id="ga65fbe6e43473f0c057cfc1eed8088089" name="ga65fbe6e43473f0c057cfc1eed8088089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga65fbe6e43473f0c057cfc1eed8088089">&#9670;&nbsp;</a></span>AppLayerExpectationGetFlowId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFlowStorageId.html">FlowStorageId</a> AppLayerExpectationGetFlowId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Return Flow storage identifier corresponding to expectation data</p>
<dl class="section return"><dt>Returns</dt><dd>expectation data identifier </dd></dl>

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00288">288</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

</div>
</div>
<a id="ga1d9613cfc2c836daaab126445acaf3a5" name="ga1d9613cfc2c836daaab126445acaf3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d9613cfc2c836daaab126445acaf3a5">&#9670;&nbsp;</a></span>AppLayerExpectationHandle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> AppLayerExpectationHandle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Function doing a lookup in expectation list and updating Flow if needed.</p>
<p >This function lookup for a existing expectation that could match the Flow. If found and if the expectation contains data it store the data in the expectation storage of the Flow.</p>
<dl class="section return"><dt>Returns</dt><dd>an AppProto value if found </dd>
<dd>
ALPROTO_UNKNOWN if not found </dd></dl>

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00303">303</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

<p class="reference">References <a class="el" href="app-layer-protos_8h_source.html#l00029">ALPROTO_UNKNOWN</a>, and <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a id="ga9a6b6f83e48ff3a196b078531034f895" name="ga9a6b6f83e48ff3a196b078531034f895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a6b6f83e48ff3a196b078531034f895">&#9670;&nbsp;</a></span>AppLayerExpectationSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AppLayerExpectationSetup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00146">146</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

</div>
</div>
<a id="ga58b62836a5fee74b44bbc864ce144e28" name="ga58b62836a5fee74b44bbc864ce144e28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga58b62836a5fee74b44bbc864ce144e28">&#9670;&nbsp;</a></span>ExpectationGetCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t ExpectationGetCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="app-layer-expectation_8c_source.html#l00140">140</a> of file <a class="el" href="app-layer-expectation_8c_source.html">app-layer-expectation.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer_8c_source.html#l01034">AppLayerRegisterGlobalCounters()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__applayerexpectation_ga58b62836a5fee74b44bbc864ce144e28_icgraph.png" border="0" usemap="#agroup__applayerexpectation_ga58b62836a5fee74b44bbc864ce144e28_icgraph" alt=""/></div>
<map name="agroup__applayerexpectation_ga58b62836a5fee74b44bbc864ce144e28_icgraph" id="agroup__applayerexpectation_ga58b62836a5fee74b44bbc864ce144e28_icgraph">
<area shape="rect" title=" " alt="" coords="401,5,560,32"/>
<area shape="rect" href="app-layer_8c.html#a3377beeacc15bacc2a730feadfb6a1ee" title="HACK to work around our broken unix manager (re)init loop." alt="" coords="137,5,353,32"/>
<area shape="rect" href="suricata_8c.html#a24ef7c82defde542c35c3c27e3c41106" title=" " alt="" coords="5,5,89,32"/>
</map>
</div>

</div>
</div>
<a id="gac264e37e2a2b7313b33114053c6d9914" name="gac264e37e2a2b7313b33114053c6d9914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac264e37e2a2b7313b33114053c6d9914">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expectation_count&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:25 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
