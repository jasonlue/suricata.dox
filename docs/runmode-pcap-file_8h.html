<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/runmode-pcap-file.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('runmode-pcap-file_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">runmode-pcap-file.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h__dep__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2runmode-pcap-file_8hdep" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2runmode-pcap-file_8hdep" id="a_2Users_2jlu_2suricata_2src_2runmode-pcap-file_8hdep">
<area shape="rect" title=" " alt="" coords="201,5,364,47"/>
<area shape="rect" href="runmode-pcap-file_8c.html" title=" " alt="" coords="5,95,168,136"/>
<area shape="rect" href="runmode-unix-socket_8c.html" title=" " alt="" coords="193,95,373,136"/>
<area shape="rect" href="runmodes_8c.html" title=" " alt="" coords="397,95,525,136"/>
</map>
</div>
</div>
<p><a href="runmode-pcap-file_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0b2361b53d1001da4064cac92706a590"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590">RunModeFilePcapSingle</a> (void)</td></tr>
<tr class="memdesc:a0b2361b53d1001da4064cac92706a590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single thread version of the Pcap file processing.  <a href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590">More...</a><br /></td></tr>
<tr class="separator:a0b2361b53d1001da4064cac92706a590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b3fac464c73a6e2f8bfd8175a9dbc96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96">RunModeFilePcapAutoFp</a> (void)</td></tr>
<tr class="memdesc:a8b3fac464c73a6e2f8bfd8175a9dbc96"><td class="mdescLeft">&#160;</td><td class="mdescRight">RunModeFilePcapAutoFp set up the following thread packet handlers:  <a href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96">More...</a><br /></td></tr>
<tr class="separator:a8b3fac464c73a6e2f8bfd8175a9dbc96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d7c8cc1a9e09f97cb2fa18dfb6c554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554">RunModeFilePcapRegister</a> (void)</td></tr>
<tr class="separator:ac0d7c8cc1a9e09f97cb2fa18dfb6c554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783987cab1a410c13a71f1cdaeefb9a9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-pcap-file_8h.html#a783987cab1a410c13a71f1cdaeefb9a9">RunModeFilePcapGetDefaultMode</a> (void)</td></tr>
<tr class="separator:a783987cab1a410c13a71f1cdaeefb9a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="runmode-pcap-file_8h_source.html">runmode-pcap-file.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8b3fac464c73a6e2f8bfd8175a9dbc96" name="a8b3fac464c73a6e2f8bfd8175a9dbc96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b3fac464c73a6e2f8bfd8175a9dbc96">&#9670;&nbsp;</a></span>RunModeFilePcapAutoFp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunModeFilePcapAutoFp </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RunModeFilePcapAutoFp set up the following thread packet handlers: </p>
<ul>
<li>Receive thread (from pcap file)</li>
<li>Decode thread</li>
<li>Stream thread</li>
<li>Detect: If we have only 1 cpu, it will setup one Detect thread If we have more than one, it will setup num_cpus - 1 starting from the second cpu available.</li>
<li>Outputs thread By default the threads will use the first cpu available except the Detection threads if we have more than one cpu.</li>
</ul>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>If all goes well. (If any problem is detected the engine will exit()). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="runmode-pcap-file_8c_source.html#l00125">125</a> of file <a class="el" href="runmode-pcap-file_8c_source.html">runmode-pcap-file.c</a>.</p>

<p class="reference">References <a class="el" href="conf_8c_source.html#l00330">ConfGet()</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="source-pcap-file_8c_source.html#l00138">PcapFileGlobalInit()</a>, <a class="el" href="util-affinity_8h_source.html#l00051">RECEIVE_CPU_SET</a>, <a class="el" href="util-runmodes_8c_source.html#l00056">RunmodeAutoFpCreatePickupQueuesString()</a>, <a class="el" href="runmodes_8c_source.html#l00946">RunModeInitialize()</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="runmodes_8c_source.html#l00078">thread_name_autofp</a>, <a class="el" href="runmodes_8c_source.html#l00080">thread_name_workers</a>, <a class="el" href="runmodes_8c_source.html#l00941">threading_detect_ratio</a>, <a class="el" href="util-time_8c_source.html#l00105">TimeModeSetOffline()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00082">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8h_source.html#l00047">TM_QUEUE_NAME_MAX</a>, <a class="el" href="tm-threads_8h_source.html#l00048">TM_THREAD_NAME_MAX</a>, <a class="el" href="tm-modules_8c_source.html#l00053">TmModuleGetByName()</a>, <a class="el" href="tm-threads_8c_source.html#l00629">TmSlotSetFuncAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01022">TmThreadCreatePacketHandler()</a>, <a class="el" href="tm-threads_8c_source.html#l00817">TmThreadGetNbThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l00801">TmThreadSetCPU()</a>, <a class="el" href="tm-threads_8c_source.html#l01593">TmThreadSetGroupName()</a>, <a class="el" href="tm-threads_8c_source.html#l01636">TmThreadSpawn()</a>, <a class="el" href="util-cpu_8c_source.html#l00106">UtilCpuGetNumProcessorsOnline()</a>, and <a class="el" href="util-affinity_8h_source.html#l00052">WORKER_CPU_SET</a>.</p>

<p class="reference">Referenced by <a class="el" href="runmode-pcap-file_8c_source.html#l00040">RunModeFilePcapRegister()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_cgraph.png" border="0" usemap="#arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_cgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_cgraph" id="arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_cgraph">
<area shape="rect" title="RunModeFilePcapAutoFp set up the following thread packet handlers:" alt="" coords="5,416,176,442"/>
<area shape="rect" href="conf_8c.html#ab7638a53fd00da93228a4769b1efd635" title="Retrieve the value of a configuration node." alt="" coords="853,70,923,97"/>
<area shape="rect" href="source-pcap-file_8c.html#af429c087ae37e17b1ff3a8cf63304280" title=" " alt="" coords="269,197,397,224"/>
<area shape="rect" href="util-runmodes_8c.html#a729fdaf3113808720622a99c2361616c" title="create a queue string for autofp to pass to the flow queue handler." alt="" coords="234,248,433,290"/>
<area shape="rect" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title=" " alt="" coords="270,146,397,173"/>
<area shape="rect" href="util-time_8c.html#ae13be7166791afc9e813cb3b79f324b6" title=" " alt="" coords="263,314,404,341"/>
<area shape="rect" href="tm-modules_8c.html#ae4139ae4d609778d39e4fd9c81b2c245" title="get a tm module ptr by name" alt="" coords="256,365,411,392"/>
<area shape="rect" href="tm-threads_8c.html#a00a433c086150c236db46ec9b5fc5837" title="Appends a new entry to the slots." alt="" coords="255,416,412,442"/>
<area shape="rect" href="tm-threads_8c.html#a7d829b790837656fb0bec6686da0b510" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="230,466,437,493"/>
<area shape="rect" href="tm-threads_8c.html#a6121f124848a0f3961e4eee3faf34f8e" title=" " alt="" coords="250,517,417,544"/>
<area shape="rect" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title=" " alt="" coords="268,568,399,594"/>
<area shape="rect" href="tm-threads_8c.html#a753ea8d617a0f8065b758cfe861651ce" title=" " alt="" coords="248,618,419,645"/>
<area shape="rect" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv." alt="" coords="273,669,394,696"/>
<area shape="rect" href="util-cpu_8c.html#aee62df6f39aaf4f1ab8b11d30fa21ceb" title="Get the number of cpus online in the system." alt="" coords="224,720,443,746"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="1073,121,1175,148"/>
<area shape="rect" href="util-strlcatu_8c.html#ae85b825a7f3d4dcf136b85949b646a46" title=" " alt="" coords="583,324,642,350"/>
<area shape="rect" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file." alt="" coords="516,222,709,249"/>
<area shape="rect" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen." alt="" coords="564,121,661,148"/>
<area shape="rect" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float." alt="" coords="563,70,663,97"/>
<area shape="rect" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title=" " alt="" coords="543,273,683,300"/>
<area shape="rect" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true." alt="" coords="835,121,941,148"/>
<area shape="rect" href="tm-modules_8c.html#a7f664acae02a48d8ab795b31342dbe66" title="Given a TM Module, returns its id." alt="" coords="535,416,691,442"/>
<area shape="rect" href="tm-threads_8c.html#a21dbddfb0521108eadc00b1c373fd810" title="Creates and returns the TV instance for a new thread." alt="" coords="553,466,673,493"/>
<area shape="rect" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title=" " alt="" coords="524,517,701,544"/>
<area shape="rect" href="util-strlcpyu_8c.html#aeb79f86261de904967d433c1b5e9a1de" title=" " alt="" coords="857,340,919,366"/>
<area shape="rect" href="tm-queues_8h.html#aef44f00633d8e498fe5c5e16daa080f6" title=" " alt="" coords="825,390,951,417"/>
<area shape="rect" href="tm-queues_8c.html#a781aacb28cf50e56fd15d3d9d28d0ca4" title=" " alt="" coords="809,441,967,468"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a320f5542cd7498d81fbbb64ffb8a456e" title=" " alt="" coords="783,492,993,518"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a3888f42aa21dba966a4188b3d0fc6b17" title=" " alt="" coords="829,542,947,569"/>
<area shape="rect" href="tm-threads_8c.html#ac649a1302aa9a4b8b6ed556652ca4ee5" title="Set a thread flag." alt="" coords="821,593,955,620"/>
<area shape="rect" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type." alt="" coords="550,618,675,645"/>
<area shape="rect" href="tm-threads_8c.html#a98f30f9d0a9a79a9beac2cb41a8c4b5f" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="537,669,688,696"/>
<area shape="rect" href="tm-threads_8c.html#a19cda3747ef965db45d79aae89dd1055" title="Check if a thread flag is set." alt="" coords="813,669,963,696"/>
<area shape="rect" href="util-cpu_8c.html#a221f26561dac4f5906f4905e03dbb8b0" title="Get the number of cpus configured in the system." alt="" coords="491,720,735,746"/>
<area shape="rect" href="util-byte_8c.html#ab3eb38e8028bcd1b80158b2e71416ff6" title=" " alt="" coords="829,720,947,746"/>
<area shape="rect" href="util-byte_8c.html#adb391c0982a92fbd85eaef2bbe35f140" title=" " alt="" coords="1041,720,1207,746"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_icgraph.png" border="0" usemap="#arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_icgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_icgraph" id="arunmode-pcap-file_8h_a8b3fac464c73a6e2f8bfd8175a9dbc96_icgraph">
<area shape="rect" title="RunModeFilePcapAutoFp set up the following thread packet handlers:" alt="" coords="232,5,403,32"/>
<area shape="rect" href="runmode-pcap-file_8c.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title=" " alt="" coords="5,5,184,32"/>
</map>
</div>

</div>
</div>
<a id="a783987cab1a410c13a71f1cdaeefb9a9" name="a783987cab1a410c13a71f1cdaeefb9a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783987cab1a410c13a71f1cdaeefb9a9">&#9670;&nbsp;</a></span>RunModeFilePcapGetDefaultMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * RunModeFilePcapGetDefaultMode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="runmode-pcap-file_8c_source.html#l00035">35</a> of file <a class="el" href="runmode-pcap-file_8c_source.html">runmode-pcap-file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="runmodes_8c_source.html#l00305">RunModeDispatch()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_a783987cab1a410c13a71f1cdaeefb9a9_icgraph.png" border="0" usemap="#arunmode-pcap-file_8h_a783987cab1a410c13a71f1cdaeefb9a9_icgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_a783987cab1a410c13a71f1cdaeefb9a9_icgraph" id="arunmode-pcap-file_8h_a783987cab1a410c13a71f1cdaeefb9a9_icgraph">
<area shape="rect" title=" " alt="" coords="184,5,408,32"/>
<area shape="rect" href="runmodes_8c.html#a30bbbc1fa39a07f8836632d131db9e98" title=" " alt="" coords="5,5,136,32"/>
</map>
</div>

</div>
</div>
<a id="ac0d7c8cc1a9e09f97cb2fa18dfb6c554" name="ac0d7c8cc1a9e09f97cb2fa18dfb6c554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0d7c8cc1a9e09f97cb2fa18dfb6c554">&#9670;&nbsp;</a></span>RunModeFilePcapRegister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RunModeFilePcapRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="runmode-pcap-file_8c_source.html#l00040">40</a> of file <a class="el" href="runmode-pcap-file_8c_source.html">runmode-pcap-file.c</a>.</p>

<p class="reference">References <a class="el" href="runmodes_8h_source.html#l00030">RUNMODE_PCAP_FILE</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00125">RunModeFilePcapAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00059">RunModeFilePcapSingle()</a>, and <a class="el" href="runmodes_8c_source.html#l00460">RunModeRegisterNewRunMode()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_ac0d7c8cc1a9e09f97cb2fa18dfb6c554_cgraph.png" border="0" usemap="#arunmode-pcap-file_8h_ac0d7c8cc1a9e09f97cb2fa18dfb6c554_cgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_ac0d7c8cc1a9e09f97cb2fa18dfb6c554_cgraph" id="arunmode-pcap-file_8h_ac0d7c8cc1a9e09f97cb2fa18dfb6c554_cgraph">
<area shape="rect" title=" " alt="" coords="5,588,184,615"/>
<area shape="rect" href="runmode-pcap-file_8c.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers:" alt="" coords="252,588,423,615"/>
<area shape="rect" href="runmode-pcap-file_8c.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing." alt="" coords="255,487,420,513"/>
<area shape="rect" href="runmodes_8c.html#a90375222b88cb5950c887519d028e498" title="Registers a new runmode." alt="" coords="232,639,443,665"/>
<area shape="rect" href="conf_8c.html#ab7638a53fd00da93228a4769b1efd635" title="Retrieve the value of a configuration node." alt="" coords="1119,588,1190,615"/>
<area shape="rect" href="source-pcap-file_8c.html#af429c087ae37e17b1ff3a8cf63304280" title=" " alt="" coords="536,512,664,539"/>
<area shape="rect" href="util-runmodes_8c.html#a729fdaf3113808720622a99c2361616c" title="create a queue string for autofp to pass to the flow queue handler." alt="" coords="501,817,699,858"/>
<area shape="rect" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title=" " alt="" coords="537,563,663,589"/>
<area shape="rect" href="util-time_8c.html#ae13be7166791afc9e813cb3b79f324b6" title=" " alt="" coords="529,613,671,640"/>
<area shape="rect" href="tm-modules_8c.html#ae4139ae4d609778d39e4fd9c81b2c245" title="get a tm module ptr by name" alt="" coords="523,664,677,691"/>
<area shape="rect" href="tm-threads_8c.html#a00a433c086150c236db46ec9b5fc5837" title="Appends a new entry to the slots." alt="" coords="521,309,679,336"/>
<area shape="rect" href="tm-threads_8c.html#a7d829b790837656fb0bec6686da0b510" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="497,233,703,260"/>
<area shape="rect" href="tm-threads_8c.html#a6121f124848a0f3961e4eee3faf34f8e" title=" " alt="" coords="517,883,683,909"/>
<area shape="rect" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title=" " alt="" coords="535,461,665,488"/>
<area shape="rect" href="tm-threads_8c.html#a753ea8d617a0f8065b758cfe861651ce" title=" " alt="" coords="515,933,685,960"/>
<area shape="rect" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv." alt="" coords="539,360,661,387"/>
<area shape="rect" href="util-cpu_8c.html#aee62df6f39aaf4f1ab8b11d30fa21ceb" title="Get the number of cpus online in the system." alt="" coords="491,765,709,792"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="1339,715,1442,741"/>
<area shape="rect" href="util-strlcatu_8c.html#ae85b825a7f3d4dcf136b85949b646a46" title=" " alt="" coords="850,867,909,893"/>
<area shape="rect" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file." alt="" coords="783,563,976,589"/>
<area shape="rect" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen." alt="" coords="831,461,928,488"/>
<area shape="rect" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float." alt="" coords="829,664,929,691"/>
<area shape="rect" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title=" " alt="" coords="809,613,949,640"/>
<area shape="rect" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true." alt="" coords="1102,461,1207,488"/>
<area shape="rect" href="tm-modules_8c.html#a7f664acae02a48d8ab795b31342dbe66" title="Given a TM Module, returns its id." alt="" coords="801,259,957,285"/>
<area shape="rect" href="tm-threads_8c.html#a21dbddfb0521108eadc00b1c373fd810" title="Creates and returns the TV instance for a new thread." alt="" coords="819,157,939,184"/>
<area shape="rect" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title=" " alt="" coords="791,208,968,235"/>
<area shape="rect" href="util-strlcpyu_8c.html#aeb79f86261de904967d433c1b5e9a1de" title=" " alt="" coords="1124,259,1185,285"/>
<area shape="rect" href="tm-queues_8h.html#aef44f00633d8e498fe5c5e16daa080f6" title=" " alt="" coords="1092,5,1217,32"/>
<area shape="rect" href="tm-queues_8c.html#a781aacb28cf50e56fd15d3d9d28d0ca4" title=" " alt="" coords="1075,56,1234,83"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a320f5542cd7498d81fbbb64ffb8a456e" title=" " alt="" coords="1049,107,1260,133"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a3888f42aa21dba966a4188b3d0fc6b17" title=" " alt="" coords="1095,157,1214,184"/>
<area shape="rect" href="tm-threads_8c.html#ac649a1302aa9a4b8b6ed556652ca4ee5" title="Set a thread flag." alt="" coords="1088,208,1221,235"/>
<area shape="rect" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type." alt="" coords="817,360,942,387"/>
<area shape="rect" href="tm-threads_8c.html#a98f30f9d0a9a79a9beac2cb41a8c4b5f" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="804,309,955,336"/>
<area shape="rect" href="tm-threads_8c.html#a19cda3747ef965db45d79aae89dd1055" title="Check if a thread flag is set." alt="" coords="1079,309,1230,336"/>
<area shape="rect" href="util-cpu_8c.html#a221f26561dac4f5906f4905e03dbb8b0" title="Get the number of cpus configured in the system." alt="" coords="757,816,1001,843"/>
<area shape="rect" href="util-byte_8c.html#ab3eb38e8028bcd1b80158b2e71416ff6" title=" " alt="" coords="1095,816,1214,843"/>
<area shape="rect" href="util-byte_8c.html#adb391c0982a92fbd85eaef2bbe35f140" title=" " alt="" coords="1308,816,1473,843"/>
</map>
</div>

</div>
</div>
<a id="a0b2361b53d1001da4064cac92706a590" name="a0b2361b53d1001da4064cac92706a590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2361b53d1001da4064cac92706a590">&#9670;&nbsp;</a></span>RunModeFilePcapSingle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunModeFilePcapSingle </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single thread version of the Pcap file processing. </p>

<p class="definition">Definition at line <a class="el" href="runmode-pcap-file_8c_source.html#l00059">59</a> of file <a class="el" href="runmode-pcap-file_8c_source.html">runmode-pcap-file.c</a>.</p>

<p class="reference">References <a class="el" href="conf_8c_source.html#l00330">ConfGet()</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="source-pcap-file_8c_source.html#l00138">PcapFileGlobalInit()</a>, <a class="el" href="runmodes_8c_source.html#l00946">RunModeInitialize()</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="runmodes_8c_source.html#l00079">thread_name_single</a>, <a class="el" href="util-time_8c_source.html#l00105">TimeModeSetOffline()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00082">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8h_source.html#l00048">TM_THREAD_NAME_MAX</a>, <a class="el" href="tm-modules_8c_source.html#l00053">TmModuleGetByName()</a>, <a class="el" href="tm-threads_8c_source.html#l00629">TmSlotSetFuncAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01022">TmThreadCreatePacketHandler()</a>, <a class="el" href="tm-threads_8c_source.html#l00801">TmThreadSetCPU()</a>, <a class="el" href="tm-threads_8c_source.html#l01636">TmThreadSpawn()</a>, <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>, and <a class="el" href="util-affinity_8h_source.html#l00052">WORKER_CPU_SET</a>.</p>

<p class="reference">Referenced by <a class="el" href="runmode-pcap-file_8c_source.html#l00040">RunModeFilePcapRegister()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_cgraph.png" border="0" usemap="#arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_cgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_cgraph" id="arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_cgraph">
<area shape="rect" title="Single thread version of the Pcap file processing." alt="" coords="5,254,171,280"/>
<area shape="rect" href="conf_8c.html#ab7638a53fd00da93228a4769b1efd635" title="Retrieve the value of a configuration node." alt="" coords="785,51,855,78"/>
<area shape="rect" href="source-pcap-file_8c.html#af429c087ae37e17b1ff3a8cf63304280" title=" " alt="" coords="258,152,386,179"/>
<area shape="rect" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title=" " alt="" coords="259,102,385,128"/>
<area shape="rect" href="util-time_8c.html#ae13be7166791afc9e813cb3b79f324b6" title=" " alt="" coords="251,203,393,230"/>
<area shape="rect" href="tm-modules_8c.html#ae4139ae4d609778d39e4fd9c81b2c245" title="get a tm module ptr by name" alt="" coords="245,254,399,280"/>
<area shape="rect" href="tm-threads_8c.html#a00a433c086150c236db46ec9b5fc5837" title="Appends a new entry to the slots." alt="" coords="243,304,401,331"/>
<area shape="rect" href="tm-threads_8c.html#a7d829b790837656fb0bec6686da0b510" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="219,355,425,382"/>
<area shape="rect" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title=" " alt="" coords="257,406,387,432"/>
<area shape="rect" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv." alt="" coords="261,456,383,483"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="973,102,1076,128"/>
<area shape="rect" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file." alt="" coords="473,203,667,230"/>
<area shape="rect" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen." alt="" coords="521,102,619,128"/>
<area shape="rect" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float." alt="" coords="520,51,620,78"/>
<area shape="rect" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title=" " alt="" coords="500,254,640,280"/>
<area shape="rect" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true." alt="" coords="767,102,873,128"/>
<area shape="rect" href="tm-modules_8c.html#a7f664acae02a48d8ab795b31342dbe66" title="Given a TM Module, returns its id." alt="" coords="492,304,648,331"/>
<area shape="rect" href="tm-threads_8c.html#a21dbddfb0521108eadc00b1c373fd810" title="Creates and returns the TV instance for a new thread." alt="" coords="510,355,630,382"/>
<area shape="rect" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title=" " alt="" coords="481,406,659,432"/>
<area shape="rect" href="util-strlcpyu_8c.html#aeb79f86261de904967d433c1b5e9a1de" title=" " alt="" coords="789,203,851,230"/>
<area shape="rect" href="tm-queues_8h.html#aef44f00633d8e498fe5c5e16daa080f6" title=" " alt="" coords="757,254,883,280"/>
<area shape="rect" href="tm-queues_8c.html#a781aacb28cf50e56fd15d3d9d28d0ca4" title=" " alt="" coords="741,304,899,331"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a320f5542cd7498d81fbbb64ffb8a456e" title=" " alt="" coords="715,355,925,382"/>
<area shape="rect" href="tm-queuehandlers_8c.html#a3888f42aa21dba966a4188b3d0fc6b17" title=" " alt="" coords="761,406,879,432"/>
<area shape="rect" href="tm-threads_8c.html#ac649a1302aa9a4b8b6ed556652ca4ee5" title="Set a thread flag." alt="" coords="753,456,887,483"/>
<area shape="rect" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type." alt="" coords="507,456,633,483"/>
<area shape="rect" href="tm-threads_8c.html#a98f30f9d0a9a79a9beac2cb41a8c4b5f" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="495,507,645,534"/>
<area shape="rect" href="tm-threads_8c.html#a19cda3747ef965db45d79aae89dd1055" title="Check if a thread flag is set." alt="" coords="745,507,895,534"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_icgraph.png" border="0" usemap="#arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_icgraph" alt=""/></div>
<map name="arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_icgraph" id="arunmode-pcap-file_8h_a0b2361b53d1001da4064cac92706a590_icgraph">
<area shape="rect" title="Single thread version of the Pcap file processing." alt="" coords="232,5,397,32"/>
<area shape="rect" href="runmode-pcap-file_8c.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title=" " alt="" coords="5,5,184,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="runmode-pcap-file_8h.html">runmode-pcap-file.h</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:24 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
