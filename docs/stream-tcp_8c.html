<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: /Users/jlu/suricata/src/stream-tcp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('stream-tcp_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">stream-tcp.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="conf-yaml-loader_8h_source.html">conf-yaml-loader.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-pool_8h_source.html">util-pool.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-pool-thread_8h_source.html">util-pool-thread.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-checksum_8h_source.html">util-checksum.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-print_8h_source.html">util-print.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-device_8h_source.html">util-device.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-inline_8h_source.html">stream-tcp-inline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-sack_8h_source.html">stream-tcp-sack.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream-tcp-util_8h_source.html">stream-tcp-util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pkt-var_8h_source.html">pkt-var.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="host_8h_source.html">host.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer_8h_source.html">app-layer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-protos_8h_source.html">app-layer-protos.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="app-layer-htp-mem_8h_source.html">app-layer-htp-mem.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-host-os-info_8h_source.html">util-host-os-info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-misc_8h_source.html">util-misc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-validate_8h_source.html">util-validate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-runmodes_8h_source.html">util-runmodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-random_8h_source.html">util-random.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-exception-policy_8h_source.html">util-exception-policy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="source-pcap-file_8h_source.html">source-pcap-file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tests_2stream-tcp_8c_source.html">tests/stream-tcp.c</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp.c:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c__incl.png" border="0" usemap="#a_2Users_2jlu_2suricata_2src_2stream-tcp_8c" alt=""/></div>
<map name="a_2Users_2jlu_2suricata_2src_2stream-tcp_8c" id="a_2Users_2jlu_2suricata_2src_2stream-tcp_8c">
<area shape="rect" title=" " alt="" coords="1619,5,1747,47"/>
<area shape="rect" href="suricata-common_8h.html" title=" " alt="" coords="1647,393,1780,420"/>
<area shape="rect" href="threads_8h.html" title=" " alt="" coords="1354,543,1430,569"/>
<area shape="rect" href="util-debug_8h.html" title=" " alt="" coords="1347,468,1437,495"/>
<area shape="rect" href="suricata_8h.html" title=" " alt="" coords="839,319,918,345"/>
<area shape="rect" href="decode_8h.html" title=" " alt="" coords="1672,244,1747,271"/>
<area shape="rect" href="threadvars_8h.html" title=" " alt="" coords="1477,319,1571,345"/>
<area shape="rect" href="app-layer-protos_8h.html" title=" " alt="" coords="1798,319,1925,345"/>
<area shape="rect" href="detect_8h.html" title=" " alt="" coords="1965,95,2035,121"/>
<area shape="rect" href="flow_8h.html" title=" " alt="" coords="1915,169,1970,196"/>
<area shape="rect" href="util-exception-policy_8h.html" title=" " alt="" coords="1984,244,2131,271"/>
<area shape="rect" href="flow-util_8h.html" title=" " alt="" coords="226,244,305,271"/>
<area shape="rect" href="stream-tcp-private_8h.html" title=" " alt="" coords="473,319,612,345"/>
<area shape="rect" href="util-pool-thread_8h.html" title=" " alt="" coords="43,393,162,420"/>
<area shape="rect" href="util-pool_8h.html" title=" " alt="" coords="15,468,94,495"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="1011,95,1069,121"/>
<area shape="rect" href="conf-yaml-loader_8h.html" title=" " alt="" coords="1093,95,1221,121"/>
<area shape="rect" href="tm-threads_8h.html" title=" " alt="" coords="3263,393,3358,420"/>
<area shape="rect" href="util-checksum_8h.html" title=" " alt="" coords="1296,95,1411,121"/>
<area shape="rect" href="util-unittest_8h.html" title=" " alt="" coords="945,169,1042,196"/>
<area shape="rect" href="util-print_8h.html" title=" " alt="" coords="1066,169,1145,196"/>
<area shape="rect" href="util-device_8h.html" title=" " alt="" coords="1595,95,1687,121"/>
<area shape="rect" href="stream-tcp-reassemble_8h.html" title=" " alt="" coords="773,244,939,271"/>
<area shape="rect" href="stream-tcp_8h.html" title=" " alt="" coords="533,169,627,196"/>
<area shape="rect" href="stream_8h.html" title=" " alt="" coords="469,244,542,271"/>
<area shape="rect" href="stream-tcp-inline_8h.html" title=" " alt="" coords="327,169,457,196"/>
<area shape="rect" href="stream-tcp-sack_8h.html" title=" " alt="" coords="2206,319,2333,345"/>
<area shape="rect" href="stream-tcp-util_8h.html" title=" " alt="" coords="651,169,767,196"/>
<area shape="rect" href="pkt-var_8h.html" title=" " alt="" coords="2059,95,2131,121"/>
<area shape="rect" href="host_8h.html" title=" " alt="" coords="1680,169,1739,196"/>
<area shape="rect" href="app-layer_8h.html" title=" " alt="" coords="1485,95,1571,121"/>
<area shape="rect" href="app-layer-parser_8h.html" title=" " alt="" coords="2256,95,2381,121"/>
<area shape="rect" href="app-layer-htp-mem_8h.html" title=" " alt="" coords="2405,95,2547,121"/>
<area shape="rect" href="util-host-os-info_8h.html" title=" " alt="" coords="2571,95,2693,121"/>
<area shape="rect" href="util-privs_8h.html" title=" " alt="" coords="2717,95,2800,121"/>
<area shape="rect" href="util-profiling_8h.html" title=" " alt="" coords="2824,95,2923,121"/>
<area shape="rect" href="util-misc_8h.html" title=" " alt="" coords="2947,95,3029,121"/>
<area shape="rect" href="util-validate_8h.html" title=" " alt="" coords="3053,95,3152,121"/>
<area shape="rect" href="util-runmodes_8h.html" title=" " alt="" coords="3177,95,3287,121"/>
<area shape="rect" href="util-random_8h.html" title=" " alt="" coords="3311,95,3409,121"/>
<area shape="rect" href="util-time_8h.html" title=" " alt="" coords="3433,95,3511,121"/>
<area shape="rect" href="source-pcap-file_8h.html" title=" " alt="" coords="3536,95,3661,121"/>
<area shape="rect" href="tests_2stream-tcp_8c.html" title=" " alt="" coords="656,95,784,121"/>
<area shape="rect" title=" " alt="" coords="1751,468,1817,495"/>
<area shape="rect" title=" " alt="" coords="1841,468,1919,495"/>
<area shape="rect" title=" " alt="" coords="1513,468,1578,495"/>
<area shape="rect" href="util-optimize_8h.html" title=" " alt="" coords="1943,468,2046,495"/>
<area shape="rect" title=" " alt="" coords="1602,468,1675,495"/>
<area shape="rect" href="tm-threads-common_8h.html" title=" " alt="" coords="2849,468,2999,495"/>
<area shape="rect" href="util-error_8h.html" title=" " alt="" coords="1563,543,1642,569"/>
</map>
</div>
</div>
<p><a href="stream-tcp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a704dec4e8267ebbea46b9622538c0a02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a704dec4e8267ebbea46b9622538c0a02">STREAMTCP_DEFAULT_PREALLOC</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a704dec4e8267ebbea46b9622538c0a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe999ee6a99cea5b5b795e5e653c7dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#adbe999ee6a99cea5b5b795e5e653c7dc">STREAMTCP_DEFAULT_MEMCAP</a>&#160;&#160;&#160;(64 * 1024 * 1024)  /* 64mb */</td></tr>
<tr class="separator:adbe999ee6a99cea5b5b795e5e653c7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5dea44b5b98768801ad5c7d7b63ba0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a1b5dea44b5b98768801ad5c7d7b63ba0">STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</a>&#160;&#160;&#160;(256 * 1024 * 1024) /* 256mb */</td></tr>
<tr class="separator:a1b5dea44b5b98768801ad5c7d7b63ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b628d585930d0abedf1bb1a3a44a3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a62b628d585930d0abedf1bb1a3a44a3e">STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</a>&#160;&#160;&#160;2560</td></tr>
<tr class="separator:a62b628d585930d0abedf1bb1a3a44a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ff119dd23fb1ae0d1d087b9a1ffd16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a67ff119dd23fb1ae0d1d087b9a1ffd16">STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE</a>&#160;&#160;&#160;2560</td></tr>
<tr class="separator:a67ff119dd23fb1ae0d1d087b9a1ffd16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3328d83ed3060e38ad76f657d0beac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a6b3328d83ed3060e38ad76f657d0beac">STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a6b3328d83ed3060e38ad76f657d0beac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a387f8eba48e884ee147c39fcd084e4f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a387f8eba48e884ee147c39fcd084e4f1">StreamTcpUpdateLastAck</a>(ssn,  stream,  ack)</td></tr>
<tr class="memdesc:a387f8eba48e884ee147c39fcd084e4f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to update last_ack only if the new value is higher  <a href="stream-tcp_8c.html#a387f8eba48e884ee147c39fcd084e4f1">More...</a><br /></td></tr>
<tr class="separator:a387f8eba48e884ee147c39fcd084e4f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66cc28d1694e768ad78418f4e5e47f42"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a66cc28d1694e768ad78418f4e5e47f42">StreamTcpAsyncLastAckUpdate</a>(ssn,  stream)</td></tr>
<tr class="separator:a66cc28d1694e768ad78418f4e5e47f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada021cbe10c9d26d66dd9671b5d52d0e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ada021cbe10c9d26d66dd9671b5d52d0e">StreamTcpUpdateNextSeq</a>(ssn,  stream,  <a class="el" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>)</td></tr>
<tr class="separator:ada021cbe10c9d26d66dd9671b5d52d0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e34441870e907cb9fc3a879882e9908"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0e34441870e907cb9fc3a879882e9908">StreamTcpUpdateNextWin</a>(ssn,  stream,  win)</td></tr>
<tr class="memdesc:a0e34441870e907cb9fc3a879882e9908"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to update next_win only if the new value is higher  <a href="stream-tcp_8c.html#a0e34441870e907cb9fc3a879882e9908">More...</a><br /></td></tr>
<tr class="separator:a0e34441870e907cb9fc3a879882e9908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf7d2fd0cd1bbbb032d9fa2d5650b87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a9cf7d2fd0cd1bbbb032d9fa2d5650b87">PSEUDO_PKT_SET_IPV4HDR</a>(nipv4h,  ipv4h)</td></tr>
<tr class="separator:a9cf7d2fd0cd1bbbb032d9fa2d5650b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ea8445a808ecb6ad08512a02f78a74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aa0ea8445a808ecb6ad08512a02f78a74">PSEUDO_PKT_SET_IPV6HDR</a>(nipv6h,  ipv6h)</td></tr>
<tr class="separator:aa0ea8445a808ecb6ad08512a02f78a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed1d1754a4ede3576ab053bd5bd88e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0ed1d1754a4ede3576ab053bd5bd88e5">PSEUDO_PKT_SET_TCPHDR</a>(ntcph,  tcph)</td></tr>
<tr class="separator:a0ed1d1754a4ede3576ab053bd5bd88e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a96d6fa8305eedd10a095558194edf776"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a96d6fa8305eedd10a095558194edf776">StreamTcpReturnStreamSegments</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *)</td></tr>
<tr class="memdesc:a96d6fa8305eedd10a095558194edf776"><td class="mdescLeft">&#160;</td><td class="mdescRight">return all segments in this stream into the pool(s)  <a href="stream-tcp_8c.html#a96d6fa8305eedd10a095558194edf776">More...</a><br /></td></tr>
<tr class="separator:a96d6fa8305eedd10a095558194edf776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8626f32922cf2f849c4f3fd2e936c848"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a8626f32922cf2f849c4f3fd2e936c848">StreamTcpInitConfig</a> (bool quiet)</td></tr>
<tr class="memdesc:a8626f32922cf2f849c4f3fd2e936c848"><td class="mdescLeft">&#160;</td><td class="mdescRight">To initialize the stream global configuration data.  <a href="stream-tcp_8c.html#a8626f32922cf2f849c4f3fd2e936c848">More...</a><br /></td></tr>
<tr class="separator:a8626f32922cf2f849c4f3fd2e936c848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259c476320217554a84279beb8a5f1cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a259c476320217554a84279beb8a5f1cf">StreamTcpGetFlowState</a> (void *)</td></tr>
<tr class="separator:a259c476320217554a84279beb8a5f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a4bbabc99ab491dd9fa822fd5b3ade953">StreamTcpSetOSPolicy</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the OS policy for the given stream based on the destination of the received packet.  <a href="stream-tcp_8c.html#a4bbabc99ab491dd9fa822fd5b3ade953">More...</a><br /></td></tr>
<tr class="separator:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f">StreamTcpReassembleMemuseGlobalCounter</a> (void)</td></tr>
<tr class="separator:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d327bdfaec16a40f479229f4a47fd12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a2d327bdfaec16a40f479229f4a47fd12">SC_ATOMIC_DECLARE</a> (uint64_t, st_memuse)</td></tr>
<tr class="separator:a2d327bdfaec16a40f479229f4a47fd12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051defe0827359d18d6b830e1eb66154"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a051defe0827359d18d6b830e1eb66154">StreamTcpInitMemuse</a> (void)</td></tr>
<tr class="separator:a051defe0827359d18d6b830e1eb66154"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59514802880d4d9475c3cffb5d3a7716"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716">StreamTcpIncrMemuse</a> (uint64_t size)</td></tr>
<tr class="separator:a59514802880d4d9475c3cffb5d3a7716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b0702f9f4d8ac41c5c439c4bc49c64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64">StreamTcpDecrMemuse</a> (uint64_t size)</td></tr>
<tr class="separator:a73b0702f9f4d8ac41c5c439c4bc49c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03aa3237dccab0112a80bb24ded9e19"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19">StreamTcpMemuseCounter</a> (void)</td></tr>
<tr class="separator:af03aa3237dccab0112a80bb24ded9e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c9973d678db064e54f760cc1d372a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8">StreamTcpCheckMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:a89c9973d678db064e54f760cc1d372a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if alloc'ing "size" would mean we're over memcap.  <a href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8">More...</a><br /></td></tr>
<tr class="separator:a89c9973d678db064e54f760cc1d372a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad63d1fe9247adc52831b6ff83b6508b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ad63d1fe9247adc52831b6ff83b6508b5">StreamTcpSetMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:ad63d1fe9247adc52831b6ff83b6508b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update memcap value.  <a href="stream-tcp_8c.html#ad63d1fe9247adc52831b6ff83b6508b5">More...</a><br /></td></tr>
<tr class="separator:ad63d1fe9247adc52831b6ff83b6508b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8768038688d876b40a1f6bae3a9f2ad"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aa8768038688d876b40a1f6bae3a9f2ad">StreamTcpGetMemcap</a> (void)</td></tr>
<tr class="memdesc:aa8768038688d876b40a1f6bae3a9f2ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return memcap value.  <a href="stream-tcp_8c.html#aa8768038688d876b40a1f6bae3a9f2ad">More...</a><br /></td></tr>
<tr class="separator:aa8768038688d876b40a1f6bae3a9f2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68329a480b2477950361537db68d8b45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45">StreamTcpStreamCleanup</a> (<a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *stream)</td></tr>
<tr class="separator:a68329a480b2477950361537db68d8b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26df002d4d76e0bf27433b289b1ca83a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a">StreamTcpSessionCleanup</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn)</td></tr>
<tr class="memdesc:a26df002d4d76e0bf27433b289b1ca83a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Session cleanup function. Does not free the ssn.  <a href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a">More...</a><br /></td></tr>
<tr class="separator:a26df002d4d76e0bf27433b289b1ca83a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add92e80f13e88362630ba978ac24c241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241">StreamTcpSessionClear</a> (void *ssnptr)</td></tr>
<tr class="memdesc:add92e80f13e88362630ba978ac24c241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream back to the pool. It returns the segments in the stream to the segment pool.  <a href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241">More...</a><br /></td></tr>
<tr class="separator:add92e80f13e88362630ba978ac24c241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f131faa6d6c797ab5d639c88418a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e">StreamTcpSessionPktFree</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p)</td></tr>
<tr class="memdesc:af9f131faa6d6c797ab5d639c88418a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream segments back to the pool.  <a href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e">More...</a><br /></td></tr>
<tr class="separator:af9f131faa6d6c797ab5d639c88418a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eff10436474bdea2755bef6705d3008"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a2eff10436474bdea2755bef6705d3008">StreamTcpInlineDropInvalid</a> (void)</td></tr>
<tr class="memdesc:a2eff10436474bdea2755bef6705d3008"><td class="mdescLeft">&#160;</td><td class="mdescRight">See if stream engine is dropping invalid packet in inline mode.  <a href="stream-tcp_8c.html#a2eff10436474bdea2755bef6705d3008">More...</a><br /></td></tr>
<tr class="separator:a2eff10436474bdea2755bef6705d3008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e1df383229e4ec307642c8770bf218a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a6e1df383229e4ec307642c8770bf218a">StreamTcpFreeConfig</a> (bool quiet)</td></tr>
<tr class="separator:a6e1df383229e4ec307642c8770bf218a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7828cd575847c16d7d5f20ed621565f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ac7828cd575847c16d7d5f20ed621565f">StreamTcpPacket</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="stream-tcp_8h.html#a47479993633dd630c33d0e616b3b88cf">StreamTcpThread</a> *stt, <a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *pq)</td></tr>
<tr class="separator:ac7828cd575847c16d7d5f20ed621565f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8803814028dbe6165bae8ced1a27d2f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a8803814028dbe6165bae8ced1a27d2f2">TcpSessionPacketSsnReuse</a> (const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, const void *tcp_ssn)</td></tr>
<tr class="separator:a8803814028dbe6165bae8ced1a27d2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac608d6e0b3308d0b463a71fc3b287f48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ac608d6e0b3308d0b463a71fc3b287f48">StreamTcp</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, void *data, <a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *pq)</td></tr>
<tr class="separator:ac608d6e0b3308d0b463a71fc3b287f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0929f1a9b555b60d89e3ce16271f89b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0929f1a9b555b60d89e3ce16271f89b9">StreamTcpThreadInit</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, void *initdata, void **data)</td></tr>
<tr class="separator:a0929f1a9b555b60d89e3ce16271f89b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a108137f5e3fa9caa0aab96a14df9b1cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a108137f5e3fa9caa0aab96a14df9b1cc">StreamTcpThreadDeinit</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, void *data)</td></tr>
<tr class="separator:a108137f5e3fa9caa0aab96a14df9b1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4ebba3d55a0923ad8aee7f6a959bd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#afc4ebba3d55a0923ad8aee7f6a959bd0">StreamTcpUpdateAppLayerProgress</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, char direction, const uint32_t progress)</td></tr>
<tr class="memdesc:afc4ebba3d55a0923ad8aee7f6a959bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">update reassembly progress  <a href="stream-tcp_8c.html#afc4ebba3d55a0923ad8aee7f6a959bd0">More...</a><br /></td></tr>
<tr class="separator:afc4ebba3d55a0923ad8aee7f6a959bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a9d7e90ce0fb1612fdb875cc836a9daa1">StreamTcpSetSessionNoReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, char direction)</td></tr>
<tr class="memdesc:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">disable reassembly  <a href="stream-tcp_8c.html#a9d7e90ce0fb1612fdb875cc836a9daa1">More...</a><br /></td></tr>
<tr class="separator:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a740e5a7f3e6792cf64cfe9926a93abb6">StreamTcpSetDisableRawReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, char direction)</td></tr>
<tr class="memdesc:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the No reassembly flag for the given direction in given TCP session.  <a href="stream-tcp_8c.html#a740e5a7f3e6792cf64cfe9926a93abb6">More...</a><br /></td></tr>
<tr class="separator:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9285e88fab8b3f131f1c5565f6f262"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ace9285e88fab8b3f131f1c5565f6f262">StreamTcpSetSessionBypassFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn)</td></tr>
<tr class="memdesc:ace9285e88fab8b3f131f1c5565f6f262"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable bypass  <a href="stream-tcp_8c.html#ace9285e88fab8b3f131f1c5565f6f262">More...</a><br /></td></tr>
<tr class="separator:ace9285e88fab8b3f131f1c5565f6f262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afba214a95265afcf490b5a85cbffc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a3afba214a95265afcf490b5a85cbffc4">StreamTcpPseudoSetup</a> (<a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *parent, uint8_t *pkt, uint32_t <a class="el" href="util-streaming-buffer_8h.html#a96bbf959016e4411c9e6b9812a8be60a">len</a>)</td></tr>
<tr class="memdesc:a3afba214a95265afcf490b5a85cbffc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream.  <a href="stream-tcp_8c.html#a3afba214a95265afcf490b5a85cbffc4">More...</a><br /></td></tr>
<tr class="separator:a3afba214a95265afcf490b5a85cbffc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c77b0865b107e413a8f5e0c7fc6234"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ad5c77b0865b107e413a8f5e0c7fc6234">StreamTcpDetectLogFlush</a> (<a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *<a class="el" href="fuzz__sigpcap__aware_8c.html#ab51ba57eb66aeeb0d9dbf8200d67e3fd">tv</a>, <a class="el" href="stream-tcp_8h.html#a47479993633dd630c33d0e616b3b88cf">StreamTcpThread</a> *stt, <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *f, <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, <a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *pq)</td></tr>
<tr class="memdesc:ad5c77b0865b107e413a8f5e0c7fc6234"><td class="mdescLeft">&#160;</td><td class="mdescRight">create packets in both directions to flush out logging and detection before switching protocols. In IDS mode, create first in packet dir, 2nd in opposing In IPS mode, do the reverse. Flag TCP engine that data needs to be inspected regardless of how far we are wrt inspect limits.  <a href="stream-tcp_8c.html#ad5c77b0865b107e413a8f5e0c7fc6234">More...</a><br /></td></tr>
<tr class="separator:ad5c77b0865b107e413a8f5e0c7fc6234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a85b1902bbd69d2620d60ce5e2cdfbdd3">StreamTcpSegmentForEach</a> (const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, uint8_t flag, <a class="el" href="stream_8h.html#a0e5b5cca0ae990b90e121e78717eaa11">StreamSegmentCallback</a> CallbackFunc, void *data)</td></tr>
<tr class="separator:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33d1d45a83e8f71cbfb8051690b46e91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a33d1d45a83e8f71cbfb8051690b46e91">StreamTcpSegmentForSession</a> (const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *p, uint8_t flag, <a class="el" href="stream_8h.html#a0e5b5cca0ae990b90e121e78717eaa11">StreamSegmentCallback</a> CallbackFunc, void *data)</td></tr>
<tr class="memdesc:a33d1d45a83e8f71cbfb8051690b46e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run callback function on each TCP segment in both directions of a session.  <a href="stream-tcp_8c.html#a33d1d45a83e8f71cbfb8051690b46e91">More...</a><br /></td></tr>
<tr class="separator:a33d1d45a83e8f71cbfb8051690b46e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0819085df5626ff1b5cb68f3a98ff8e0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0819085df5626ff1b5cb68f3a98ff8e0">StreamTcpBypassEnabled</a> (void)</td></tr>
<tr class="separator:a0819085df5626ff1b5cb68f3a98ff8e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb134a7f1f2b93a3e4c7ea551e10da69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69">StreamTcpInlineMode</a> (void)</td></tr>
<tr class="memdesc:adb134a7f1f2b93a3e4c7ea551e10da69"><td class="mdescLeft">&#160;</td><td class="mdescRight">See if stream engine is operating in inline mode.  <a href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69">More...</a><br /></td></tr>
<tr class="separator:adb134a7f1f2b93a3e4c7ea551e10da69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a032e54ca88381e188cb4ef5db7ed0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aa5a032e54ca88381e188cb4ef5db7ed0">TcpSessionSetReassemblyDepth</a> (<a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn, uint32_t size)</td></tr>
<tr class="separator:aa5a032e54ca88381e188cb4ef5db7ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e2fa18c93bc41fa7397c6b50523c42"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a65e2fa18c93bc41fa7397c6b50523c42">StreamTcpStateAsString</a> (const enum <a class="el" href="stream-tcp-private_8h.html#a4310b47e70de394d33f7cf601e35bfec">TcpState</a> state)</td></tr>
<tr class="separator:a65e2fa18c93bc41fa7397c6b50523c42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad857679aeee3b751f4837b64faf166fe"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ad857679aeee3b751f4837b64faf166fe">StreamTcpSsnStateAsString</a> (const <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *ssn)</td></tr>
<tr class="separator:ad857679aeee3b751f4837b64faf166fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a819fe1b32fe9d7dec8649ef7af7582d9"><td class="memItemLeft" align="right" valign="top">thread_local uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a819fe1b32fe9d7dec8649ef7af7582d9">t_pcapcnt</a></td></tr>
<tr class="separator:a819fe1b32fe9d7dec8649ef7af7582d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f795363f8a29406ae0eb9dd2aac261"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af5f795363f8a29406ae0eb9dd2aac261">g_detect_disabled</a></td></tr>
<tr class="separator:af5f795363f8a29406ae0eb9dd2aac261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp_8h.html#a8908bce3b095fbb7526cafd3ffbabf2b">TcpStreamCnf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ac6bed017a2a4f7ef805bd3b51a251d68">stream_config</a></td></tr>
<tr class="separator:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span class="obfuscator">.nosp@m.</span>r@in<span class="obfuscator">.nosp@m.</span>linia<span class="obfuscator">.nosp@m.</span>c.ne<span class="obfuscator">.nosp@m.</span>t</a> </dd>
<dd>
Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span class="obfuscator">.nosp@m.</span>nder<span class="obfuscator">.nosp@m.</span>singh<span class="obfuscator">.nosp@m.</span>dahi<span class="obfuscator">.nosp@m.</span>ya@gm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a></dd></dl>
<p>TCP stream tracking and reassembly engine.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000083">Todo:</a></b></dt><dd><ul>
<li>4WHS: what if after the 2nd SYN we turn out to be normal 3WHS anyway? </li>
</ul>
</dd></dl>

<p class="definition">Definition in file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9cf7d2fd0cd1bbbb032d9fa2d5650b87" name="a9cf7d2fd0cd1bbbb032d9fa2d5650b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cf7d2fd0cd1bbbb032d9fa2d5650b87">&#9670;&nbsp;</a></span>PSEUDO_PKT_SET_IPV4HDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_IPV4HDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nipv4h, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ipv4h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { \</div>
<div class="line">        IPV4_SET_RAW_VER(nipv4h, <a class="code hl_define" href="decode-ipv4_8h.html#acbd1b60f4655031c95e80e52d191cfb2">IPV4_GET_RAW_VER</a>(ipv4h)); \</div>
<div class="line">        IPV4_SET_RAW_HLEN(nipv4h, <a class="code hl_define" href="decode-ipv4_8h.html#ad18ed67806404d9a111710d03c4ae0df">IPV4_GET_RAW_HLEN</a>(ipv4h)); \</div>
<div class="line">        IPV4_SET_RAW_IPLEN(nipv4h, <a class="code hl_define" href="decode-ipv4_8h.html#a51c479632e474bc4b89d775ead54ff44">IPV4_GET_RAW_IPLEN</a>(ipv4h)); \</div>
<div class="line">        IPV4_SET_RAW_IPTOS(nipv4h, <a class="code hl_define" href="decode-ipv4_8h.html#a50882506cc7fd56a79f7918ffe081c77">IPV4_GET_RAW_IPTOS</a>(ipv4h)); \</div>
<div class="line">        IPV4_SET_RAW_IPPROTO(nipv4h, <a class="code hl_define" href="decode-ipv4_8h.html#af6324f0ddb677a11f985c7398fa5c7dc">IPV4_GET_RAW_IPPROTO</a>(ipv4h)); \</div>
<div class="line">        (nipv4h)-&gt;<a class="code hl_define" href="decode-ipv4_8h.html#ab8c734d3f1c632180cf6ac4b8aaa7649">s_ip_src</a> = <a class="code hl_define" href="decode-ipv4_8h.html#a691515eec90c36a5662330b3591726bd">IPV4_GET_RAW_IPDST</a>(ipv4h); \</div>
<div class="line">        (nipv4h)-&gt;<a class="code hl_define" href="decode-ipv4_8h.html#a0fb96cec5a08abecf6935ad1c6d9b6de">s_ip_dst</a> = <a class="code hl_define" href="decode-ipv4_8h.html#abc21610347a4f35a4cce23d5f55d927e">IPV4_GET_RAW_IPSRC</a>(ipv4h); \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="adecode-ipv4_8h_html_a0fb96cec5a08abecf6935ad1c6d9b6de"><div class="ttname"><a href="decode-ipv4_8h.html#a0fb96cec5a08abecf6935ad1c6d9b6de">s_ip_dst</a></div><div class="ttdeci">#define s_ip_dst</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00092">decode-ipv4.h:92</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_a50882506cc7fd56a79f7918ffe081c77"><div class="ttname"><a href="decode-ipv4_8h.html#a50882506cc7fd56a79f7918ffe081c77">IPV4_GET_RAW_IPTOS</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPTOS(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00097">decode-ipv4.h:97</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_a51c479632e474bc4b89d775ead54ff44"><div class="ttname"><a href="decode-ipv4_8h.html#a51c479632e474bc4b89d775ead54ff44">IPV4_GET_RAW_IPLEN</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPLEN(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00098">decode-ipv4.h:98</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_a691515eec90c36a5662330b3591726bd"><div class="ttname"><a href="decode-ipv4_8h.html#a691515eec90c36a5662330b3591726bd">IPV4_GET_RAW_IPDST</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPDST(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00104">decode-ipv4.h:104</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_ab8c734d3f1c632180cf6ac4b8aaa7649"><div class="ttname"><a href="decode-ipv4_8h.html#ab8c734d3f1c632180cf6ac4b8aaa7649">s_ip_src</a></div><div class="ttdeci">#define s_ip_src</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00091">decode-ipv4.h:91</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_abc21610347a4f35a4cce23d5f55d927e"><div class="ttname"><a href="decode-ipv4_8h.html#abc21610347a4f35a4cce23d5f55d927e">IPV4_GET_RAW_IPSRC</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPSRC(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00103">decode-ipv4.h:103</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_acbd1b60f4655031c95e80e52d191cfb2"><div class="ttname"><a href="decode-ipv4_8h.html#acbd1b60f4655031c95e80e52d191cfb2">IPV4_GET_RAW_VER</a></div><div class="ttdeci">#define IPV4_GET_RAW_VER(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00095">decode-ipv4.h:95</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_ad18ed67806404d9a111710d03c4ae0df"><div class="ttname"><a href="decode-ipv4_8h.html#ad18ed67806404d9a111710d03c4ae0df">IPV4_GET_RAW_HLEN</a></div><div class="ttdeci">#define IPV4_GET_RAW_HLEN(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00096">decode-ipv4.h:96</a></div></div>
<div class="ttc" id="adecode-ipv4_8h_html_af6324f0ddb677a11f985c7398fa5c7dc"><div class="ttname"><a href="decode-ipv4_8h.html#af6324f0ddb677a11f985c7398fa5c7dc">IPV4_GET_RAW_IPPROTO</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPPROTO(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00102">decode-ipv4.h:102</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06101">6101</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="aa0ea8445a808ecb6ad08512a02f78a74" name="aa0ea8445a808ecb6ad08512a02f78a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0ea8445a808ecb6ad08512a02f78a74">&#9670;&nbsp;</a></span>PSEUDO_PKT_SET_IPV6HDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_IPV6HDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nipv6h, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ipv6h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[0] = (ipv6h)-&gt;s_ip6_dst[0]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[1] = (ipv6h)-&gt;s_ip6_dst[1]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[2] = (ipv6h)-&gt;s_ip6_dst[2]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[3] = (ipv6h)-&gt;s_ip6_dst[3]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[0] = (ipv6h)-&gt;s_ip6_src[0]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[1] = (ipv6h)-&gt;s_ip6_src[1]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[2] = (ipv6h)-&gt;s_ip6_src[2]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code hl_define" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[3] = (ipv6h)-&gt;s_ip6_src[3]; \</div>
<div class="line">        IPV6_SET_RAW_NH(nipv6h, <a class="code hl_define" href="decode-ipv6_8h.html#a2cb25ef69103ad3e26b27191f70aeb57">IPV6_GET_RAW_NH</a>(ipv6h));    \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="adecode-ipv6_8h_html_a2cb25ef69103ad3e26b27191f70aeb57"><div class="ttname"><a href="decode-ipv6_8h.html#a2cb25ef69103ad3e26b27191f70aeb57">IPV6_GET_RAW_NH</a></div><div class="ttdeci">#define IPV6_GET_RAW_NH(ip6h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00065">decode-ipv6.h:65</a></div></div>
<div class="ttc" id="adecode-ipv6_8h_html_a7fb0be5346cfffc29e0158bcdf964ed4"><div class="ttname"><a href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a></div><div class="ttdeci">#define s_ip6_dst</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00053">decode-ipv6.h:53</a></div></div>
<div class="ttc" id="adecode-ipv6_8h_html_a9f92495a70d93003da40aad2d35d5bcd"><div class="ttname"><a href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a></div><div class="ttdeci">#define s_ip6_src</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00052">decode-ipv6.h:52</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06111">6111</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a0ed1d1754a4ede3576ab053bd5bd88e5" name="a0ed1d1754a4ede3576ab053bd5bd88e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed1d1754a4ede3576ab053bd5bd88e5">&#9670;&nbsp;</a></span>PSEUDO_PKT_SET_TCPHDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_TCPHDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ntcph, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tcph&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">        <span class="keywordflow">do</span> { \</div>
<div class="line">        COPY_PORT((tcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a>, (ntcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a>); \</div>
<div class="line">        COPY_PORT((tcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a>, (ntcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a>); \</div>
<div class="line">        (ntcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a44b335127ed14023ba6dc4f84d83071d">th_seq</a> = (tcph)-&gt;th_ack; \</div>
<div class="line">        (ntcph)-&gt;<a class="code hl_variable" href="decode-tcp_8h.html#a0fd270d538b4e85e75ac9e4982c4641b">th_ack</a> = (tcph)-&gt;th_seq; \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="adecode-tcp_8h_html_a0fd270d538b4e85e75ac9e4982c4641b"><div class="ttname"><a href="decode-tcp_8h.html#a0fd270d538b4e85e75ac9e4982c4641b">th_ack</a></div><div class="ttdeci">uint32_t th_ack</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00003">decode-tcp.h:3</a></div></div>
<div class="ttc" id="adecode-tcp_8h_html_a29b81527953a94bc51be676214c63d36"><div class="ttname"><a href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a></div><div class="ttdeci">uint16_t th_sport</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00000">decode-tcp.h:0</a></div></div>
<div class="ttc" id="adecode-tcp_8h_html_a44b335127ed14023ba6dc4f84d83071d"><div class="ttname"><a href="decode-tcp_8h.html#a44b335127ed14023ba6dc4f84d83071d">th_seq</a></div><div class="ttdeci">uint32_t th_seq</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00002">decode-tcp.h:2</a></div></div>
<div class="ttc" id="adecode-tcp_8h_html_a610220501c65f8401dd9252e4a468693"><div class="ttname"><a href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a></div><div class="ttdeci">uint16_t th_dport</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00001">decode-tcp.h:1</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06123">6123</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a6b3328d83ed3060e38ad76f657d0beac" name="a6b3328d83ed3060e38ad76f657d0beac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3328d83ed3060e38ad76f657d0beac">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00088">88</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="adbe999ee6a99cea5b5b795e5e653c7dc" name="adbe999ee6a99cea5b5b795e5e653c7dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe999ee6a99cea5b5b795e5e653c7dc">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_MEMCAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_MEMCAP&#160;&#160;&#160;(64 * 1024 * 1024)  /* 64mb */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00084">84</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a704dec4e8267ebbea46b9622538c0a02" name="a704dec4e8267ebbea46b9622538c0a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a704dec4e8267ebbea46b9622538c0a02">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_PREALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_PREALLOC&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00083">83</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a1b5dea44b5b98768801ad5c7d7b63ba0" name="a1b5dea44b5b98768801ad5c7d7b63ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5dea44b5b98768801ad5c7d7b63ba0">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP&#160;&#160;&#160;(256 * 1024 * 1024) /* 256mb */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00085">85</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a67ff119dd23fb1ae0d1d087b9a1ffd16" name="a67ff119dd23fb1ae0d1d087b9a1ffd16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ff119dd23fb1ae0d1d087b9a1ffd16">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE&#160;&#160;&#160;2560</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00087">87</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a62b628d585930d0abedf1bb1a3a44a3e" name="a62b628d585930d0abedf1bb1a3a44a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b628d585930d0abedf1bb1a3a44a3e">&#9670;&nbsp;</a></span>STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE&#160;&#160;&#160;2560</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00086">86</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a66cc28d1694e768ad78418f4e5e47f42" name="a66cc28d1694e768ad78418f4e5e47f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66cc28d1694e768ad78418f4e5e47f42">&#9670;&nbsp;</a></span>StreamTcpAsyncLastAckUpdate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpAsyncLastAckUpdate</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                              \</div>
<div class="line">    if ((ssn)-&gt;<a class="code hl_variable" href="decode-gre_8h.html#aa2585d779da0ab21273a8d92de9a0ebe">flags</a> &amp; <a class="code hl_define" href="stream-tcp-private_8h.html#a24817ec49f7e1b86b6010b007a291481">STREAMTCP_FLAG_ASYNC</a>) {                                  \</div>
<div class="line">        if (<a class="code hl_define" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>((stream)-&gt;next_seq, (stream)-&gt;last_ack)) {                   \</div>
<div class="line">            uint32_t ack_diff = (stream)-&gt;next_seq - (stream)-&gt;last_ack;        \</div>
<div class="line">            (stream)-&gt;last_ack += ack_diff;                                     \</div>
<div class="line">            SCLogDebug(<span class="stringliteral">&quot;ssn %p: ASYNC last_ack set to %&quot;</span>PRIu32<span class="stringliteral">&quot;, moved %u forward&quot;</span>,     \</div>
<div class="line">                    (ssn), (stream)-&gt;next_seq, ack_diff);                               \</div>
<div class="line">        }                                                                       \</div>
<div class="line">    }                                                                           \</div>
<div class="line">}</div>
<div class="ttc" id="adecode-gre_8h_html_aa2585d779da0ab21273a8d92de9a0ebe"><div class="ttname"><a href="decode-gre_8h.html#aa2585d779da0ab21273a8d92de9a0ebe">flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="decode-gre_8h_source.html#l00000">decode-gre.h:0</a></div></div>
<div class="ttc" id="astream-tcp-private_8h_html_a202607d795640148bc4b3fbd0ba0ae74"><div class="ttname"><a href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a></div><div class="ttdeci">#define SEQ_GT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00251">stream-tcp-private.h:251</a></div></div>
<div class="ttc" id="astream-tcp-private_8h_html_a24817ec49f7e1b86b6010b007a291481"><div class="ttname"><a href="stream-tcp-private_8h.html#a24817ec49f7e1b86b6010b007a291481">STREAMTCP_FLAG_ASYNC</a></div><div class="ttdeci">#define STREAMTCP_FLAG_ASYNC</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00181">stream-tcp-private.h:181</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00829">829</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a387f8eba48e884ee147c39fcd084e4f1" name="a387f8eba48e884ee147c39fcd084e4f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a387f8eba48e884ee147c39fcd084e4f1">&#9670;&nbsp;</a></span>StreamTcpUpdateLastAck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpUpdateLastAck</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ack&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    if (<a class="code hl_define" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>((ack), (stream)-&gt;last_ack)) \</div>
<div class="line">    { \</div>
<div class="line">        SCLogDebug(<span class="stringliteral">&quot;ssn %p: last_ack set to %&quot;</span>PRIu32<span class="stringliteral">&quot;, moved %u forward&quot;</span>, (ssn), (ack), (ack) - (stream)-&gt;last_ack); \</div>
<div class="line">        if ((<a class="code hl_define" href="stream-tcp-private_8h.html#a59976866ea454f08233fbc246908dbc8">SEQ_LEQ</a>((stream)-&gt;last_ack, (stream)-&gt;next_seq) &amp;&amp; <a class="code hl_define" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>((ack),(stream)-&gt;next_seq))) { \</div>
<div class="line">            SCLogDebug(<span class="stringliteral">&quot;last_ack just passed next_seq: %u (was %u) &gt; %u&quot;</span>, (ack), (stream)-&gt;last_ack, (stream)-&gt;next_seq); \</div>
<div class="line">        } <span class="keywordflow">else</span> { \</div>
<div class="line">            SCLogDebug(<span class="stringliteral">&quot;next_seq (%u) &lt;&gt; last_ack now %d&quot;</span>, (stream)-&gt;next_seq, (<span class="keywordtype">int</span>)(stream)-&gt;next_seq - (ack)); \</div>
<div class="line">        }\</div>
<div class="line">        (stream)-&gt;last_ack = (ack); \</div>
<div class="line">        StreamTcpSackPruneList((stream)); \</div>
<div class="line">    } <span class="keywordflow">else</span> { \</div>
<div class="line">        SCLogDebug(<span class="stringliteral">&quot;ssn %p: no update: ack %u, last_ack %&quot;</span>PRIu32<span class="stringliteral">&quot;, next_seq %u (state %u)&quot;</span>, \</div>
<div class="line">                    (ssn), (ack), (stream)-&gt;last_ack, (stream)-&gt;next_seq, (ssn)-&gt;state); \</div>
<div class="line">    }\</div>
<div class="line">}</div>
<div class="ttc" id="astream-tcp-private_8h_html_a59976866ea454f08233fbc246908dbc8"><div class="ttname"><a href="stream-tcp-private_8h.html#a59976866ea454f08233fbc246908dbc8">SEQ_LEQ</a></div><div class="ttdeci">#define SEQ_LEQ(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00250">stream-tcp-private.h:250</a></div></div>
</div><!-- fragment -->
<p>macro to update last_ack only if the new value is higher </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>session </td></tr>
    <tr><td class="paramname">stream</td><td>stream to update </td></tr>
    <tr><td class="paramname">ack</td><td>ACK value to test and set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00812">812</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="ada021cbe10c9d26d66dd9671b5d52d0e" name="ada021cbe10c9d26d66dd9671b5d52d0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada021cbe10c9d26d66dd9671b5d52d0e">&#9670;&nbsp;</a></span>StreamTcpUpdateNextSeq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpUpdateNextSeq</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                      \</div>
<div class="line">    (stream)-&gt;next_seq = <a class="code hl_variable" href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>;                                           \</div>
<div class="line">    SCLogDebug(<span class="stringliteral">&quot;ssn %p: next_seq %&quot;</span> PRIu32, (ssn), (stream)-&gt;next_seq); \</div>
<div class="line">    StreamTcpAsyncLastAckUpdate((ssn), (stream));                       \</div>
<div class="line">}</div>
<div class="ttc" id="astream-tcp-private_8h_html_aaf1b939170b82732448a965a5b33ad4e"><div class="ttname"><a href="stream-tcp-private_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a></div><div class="ttdeci">uint32_t seq</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00002">stream-tcp-private.h:2</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00840">840</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a id="a0e34441870e907cb9fc3a879882e9908" name="a0e34441870e907cb9fc3a879882e9908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e34441870e907cb9fc3a879882e9908">&#9670;&nbsp;</a></span>StreamTcpUpdateNextWin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpUpdateNextWin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">win&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    uint32_t sacked_size__ = StreamTcpSackedSize((stream)); \</div>
<div class="line">    if (<a class="code hl_define" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>(((win) + sacked_size__), (stream)-&gt;next_win)) { \</div>
<div class="line">        (stream)-&gt;next_win = ((win) + sacked_size__); \</div>
<div class="line">        SCLogDebug(<span class="stringliteral">&quot;ssn %p: next_win set to %&quot;</span>PRIu32, (ssn), (stream)-&gt;next_win); \</div>
<div class="line">    } \</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>macro to update next_win only if the new value is higher </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>session </td></tr>
    <tr><td class="paramname">stream</td><td>stream to update </td></tr>
    <tr><td class="paramname">win</td><td>window value to test and set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00853">853</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2d327bdfaec16a40f479229f4a47fd12" name="a2d327bdfaec16a40f479229f4a47fd12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d327bdfaec16a40f479229f4a47fd12">&#9670;&nbsp;</a></span>SC_ATOMIC_DECLARE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">st_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac608d6e0b3308d0b463a71fc3b287f48" name="ac608d6e0b3308d0b463a71fc3b287f48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac608d6e0b3308d0b463a71fc3b287f48">&#9670;&nbsp;</a></span>StreamTcp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l05348">5348</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00094">StreamTcpThread_::counter_tcp_no_flow</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8c_source.html#l00293">FlowGetPacketDirection()</a>, <a class="el" href="decode_8h_source.html#l00595">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l00255">PKT_IS_TCP</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="counters_8c_source.html#l00169">StatsIncr()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00077">t_pcapcnt</a>, <a class="el" href="tm-threads-common_8h_source.html#l00082">TM_ECODE_OK</a>, <a class="el" href="flow_8h_source.html#l00043">TOSERVER</a>, and <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ac608d6e0b3308d0b463a71fc3b287f48_cgraph.png" border="0" usemap="#astream-tcp_8c_ac608d6e0b3308d0b463a71fc3b287f48_cgraph" alt=""/></div>
<map name="astream-tcp_8c_ac608d6e0b3308d0b463a71fc3b287f48_cgraph" id="astream-tcp_8c_ac608d6e0b3308d0b463a71fc3b287f48_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,89,57"/>
<area shape="rect" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow" alt="" coords="137,5,301,32"/>
<area shape="rect" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter." alt="" coords="182,56,257,83"/>
</map>
</div>

</div>
</div>
<a id="a0819085df5626ff1b5cb68f3a98ff8e0" name="a0819085df5626ff1b5cb68f3a98ff8e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0819085df5626ff1b5cb68f3a98ff8e0">&#9670;&nbsp;</a></span>StreamTcpBypassEnabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpBypassEnabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06544">6544</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00054">TcpStreamCnf_::flags</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, and <a class="el" href="stream-tcp_8h_source.html#l00039">STREAMTCP_INIT_FLAG_BYPASS</a>.</p>

</div>
</div>
<a id="a89c9973d678db064e54f760cc1d372a8" name="a89c9973d678db064e54f760cc1d372a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c9973d678db064e54f760cc1d372a8">&#9670;&nbsp;</a></span>StreamTcpCheckMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if alloc'ing "size" would mean we're over memcap. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00162">162</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a73b0702f9f4d8ac41c5c439c4bc49c64" name="a73b0702f9f4d8ac41c5c439c4bc49c64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73b0702f9f4d8ac41c5c439c4bc49c64">&#9670;&nbsp;</a></span>StreamTcpDecrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00129">129</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="suricata-common_8h_source.html#l00281">BUG_ON</a>, <a class="el" href="suricata_8c_source.html#l00279">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00342">SC_ATOMIC_SUB</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp_8c_source.html#l00150">StreamTcpMemuseCounter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00209">StreamTcpSessionCleanup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_cgraph.png" border="0" usemap="#astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_cgraph" id="astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,168,57"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="235,5,377,32"/>
<area shape="rect" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title=" " alt="" coords="216,56,396,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph.png" border="0" usemap="#astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph" id="astream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph">
<area shape="rect" title=" " alt="" coords="484,56,647,83"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,5,189,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,56,197,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,107,209,133"/>
</map>
</div>

</div>
</div>
<a id="ad5c77b0865b107e413a8f5e0c7fc6234" name="ad5c77b0865b107e413a8f5e0c7fc6234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5c77b0865b107e413a8f5e0c7fc6234">&#9670;&nbsp;</a></span>StreamTcpDetectLogFlush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDetectLogFlush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#a47479993633dd630c33d0e616b3b88cf">StreamTcpThread</a> *&#160;</td>
          <td class="paramname"><em>stt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>create packets in both directions to flush out logging and detection before switching protocols. In IDS mode, create first in packet dir, 2nd in opposing In IPS mode, do the reverse. Flag TCP engine that data needs to be inspected regardless of how far we are wrt inspect limits. </p>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06378">6378</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00217">STREAMTCP_STREAM_FLAG_TRIGGER_RAW</a>, <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>, and <a class="el" href="source-erf-file_8c_source.html#l00055">ts</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ad5c77b0865b107e413a8f5e0c7fc6234_cgraph.png" border="0" usemap="#astream-tcp_8c_ad5c77b0865b107e413a8f5e0c7fc6234_cgraph" alt=""/></div>
<map name="astream-tcp_8c_ad5c77b0865b107e413a8f5e0c7fc6234_cgraph" id="astream-tcp_8c_ad5c77b0865b107e413a8f5e0c7fc6234_cgraph">
<area shape="rect" title="create packets in both directions to flush out logging and detection before switching protocols...." alt="" coords="5,5,181,32"/>
<area shape="rect" href="stream-tcp_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode." alt="" coords="229,5,376,32"/>
</map>
</div>

</div>
</div>
<a id="a6e1df383229e4ec307642c8770bf218a" name="a6e1df383229e4ec307642c8770bf218a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e1df383229e4ec307642c8770bf218a">&#9670;&nbsp;</a></span>StreamTcpFreeConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpFreeConfig </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00667">667</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleFree()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-util_8c_source.html#l00051">StreamTcpUTDeinit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_cgraph.png" border="0" usemap="#astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_cgraph" id="astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,153,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ae8ae76565bf66071c8a1eb482bd0e3fa" title=" " alt="" coords="201,5,384,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_icgraph.png" border="0" usemap="#astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_icgraph" id="astream-tcp_8c_a6e1df383229e4ec307642c8770bf218a_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,337,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#af08d2b5ca2d164e365b1fcd55cd3521a" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
<a id="a259c476320217554a84279beb8a5f1cf" name="a259c476320217554a84279beb8a5f1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259c476320217554a84279beb8a5f1cf">&#9670;&nbsp;</a></span>StreamTcpGetFlowState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpGetFlowState </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8768038688d876b40a1f6bae3a9f2ad" name="aa8768038688d876b40a1f6bae3a9f2ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8768038688d876b40a1f6bae3a9f2ad">&#9670;&nbsp;</a></span>StreamTcpGetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpGetMemcap </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return memcap value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">memcap</td><td>memcap value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00190">190</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a59514802880d4d9475c3cffb5d3a7716" name="a59514802880d4d9475c3cffb5d3a7716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59514802880d4d9475c3cffb5d3a7716">&#9670;&nbsp;</a></span>StreamTcpIncrMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00122">122</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00333">SC_ATOMIC_ADD</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, and <a class="el" href="stream-tcp_8c_source.html#l00150">StreamTcpMemuseCounter()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_cgraph.png" border="0" usemap="#astream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_cgraph" id="astream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,161,32"/>
<area shape="rect" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title=" " alt="" coords="209,5,389,32"/>
</map>
</div>

</div>
</div>
<a id="a8626f32922cf2f849c4f3fd2e936c848" name="a8626f32922cf2f849c4f3fd2e936c848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8626f32922cf2f849c4f3fd2e936c848">&#9670;&nbsp;</a></span>StreamTcpInitConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpInitConfig </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To initialize the stream global configuration data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">quiet</td><td>It tells the mode of operation, if it is true nothing will be get printed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00359">359</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00060">TcpStreamCnf_::async_oneside</a>, <a class="el" href="conf_8c_source.html#l00330">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00472">ConfGetBool()</a>, <a class="el" href="conf_8c_source.html#l00392">ConfGetInt()</a>, <a class="el" href="conf_8c_source.html#l00175">ConfGetNode()</a>, <a class="el" href="suricata_8c_source.html#l00258">EngineModeIsIPS()</a>, <a class="el" href="util-exception-policy_8c_source.html#l00075">ExceptionPolicyParse()</a>, <a class="el" href="util-debug_8h_source.html#l00530">FatalError</a>, <a class="el" href="stream-tcp_8h_source.html#l00054">TcpStreamCnf_::flags</a>, <a class="el" href="stream-tcp_8h_source.html#l00055">TcpStreamCnf_::max_synack_queued</a>, <a class="el" href="stream-tcp_8h_source.html#l00059">TcpStreamCnf_::midstream</a>, <a class="el" href="stream-tcp_8h_source.html#l00070">TcpStreamCnf_::midstream_policy</a>, <a class="el" href="util-misc_8c_source.html#l00166">ParseSizeStringU16()</a>, <a class="el" href="util-misc_8c_source.html#l00183">ParseSizeStringU32()</a>, <a class="el" href="util-misc_8c_source.html#l00200">ParseSizeStringU64()</a>, <a class="el" href="stream-tcp_8h_source.html#l00057">TcpStreamCnf_::prealloc_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00061">TcpStreamCnf_::reassembly_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00069">TcpStreamCnf_::reassembly_memcap_policy</a>, <a class="el" href="stream-tcp_8h_source.html#l00063">TcpStreamCnf_::reassembly_toserver_chunk_size</a>, <a class="el" href="suricata_8c_source.html#l00279">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00315">SC_ATOMIC_INIT</a>, <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-error_8h_source.html#l00230">SC_ERR_SIZE_PARSE</a>, <a class="el" href="util-error_8h_source.html#l00265">SC_WARN_OPTION_OBSOLETE</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00255">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00242">SCLogWarning</a>, <a class="el" href="stream-tcp_8h_source.html#l00068">TcpStreamCnf_::ssn_memcap_policy</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, <a class="el" href="stream-tcp_8c_source.html#l00088">STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</a>, <a class="el" href="stream-tcp_8c_source.html#l00084">STREAMTCP_DEFAULT_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00083">STREAMTCP_DEFAULT_PREALLOC</a>, <a class="el" href="stream-tcp_8c_source.html#l00085">STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00086">STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</a>, <a class="el" href="stream-tcp_8h_source.html#l00039">STREAMTCP_INIT_FLAG_BYPASS</a>, <a class="el" href="stream-tcp_8h_source.html#l00037">STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION</a>, <a class="el" href="stream-tcp_8h_source.html#l00038">STREAMTCP_INIT_FLAG_DROP_INVALID</a>, <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_INLINE</a>, and <a class="el" href="util-misc_8h_source.html#l00036">WarnInvalidConfEntry</a>.</p>

<p class="reference">Referenced by <a class="el" href="suricata_8c_source.html#l02154">PreRunInit()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00044">StreamTcpUTInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_cgraph.png" border="0" usemap="#astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_cgraph" id="astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_cgraph">
<area shape="rect" title="To initialize the stream global configuration data." alt="" coords="5,208,145,235"/>
<area shape="rect" href="conf_8c.html#ab7638a53fd00da93228a4769b1efd635" title="Retrieve the value of a configuration node." alt="" coords="409,82,480,108"/>
<area shape="rect" href="conf_8c.html#a2a8a51bd7c5873dd3fc70685bc769185" title="Get a ConfNode by name." alt="" coords="545,31,648,58"/>
<area shape="rect" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen." alt="" coords="220,234,317,260"/>
<area shape="rect" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer." alt="" coords="225,82,312,108"/>
<area shape="rect" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title=" " alt="" coords="205,183,332,210"/>
<area shape="rect" href="util-exception-policy_8c.html#aca33bad9c66e73b6d198b8d9614a00f6" title=" " alt="" coords="193,132,344,159"/>
<area shape="rect" href="util-misc_8c.html#ac799c82481f5e938b2ea704a014c6a0d" title=" " alt="" coords="199,284,339,311"/>
<area shape="rect" href="util-misc_8c.html#a4a65cb5e0f0109498b38fd1f9bd3a620" title=" " alt="" coords="199,335,339,362"/>
<area shape="rect" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title=" " alt="" coords="199,386,339,412"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="197,436,340,463"/>
<area shape="rect" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true." alt="" coords="392,234,497,260"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_icgraph.png" border="0" usemap="#astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_icgraph" id="astream-tcp_8c_a8626f32922cf2f849c4f3fd2e936c848_icgraph">
<area shape="rect" title="To initialize the stream global configuration data." alt="" coords="173,31,313,57"/>
<area shape="rect" href="suricata_8c.html#a24ef7c82defde542c35c3c27e3c41106" title=" " alt="" coords="23,5,107,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#ac334d8068855916fb7ceaf9fa01247a4" title=" " alt="" coords="5,56,125,83"/>
</map>
</div>

</div>
</div>
<a id="a051defe0827359d18d6b830e1eb66154" name="a051defe0827359d18d6b830e1eb66154"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a051defe0827359d18d6b830e1eb66154">&#9670;&nbsp;</a></span>StreamTcpInitMemuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpInitMemuse </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00117">117</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00315">SC_ATOMIC_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-unittest_8c_source.html#l00189">UtRunTests()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a051defe0827359d18d6b830e1eb66154_icgraph.png" border="0" usemap="#astream-tcp_8c_a051defe0827359d18d6b830e1eb66154_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a051defe0827359d18d6b830e1eb66154_icgraph" id="astream-tcp_8c_a051defe0827359d18d6b830e1eb66154_icgraph">
<area shape="rect" title=" " alt="" coords="145,5,297,32"/>
<area shape="rect" href="group__Testing.html#ga961f4890d5ff5ef0e1b83e66b3255b6a" title="Run all registered unittests." alt="" coords="5,5,97,32"/>
</map>
</div>

</div>
</div>
<a id="a2eff10436474bdea2755bef6705d3008" name="a2eff10436474bdea2755bef6705d3008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eff10436474bdea2755bef6705d3008">&#9670;&nbsp;</a></span>StreamTcpInlineDropInvalid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpInlineDropInvalid </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>See if stream engine is dropping invalid packet in inline mode. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>no </td></tr>
    <tr><td class="paramname">1</td><td>yes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00333">333</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00054">TcpStreamCnf_::flags</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, <a class="el" href="stream-tcp_8h_source.html#l00038">STREAMTCP_INIT_FLAG_DROP_INVALID</a>, and <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_INLINE</a>.</p>

</div>
</div>
<a id="adb134a7f1f2b93a3e4c7ea551e10da69" name="adb134a7f1f2b93a3e4c7ea551e10da69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb134a7f1f2b93a3e4c7ea551e10da69">&#9670;&nbsp;</a></span>StreamTcpInlineMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpInlineMode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>See if stream engine is operating in inline mode. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>no </td></tr>
    <tr><td class="paramname">1</td><td>yes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06555">6555</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00054">TcpStreamCnf_::flags</a>, <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>, and <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_INLINE</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l01824">StreamReassembleRaw()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l01414">StreamReassembleRawHasDataReady()</a>, <a class="el" href="stream-tcp_8c_source.html#l06378">StreamTcpDetectLogFlush()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00409">StreamTcpGetUsable()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l01921">StreamTcpReassembleHandleSegment()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_adb134a7f1f2b93a3e4c7ea551e10da69_icgraph.png" border="0" usemap="#astream-tcp_8c_adb134a7f1f2b93a3e4c7ea551e10da69_icgraph" alt=""/></div>
<map name="astream-tcp_8c_adb134a7f1f2b93a3e4c7ea551e10da69_icgraph" id="astream-tcp_8c_adb134a7f1f2b93a3e4c7ea551e10da69_icgraph">
<area shape="rect" title="See if stream engine is operating in inline mode." alt="" coords="504,130,651,157"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a31c38730e71715b22a87ee3c4a69ebbd" title=" " alt="" coords="266,13,430,39"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a244d3a5e334392fa0091554609e55f71" title="does the stream engine have data to inspect?" alt="" coords="240,64,456,105"/>
<area shape="rect" href="stream-tcp_8c.html#ad5c77b0865b107e413a8f5e0c7fc6234" title="create packets in both directions to flush out logging and detection before switching protocols...." alt="" coords="260,130,436,157"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a63df10c51382b7b37880fc72063e79ad" title=" " alt="" coords="275,181,421,207"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a246e7261bcaaaf2d566533851838a32f" title=" " alt="" coords="249,232,447,273"/>
<area shape="rect" href="detect-engine-payload_8c.html#a0d743a50ec5612e0a9f97203da39b707" title="Do the content inspection &amp; validation for a signature on the raw stream." alt="" coords="5,5,192,47"/>
<area shape="rect" href="output-json-frame_8c.html#a06235de1193e59f3af805d240ca6a7f8" title="log a single frame" alt="" coords="14,181,183,207"/>
</map>
</div>

</div>
</div>
<a id="af03aa3237dccab0112a80bb24ded9e19" name="af03aa3237dccab0112a80bb24ded9e19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03aa3237dccab0112a80bb24ded9e19">&#9670;&nbsp;</a></span>StreamTcpMemuseCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpMemuseCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00150">150</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00129">StreamTcpDecrMemuse()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00122">StreamTcpIncrMemuse()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph.png" border="0" usemap="#astream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph" alt=""/></div>
<map name="astream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph" id="astream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph">
<area shape="rect" title=" " alt="" coords="695,81,875,108"/>
<area shape="rect" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title=" " alt="" coords="484,56,647,83"/>
<area shape="rect" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title=" " alt="" coords="487,107,643,133"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,5,189,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,56,197,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,107,209,133"/>
</map>
</div>

</div>
</div>
<a id="ac7828cd575847c16d7d5f20ed621565f" name="ac7828cd575847c16d7d5f20ed621565f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7828cd575847c16d7d5f20ed621565f">&#9670;&nbsp;</a></span>StreamTcpPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#a47479993633dd630c33d0e616b3b88cf">StreamTcpThread</a> *&#160;</td>
          <td class="paramname"><em>stt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="packet-queue_8h.html#a82a6a48a686ec7fbc6a89cf604335c1c">PacketQueueNoLock</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l04935">4935</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp_8h_source.html#l00102">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp_8h_source.html#l00098">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00100">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="util-validate_8h_source.html#l00108">DEBUG_ASSERT_FLOW_LOCKED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="decode_8h_source.html#l00595">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l00260">PKT_IS_TOCLIENT</a>, <a class="el" href="decode_8h_source.html#l00259">PKT_IS_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="counters_8c_source.html#l00169">StatsIncr()</a>, <a class="el" href="decode-events_8h_source.html#l00277">STREAM_PKT_BROKEN_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00181">STREAMTCP_FLAG_ASYNC</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00260">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00111">TcpStream_::tcp_flags</a>, <a class="el" href="decode-tcp_8h_source.html#l00115">TCP_GET_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00278">TcpSession_::tcp_packet_flags</a>, <a class="el" href="decode_8h_source.html#l00554">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00038">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_RST</a>, <a class="el" href="decode-tcp_8h_source.html#l00035">TH_SYN</a>, and <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ac7828cd575847c16d7d5f20ed621565f_cgraph.png" border="0" usemap="#astream-tcp_8c_ac7828cd575847c16d7d5f20ed621565f_cgraph" alt=""/></div>
<map name="astream-tcp_8c_ac7828cd575847c16d7d5f20ed621565f_cgraph" id="astream-tcp_8c_ac7828cd575847c16d7d5f20ed621565f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,131,32"/>
<area shape="rect" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter." alt="" coords="179,5,253,32"/>
</map>
</div>

</div>
</div>
<a id="a3afba214a95265afcf490b5a85cbffc4" name="a3afba214a95265afcf490b5a85cbffc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3afba214a95265afcf490b5a85cbffc4">&#9670;&nbsp;</a></span>StreamTcpPseudoSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> * StreamTcpPseudoSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>Pointer to the parent of the pseudo packet </td></tr>
    <tr><td class="paramname">pkt</td><td>pointer to the raw packet of the parent </td></tr>
    <tr><td class="paramname">len</td><td>length of the packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>upon success returns the pointer to the new pseudo packet otherwise NULL </dd></dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06140">6140</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00608">Packet_::datalink</a>, <a class="el" href="app-layer-dnp3_8h_source.html#l00002">len</a>, <a class="el" href="decode_8c_source.html#l00298">PacketCopyData()</a>, <a class="el" href="decode_8c_source.html#l00214">PacketGetFromQueueOrAlloc()</a>, <a class="el" href="decode_8h_source.html#l00456">Packet_::proto</a>, <a class="el" href="decode_8h_source.html#l00459">Packet_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00619">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00314">SCReturnPtr</a>, and <a class="el" href="decode_8h_source.html#l00477">Packet_::ts</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a3afba214a95265afcf490b5a85cbffc4_cgraph.png" border="0" usemap="#astream-tcp_8c_a3afba214a95265afcf490b5a85cbffc4_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a3afba214a95265afcf490b5a85cbffc4_cgraph" id="astream-tcp_8c_a3afba214a95265afcf490b5a85cbffc4_cgraph">
<area shape="rect" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="5,56,168,83"/>
<area shape="rect" href="group__decode.html#ga770e739385ab300a93b3b8b6ad397c6c" title="Copy data to Packet payload and set packet length." alt="" coords="252,19,375,45"/>
<area shape="rect" href="group__decode.html#ga16dce3a48e71dd5b13fb4c401f5f4a9c" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="216,81,411,108"/>
<area shape="rect" href="group__decode.html#ga6a92ae57f13829a510065b4d9778e9ab" title="Copy data to Packet payload at given offset." alt="" coords="464,5,623,32"/>
<area shape="rect" href="group__decode.html#ga6b3bb631b851b9984a67cc19a40ea183" title="Get a malloced packet." alt="" coords="472,56,615,83"/>
<area shape="rect" href="tmqh-packetpool_8c.html#a3933faec8b723a5f7192f30573e85647" title="Get a new packet from the packet pool." alt="" coords="468,107,619,133"/>
<area shape="rect" href="tmqh-packetpool_8c.html#aecfd7fbbc040386dbe6546236b7d20b7" title="Return packet to Packet pool." alt="" coords="459,157,628,184"/>
<area shape="rect" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet." alt="" coords="676,56,765,83"/>
</map>
</div>

</div>
</div>
<a id="a477c59db3b1fef12cb9b1e5e5de0f59f" name="a477c59db3b1fef12cb9b1e5e5de0f59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477c59db3b1fef12cb9b1e5e5de0f59f">&#9670;&nbsp;</a></span>StreamTcpReassembleMemuseGlobalCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleMemuseGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00147">147</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a id="a96d6fa8305eedd10a095558194edf776" name="a96d6fa8305eedd10a095558194edf776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96d6fa8305eedd10a095558194edf776">&#9670;&nbsp;</a></span>StreamTcpReturnStreamSegments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReturnStreamSegments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return all segments in this stream into the pool(s) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>the stream to cleanup </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">385</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">References <a class="el" href="tree_8h_source.html#l00791">RB_FOREACH_SAFE</a>, <a class="el" href="tree_8h_source.html#l00773">RB_REMOVE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00135">TcpStream_::seg_tree</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00368">StreamTcpSegmentReturntoPool()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-list_8c_source.html#l00880">StreamTcpPruneSession()</a>, <a class="el" href="stream-tcp_8c_source.html#l00277">StreamTcpSessionPktFree()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00196">StreamTcpStreamCleanup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph.png" border="0" usemap="#astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph" id="astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph">
<area shape="rect" title="return all segments in this stream into the pool(s)" alt="" coords="5,5,229,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="277,5,489,32"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="537,5,664,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="712,5,799,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph.png" border="0" usemap="#astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph" id="astream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph">
<area shape="rect" title="return all segments in this stream into the pool(s)" alt="" coords="709,56,933,83"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,5,655,32"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,56,661,83"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,107,660,133"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,81,436,108"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,132,434,159"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,31,189,57"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,132,197,159"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,81,209,108"/>
</map>
</div>

</div>
</div>
<a id="a85b1902bbd69d2620d60ce5e2cdfbdd3" name="a85b1902bbd69d2620d60ce5e2cdfbdd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b1902bbd69d2620d60ce5e2cdfbdd3">&#9670;&nbsp;</a></span>StreamTcpSegmentForEach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSegmentForEach </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a0e5b5cca0ae990b90e121e78717eaa11">StreamSegmentCallback</a>&#160;</td>
          <td class="paramname"><em>CallbackFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06402">6402</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream_8c_source.html#l00040">StreamSegmentForEach()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph.png" border="0" usemap="#astream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" id="astream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph">
<area shape="rect" title=" " alt="" coords="219,5,404,32"/>
<area shape="rect" href="stream_8c.html#af1a6a686c53801b6b418efe258add530" title=" " alt="" coords="5,5,171,32"/>
</map>
</div>

</div>
</div>
<a id="a33d1d45a83e8f71cbfb8051690b46e91" name="a33d1d45a83e8f71cbfb8051690b46e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33d1d45a83e8f71cbfb8051690b46e91">&#9670;&nbsp;</a></span>StreamTcpSegmentForSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSegmentForSession </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#a0e5b5cca0ae990b90e121e78717eaa11">StreamSegmentCallback</a>&#160;</td>
          <td class="paramname"><em>CallbackFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run callback function on each TCP segment in both directions of a session. </p>
<dl class="section note"><dt>Note</dt><dd>when stream engine is running in inline mode all segments are used, in IDS/non-inline mode only ack'd segments are iterated.</dd>
<dd>
Must be called under flow lock.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>-1 in case of error, the number of segment in case of success </dd></dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06461">6461</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream_8c_source.html#l00064">StreamSegmentForSession()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a33d1d45a83e8f71cbfb8051690b46e91_icgraph.png" border="0" usemap="#astream-tcp_8c_a33d1d45a83e8f71cbfb8051690b46e91_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a33d1d45a83e8f71cbfb8051690b46e91_icgraph" id="astream-tcp_8c_a33d1d45a83e8f71cbfb8051690b46e91_icgraph">
<area shape="rect" title="Run callback function on each TCP segment in both directions of a session." alt="" coords="236,5,439,32"/>
<area shape="rect" href="stream_8c.html#a463106dfe089e162920b043469ed924f" title="Run callback for all segments on both directions of the session." alt="" coords="5,5,188,32"/>
</map>
</div>

</div>
</div>
<a id="a26df002d4d76e0bf27433b289b1ca83a" name="a26df002d4d76e0bf27433b289b1ca83a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26df002d4d76e0bf27433b289b1ca83a">&#9670;&nbsp;</a></span>StreamTcpSessionCleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionCleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Session cleanup function. Does not free the ssn. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>tcp session </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00209">209</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00043">TcpStateQueue_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00285">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00275">TcpSession_::queue_len</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp_8c_source.html#l00129">StreamTcpDecrMemuse()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00196">StreamTcpStreamCleanup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00243">StreamTcpSessionClear()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00071">StreamTcpUTClearSession()</a>, and <a class="el" href="util-unittest-helper_8c_source.html#l00570">UTHRemoveSessionFromFlow()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_cgraph.png" border="0" usemap="#astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_cgraph" id="astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_cgraph">
<area shape="rect" title="Session cleanup function. Does not free the ssn." alt="" coords="5,107,184,133"/>
<area shape="rect" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title=" " alt="" coords="238,56,401,83"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="232,132,407,159"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="495,5,638,32"/>
<area shape="rect" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title=" " alt="" coords="477,56,657,83"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af4bd99000ecb44d68835f4793e33f3d4" title=" " alt="" coords="493,107,640,133"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="455,157,679,184"/>
<area shape="rect" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK tree from a stream." alt="" coords="486,208,647,235"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="727,157,939,184"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="987,157,1113,184"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="1161,157,1248,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_icgraph.png" border="0" usemap="#astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_icgraph" id="astream-tcp_8c_a26df002d4d76e0bf27433b289b1ca83a_icgraph">
<area shape="rect" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,5,189,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,56,197,83"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,107,209,133"/>
</map>
</div>

</div>
</div>
<a id="add92e80f13e88362630ba978ac24c241" name="add92e80f13e88362630ba978ac24c241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add92e80f13e88362630ba978ac24c241">&#9670;&nbsp;</a></span>StreamTcpSessionClear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionClear </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ssnptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream back to the pool. It returns the segments in the stream to the segment pool. </p>
<p >This function is called when the flow is destroyed, so it should free <em>everything</em> related to the tcp session. So including the app layer data. We are guaranteed to only get here when the flow's use_cnt is 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>Void ptr to the ssn. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00243">243</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8c_source.html#l00187">PoolThreadReturn()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00272">TcpSession_::res</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, and <a class="el" href="stream-tcp_8c_source.html#l00209">StreamTcpSessionCleanup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph.png" border="0" usemap="#astream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph" alt=""/></div>
<map name="astream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph" id="astream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph">
<area shape="rect" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="5,31,168,57"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="1197,93,1324,120"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="216,68,395,95"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="1372,93,1459,120"/>
<area shape="rect" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title=" " alt="" coords="449,68,611,95"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="443,169,617,196"/>
<area shape="rect" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title=" " alt="" coords="706,43,849,69"/>
<area shape="rect" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title=" " alt="" coords="687,93,867,120"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af4bd99000ecb44d68835f4793e33f3d4" title=" " alt="" coords="704,144,851,171"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="665,195,889,221"/>
<area shape="rect" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK tree from a stream." alt="" coords="697,245,858,272"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="937,119,1149,145"/>
</map>
</div>

</div>
</div>
<a id="af9f131faa6d6c797ab5d639c88418a1e" name="af9f131faa6d6c797ab5d639c88418a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f131faa6d6c797ab5d639c88418a1e">&#9670;&nbsp;</a></span>StreamTcpSessionPktFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionPktFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream segments back to the pool. </p>
<p >We don't clear out the app layer storage here as that is under protection of the "use_cnt" reference counter in the flow. This function is called when the use_cnt is always at least 1 (this pkt has incremented the flow use_cnt itself), so we don't bother.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Packet used to identify the stream. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00277">277</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="decode_8h_source.html#l00471">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00451">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00300">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">StreamTcpReturnStreamSegments()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph.png" border="0" usemap="#astream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph" alt=""/></div>
<map name="astream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph" id="astream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph">
<area shape="rect" title="Function to return the stream segments back to the pool." alt="" coords="5,5,183,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="231,5,455,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="503,5,715,32"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="763,5,889,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="937,5,1024,32"/>
</map>
</div>

</div>
</div>
<a id="a740e5a7f3e6792cf64cfe9926a93abb6" name="a740e5a7f3e6792cf64cfe9926a93abb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a740e5a7f3e6792cf64cfe9926a93abb6">&#9670;&nbsp;</a></span>StreamTcpSetDisableRawReassemblyFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetDisableRawReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the No reassembly flag for the given direction in given TCP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06085">6085</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>.</p>

</div>
</div>
<a id="ad63d1fe9247adc52831b6ff83b6508b5" name="ad63d1fe9247adc52831b6ff83b6508b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad63d1fe9247adc52831b6ff83b6508b5">&#9670;&nbsp;</a></span>StreamTcpSetMemcap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSetMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update memcap value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>new memcap value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00175">175</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="util-atomic_8h_source.html#l00376">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00387">SC_ATOMIC_SET</a>, and <a class="el" href="stream-tcp_8c_source.html#l00113">stream_config</a>.</p>

</div>
</div>
<a id="a4bbabc99ab491dd9fa822fd5b3ade953" name="a4bbabc99ab491dd9fa822fd5b3ade953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bbabc99ab491dd9fa822fd5b3ade953">&#9670;&nbsp;</a></span>StreamTcpSetOSPolicy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetOSPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the OS policy for the given stream based on the destination of the received packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>TcpStream of which os_policy needs to set </td></tr>
    <tr><td class="paramname">p</td><td>Packet which is used to set the os policy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00773">773</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00217">GET_IPV4_DST_ADDR_PTR</a>, <a class="el" href="decode_8h_source.html#l00222">GET_IPV6_DST_ADDR</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00110">TcpStream_::os_policy</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00039">OS_POLICY_BSD</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00040">OS_POLICY_BSD_RIGHT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00083">OS_POLICY_DEFAULT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00043">OS_POLICY_OLD_SOLARIS</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00044">OS_POLICY_SOLARIS</a>, <a class="el" href="decode_8h_source.html#l00253">PKT_IS_IPV4</a>, <a class="el" href="decode_8h_source.html#l00254">PKT_IS_IPV6</a>, <a class="el" href="util-host-os-info_8c_source.html#l00292">SCHInfoGetIPv4HostOSFlavour()</a>, <a class="el" href="util-host-os-info_8c_source.html#l00310">SCHInfoGetIPv6HostOSFlavour()</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00704">StreamTcpReassembleHandleSegmentHandleData()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph.png" border="0" usemap="#astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph" id="astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph">
<area shape="rect" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="5,31,164,57"/>
<area shape="rect" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format." alt="" coords="212,5,423,32"/>
<area shape="rect" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format." alt="" coords="212,56,423,83"/>
<area shape="rect" href="util-radix-tree_8c.html#a3f0f2284278ce9b4b740e9c08d842652" title="Checks if an IPV4 address is present in the tree under a netblock." alt="" coords="471,5,685,32"/>
<area shape="rect" href="util-radix-tree_8c.html#a6cc3963f75cae4474ad3f63869860a98" title="Checks if an IPV6 address is present in the tree under a netblock." alt="" coords="471,56,685,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph.png" border="0" usemap="#astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph" id="astream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph">
<area shape="rect" title="Function to set the OS policy for the given stream based on the destination of the received packet." alt="" coords="471,13,629,39"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine." alt="" coords="224,5,423,47"/>
<area shape="rect" href="stream-tcp-util_8c.html#aed28f8b80426b663c024011be4356924" title="wrapper for StreamTcpReassembleHandleSegmentHandleData" alt="" coords="5,13,176,39"/>
</map>
</div>

</div>
</div>
<a id="ace9285e88fab8b3f131f1c5565f6f262" name="ace9285e88fab8b3f131f1c5565f6f262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace9285e88fab8b3f131f1c5565f6f262">&#9670;&nbsp;</a></span>StreamTcpSetSessionBypassFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetSessionBypassFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable bypass </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06096">6096</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00201">STREAMTCP_FLAG_BYPASS</a>.</p>

</div>
</div>
<a id="a9d7e90ce0fb1612fdb875cc836a9daa1" name="a9d7e90ce0fb1612fdb875cc836a9daa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d7e90ce0fb1612fdb875cc836a9daa1">&#9670;&nbsp;</a></span>StreamTcpSetSessionNoReassemblyFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetSessionNoReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>disable reassembly </p>
<p >Disable app layer and set raw inspect to no longer accept new data. Stream engine will then fully disable raw after last inspection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06069">6069</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00107">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00280">TcpSession_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00228">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>.</p>

</div>
</div>
<a id="ad857679aeee3b751f4837b64faf166fe" name="ad857679aeee3b751f4837b64faf166fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad857679aeee3b751f4837b64faf166fe">&#9670;&nbsp;</a></span>StreamTcpSsnStateAsString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * StreamTcpSsnStateAsString </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06611">6611</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00273">TcpSession_::state</a>, and <a class="el" href="stream-tcp_8c_source.html#l06570">StreamTcpStateAsString()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ad857679aeee3b751f4837b64faf166fe_cgraph.png" border="0" usemap="#astream-tcp_8c_ad857679aeee3b751f4837b64faf166fe_cgraph" alt=""/></div>
<map name="astream-tcp_8c_ad857679aeee3b751f4837b64faf166fe_cgraph" id="astream-tcp_8c_ad857679aeee3b751f4837b64faf166fe_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,193,32"/>
<area shape="rect" href="stream-tcp_8c.html#a65e2fa18c93bc41fa7397c6b50523c42" title=" " alt="" coords="241,5,407,32"/>
</map>
</div>

</div>
</div>
<a id="a65e2fa18c93bc41fa7397c6b50523c42" name="a65e2fa18c93bc41fa7397c6b50523c42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65e2fa18c93bc41fa7397c6b50523c42">&#9670;&nbsp;</a></span>StreamTcpStateAsString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * StreamTcpStateAsString </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="stream-tcp-private_8h.html#a4310b47e70de394d33f7cf601e35bfec">TcpState</a>&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06570">6570</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00159">TCP_CLOSE_WAIT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00161">TCP_CLOSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00160">TCP_CLOSING</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00154">TCP_ESTABLISHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">TCP_FIN_WAIT1</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00156">TCP_FIN_WAIT2</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00158">TCP_LAST_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00150">TCP_NONE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00153">TCP_SYN_RECV</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00152">TCP_SYN_SENT</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00157">TCP_TIME_WAIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l06611">StreamTcpSsnStateAsString()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a65e2fa18c93bc41fa7397c6b50523c42_icgraph.png" border="0" usemap="#astream-tcp_8c_a65e2fa18c93bc41fa7397c6b50523c42_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a65e2fa18c93bc41fa7397c6b50523c42_icgraph" id="astream-tcp_8c_a65e2fa18c93bc41fa7397c6b50523c42_icgraph">
<area shape="rect" title=" " alt="" coords="241,5,407,32"/>
<area shape="rect" href="stream-tcp_8c.html#ad857679aeee3b751f4837b64faf166fe" title=" " alt="" coords="5,5,193,32"/>
</map>
</div>

</div>
</div>
<a id="a68329a480b2477950361537db68d8b45" name="a68329a480b2477950361537db68d8b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68329a480b2477950361537db68d8b45">&#9670;&nbsp;</a></span>StreamTcpStreamCleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpStreamCleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a110178829a2ac9abea25f6eb066360e2">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00196">196</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00134">TcpStream_::sb</a>, <a class="el" href="util-streaming-buffer_8c_source.html#l00130">StreamingBufferClear()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00385">StreamTcpReturnStreamSegments()</a>, and <a class="el" href="stream-tcp-sack_8c_source.html#l00413">StreamTcpSackFreeList()</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l00209">StreamTcpSessionCleanup()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00091">StreamTcpUTClearStream()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a68329a480b2477950361537db68d8b45_cgraph.png" border="0" usemap="#astream-tcp_8c_a68329a480b2477950361537db68d8b45_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a68329a480b2477950361537db68d8b45_cgraph" id="astream-tcp_8c_a68329a480b2477950361537db68d8b45_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,180,83"/>
<area shape="rect" href="util-streaming-buffer_8c.html#af4bd99000ecb44d68835f4793e33f3d4" title=" " alt="" coords="267,5,413,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="228,56,452,83"/>
<area shape="rect" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK tree from a stream." alt="" coords="259,107,421,133"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="500,56,712,83"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="760,56,887,83"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="935,56,1021,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a68329a480b2477950361537db68d8b45_icgraph.png" border="0" usemap="#astream-tcp_8c_a68329a480b2477950361537db68d8b45_icgraph" alt=""/></div>
<map name="astream-tcp_8c_a68329a480b2477950361537db68d8b45_icgraph" id="astream-tcp_8c_a68329a480b2477950361537db68d8b45_icgraph">
<area shape="rect" title=" " alt="" coords="484,81,659,108"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,107,434,133"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,5,189,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,107,197,133"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,56,209,83"/>
</map>
</div>

</div>
</div>
<a id="a108137f5e3fa9caa0aab96a14df9b1cc" name="a108137f5e3fa9caa0aab96a14df9b1cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a108137f5e3fa9caa0aab96a14df9b1cc">&#9670;&nbsp;</a></span>StreamTcpThreadDeinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadDeinit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l05455">5455</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00109">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00565">StreamTcpReassembleFreeThreadCtx()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00082">TM_ECODE_OK</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph.png" border="0" usemap="#astream-tcp_8c_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph" id="astream-tcp_8c_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,164,98"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc" title=" " alt="" coords="212,71,456,98"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="504,71,688,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="736,42,939,69"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="741,93,934,135"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="987,5,1196,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="991,71,1191,98"/>
</map>
</div>

</div>
</div>
<a id="a0929f1a9b555b60d89e3ce16271f89b9" name="a0929f1a9b555b60d89e3ce16271f89b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0929f1a9b555b60d89e3ce16271f89b9">&#9670;&nbsp;</a></span>StreamTcpThreadInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#ac6c5d759a1e814014a6a59ae58c594df">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>initdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l05389">5389</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp_8h_source.html#l00083">StreamTcpThread_::counter_tcp_active_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00092">StreamTcpThread_::counter_tcp_invalid_checksum</a>, <a class="el" href="stream-tcp_8h_source.html#l00104">StreamTcpThread_::counter_tcp_midstream_pickups</a>, <a class="el" href="stream-tcp_8h_source.html#l00094">StreamTcpThread_::counter_tcp_no_flow</a>, <a class="el" href="stream-tcp_8h_source.html#l00088">StreamTcpThread_::counter_tcp_pseudo</a>, <a class="el" href="stream-tcp_8h_source.html#l00090">StreamTcpThread_::counter_tcp_pseudo_failed</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00079">TcpReassemblyThreadCtx_::counter_tcp_reass_data_normal_fail</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00080">TcpReassemblyThreadCtx_::counter_tcp_reass_data_overlap_fail</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00072">TcpReassemblyThreadCtx_::counter_tcp_reass_gap</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00075">TcpReassemblyThreadCtx_::counter_tcp_reass_overlap</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00077">TcpReassemblyThreadCtx_::counter_tcp_reass_overlap_diff_data</a>, <a class="el" href="stream-tcp_8h_source.html#l00102">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00068">TcpReassemblyThreadCtx_::counter_tcp_segment_memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00084">StreamTcpThread_::counter_tcp_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00086">StreamTcpThread_::counter_tcp_ssn_memcap</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00070">TcpReassemblyThreadCtx_::counter_tcp_stream_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00098">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00100">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="stream-tcp_8h_source.html#l00106">StreamTcpThread_::counter_tcp_wrong_thread</a>, <a class="el" href="stream-tcp_8h_source.html#l00109">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="util-debug_8h_source.html#l00302">SCReturnInt</a>, <a class="el" href="stream-tcp_8h_source.html#l00076">StreamTcpThread_::ssn_pool_id</a>, <a class="el" href="counters_8c_source.html#l00956">StatsRegisterCounter()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00524">StreamTcpReassembleInitThreadCtx()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00083">TM_ECODE_FAILED</a>, <a class="el" href="fuzz__decodepcapfile_8c_source.html#l00031">tv</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a0929f1a9b555b60d89e3ce16271f89b9_cgraph.png" border="0" usemap="#astream-tcp_8c_a0929f1a9b555b60d89e3ce16271f89b9_cgraph" alt=""/></div>
<map name="astream-tcp_8c_a0929f1a9b555b60d89e3ce16271f89b9_cgraph" id="astream-tcp_8c_a0929f1a9b555b60d89e3ce16271f89b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,148,131"/>
<area shape="rect" href="counters_8c.html#a95abbd8272502dc1a4f355fb4d672a75" title="Registers a normal, unqualified counter." alt="" coords="240,79,388,106"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad53c19d8ac0e70cfa806afefc24b273c" title=" " alt="" coords="196,130,432,157"/>
<area shape="rect" href="app-layer_8c.html#a0a0e638b06f49c80ad35efdf473f6556" title="Creates a new app layer thread context." alt="" coords="480,130,639,157"/>
<area shape="rect" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread()." alt="" coords="697,71,881,98"/>
<area shape="rect" href="app-layer-parser_8c.html#a400a9d5e447fc436600350bdb157a64c" title="Gets a new app layer protocol&#39;s parser thread context." alt="" coords="687,130,892,157"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#a56a48d357c05d7cfe483a1a213444664" title="Inits and returns an app layer protocol detection thread context." alt="" coords="695,181,884,223"/>
<area shape="rect" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc()." alt="" coords="940,13,1143,39"/>
<area shape="rect" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context." alt="" coords="945,64,1138,105"/>
<area shape="rect" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title=" " alt="" coords="1191,5,1400,47"/>
<area shape="rect" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title=" " alt="" coords="1195,101,1395,127"/>
<area shape="rect" href="app-layer-parser_8c.html#a9f308874dc34fb891799d99c9beb7a84" title=" " alt="" coords="949,181,1133,223"/>
</map>
</div>

</div>
</div>
<a id="afc4ebba3d55a0923ad8aee7f6a959bd0" name="afc4ebba3d55a0923ad8aee7f6a959bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4ebba3d55a0923ad8aee7f6a959bd0">&#9670;&nbsp;</a></span>StreamTcpUpdateAppLayerProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpUpdateAppLayerProgress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update reassembly progress </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06051">6051</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00126">TcpStream_::app_progress_rel</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00284">TcpSession_::client</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00283">TcpSession_::server</a>.</p>

<p class="reference">Referenced by <a class="el" href="app-layer_8c_source.html#l00638">AppLayerHandleTCPData()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_afc4ebba3d55a0923ad8aee7f6a959bd0_icgraph.png" border="0" usemap="#astream-tcp_8c_afc4ebba3d55a0923ad8aee7f6a959bd0_icgraph" alt=""/></div>
<map name="astream-tcp_8c_afc4ebba3d55a0923ad8aee7f6a959bd0_icgraph" id="astream-tcp_8c_afc4ebba3d55a0923ad8aee7f6a959bd0_icgraph">
<area shape="rect" title="update reassembly progress" alt="" coords="487,5,720,32"/>
<area shape="rect" href="app-layer_8c.html#a0ff217804179c214167d7c925eb8449c" title="handle TCP data for the app&#45;layer." alt="" coords="265,5,439,32"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a89fdc683cf890121b3aecc81bedc0bd8" title="Update the stream reassembly upon receiving a packet." alt="" coords="5,5,217,32"/>
</map>
</div>

</div>
</div>
<a id="a8803814028dbe6165bae8ced1a27d2f2" name="a8803814028dbe6165bae8ced1a27d2f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8803814028dbe6165bae8ced1a27d2f2">&#9670;&nbsp;</a></span>TcpSessionPacketSsnReuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TcpSessionPacketSsnReuse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#ae07de58ee627c9bb6330b3131393d7d5">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#aadd8c0a09358c16760b2f4f600dbc930">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>tcp_ssn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l05336">5336</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="decode_8h_source.html#l00456">Packet_::proto</a>, and <a class="el" href="decode_8h_source.html#l00554">Packet_::tcph</a>.</p>

</div>
</div>
<a id="aa5a032e54ca88381e188cb4ef5db7ed0" name="aa5a032e54ca88381e188cb4ef5db7ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a032e54ca88381e188cb4ef5db7ed0">&#9670;&nbsp;</a></span>TcpSessionSetReassemblyDepth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TcpSessionSetReassemblyDepth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7da1df53e6435180e4683cd603d182e6">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l06561">6561</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">References <a class="el" href="stream-tcp-private_8h_source.html#l00281">TcpSession_::reassembly_depth</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af5f795363f8a29406ae0eb9dd2aac261" name="af5f795363f8a29406ae0eb9dd2aac261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f795363f8a29406ae0eb9dd2aac261">&#9670;&nbsp;</a></span>g_detect_disabled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int g_detect_disabled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >global indicating if detection is enabled </p>

<p class="definition">Definition at line <a class="el" href="suricata_8c_source.html#l00225">225</a> of file <a class="el" href="suricata_8c_source.html">suricata.c</a>.</p>

</div>
</div>
<a id="ac6bed017a2a4f7ef805bd3b51a251d68" name="ac6bed017a2a4f7ef805bd3b51a251d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bed017a2a4f7ef805bd3b51a251d68">&#9670;&nbsp;</a></span>stream_config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp_8h.html#a8908bce3b095fbb7526cafd3ffbabf2b">TcpStreamCnf</a> stream_config</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp_8c_source.html#l00113">113</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-napatech_8c_source.html#l00804">NapatechGetStreamConfig()</a>, <a class="el" href="stream-tcp_8c_source.html#l06544">StreamTcpBypassEnabled()</a>, <a class="el" href="stream-tcp_8c_source.html#l00162">StreamTcpCheckMemcap()</a>, <a class="el" href="stream-tcp_8c_source.html#l00190">StreamTcpGetMemcap()</a>, <a class="el" href="stream-tcp_8c_source.html#l00359">StreamTcpInitConfig()</a>, <a class="el" href="stream-tcp_8c_source.html#l00333">StreamTcpInlineDropInvalid()</a>, <a class="el" href="stream-tcp_8c_source.html#l06555">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00197">StreamTcpReassembleGetMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00182">StreamTcpReassembleSetMemcap()</a>, <a class="el" href="stream-tcp_8c_source.html#l00175">StreamTcpSetMemcap()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00051">StreamTcpUTDeinit()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00058">StreamTcpUTInitInline()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00062">StreamTcpUTSetupSession()</a>, <a class="el" href="stream-tcp-util_8c_source.html#l00079">StreamTcpUTSetupStream()</a>, and <a class="el" href="util-unittest-helper_8c_source.html#l00550">UTHAddSessionToFlow()</a>.</p>

</div>
</div>
<a id="a819fe1b32fe9d7dec8649ef7af7582d9" name="a819fe1b32fe9d7dec8649ef7af7582d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819fe1b32fe9d7dec8649ef7af7582d9">&#9670;&nbsp;</a></span>t_pcapcnt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">thread_local uint64_t t_pcapcnt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00077">77</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp_8c_source.html#l05348">StreamTcp()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">StreamTcpReassembleCheckMemcap()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_01c0b1a5e3a9ffbe219ba40d242e4e46.html">suricata</a></li><li class="navelem"><a class="el" href="dir_8af5fe1b301a1eaec94333fa06e13447.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp_8c.html">stream-tcp.c</a></li>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:24 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
