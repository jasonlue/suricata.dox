<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>suricata: Pool</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="suricata"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">suricata<span id="projectnumber">&#160;6.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__utilpool.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Pool</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:util-pool-thread_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-pool-thread_8c.html">util-pool-thread.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:util-pool-thread_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-pool-thread_8h.html">util-pool-thread.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:util-pool_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-pool_8c.html">util-pool.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:util-pool_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-pool_8h.html">util-pool.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPoolThreadTestData.html">PoolThreadTestData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaeeec3f298d6d5a99ee979b93a6f67780"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gaeeec3f298d6d5a99ee979b93a6f67780">PoolThreadInit</a> (int threads, uint32_t size, uint32_t prealloc_size, uint32_t elt_size, void *(*Alloc)(void), int(*Init)(void *, void *), void *InitData, void(*Cleanup)(void *), void(*Free)(void *))</td></tr>
<tr class="memdesc:gaeeec3f298d6d5a99ee979b93a6f67780"><td class="mdescLeft">&#160;</td><td class="mdescRight">per thread Pool, initialization function  <a href="group__utilpool.html#gaeeec3f298d6d5a99ee979b93a6f67780">More...</a><br /></td></tr>
<tr class="separator:gaeeec3f298d6d5a99ee979b93a6f67780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga241b9af591cd51539e2bdb595356a77d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga241b9af591cd51539e2bdb595356a77d">PoolThreadExpand</a> (<a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *pt)</td></tr>
<tr class="memdesc:ga241b9af591cd51539e2bdb595356a77d"><td class="mdescLeft">&#160;</td><td class="mdescRight">expand pool by one for a new thread  <a href="group__utilpool.html#ga241b9af591cd51539e2bdb595356a77d">More...</a><br /></td></tr>
<tr class="separator:ga241b9af591cd51539e2bdb595356a77d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacbe5aa27b89cc62080896dc8889ae7ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce">PoolThreadSize</a> (<a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *pt)</td></tr>
<tr class="memdesc:gacbe5aa27b89cc62080896dc8889ae7ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">get size of PoolThread (number of 'threads', so array elements)  <a href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce">More...</a><br /></td></tr>
<tr class="separator:gacbe5aa27b89cc62080896dc8889ae7ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0cc1f2c68a31a118a91eeb9376075f4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d">PoolThreadFree</a> (<a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *pt)</td></tr>
<tr class="memdesc:ga0cc1f2c68a31a118a91eeb9376075f4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">destroy the thread pool  <a href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d">More...</a><br /></td></tr>
<tr class="separator:ga0cc1f2c68a31a118a91eeb9376075f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe3fd07a4b08ea4aa17e13b24ece9dbf"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gabe3fd07a4b08ea4aa17e13b24ece9dbf">PoolThreadGetById</a> (<a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *pt, uint16_t id)</td></tr>
<tr class="memdesc:gabe3fd07a4b08ea4aa17e13b24ece9dbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">get data from thread pool by thread id  <a href="group__utilpool.html#gabe3fd07a4b08ea4aa17e13b24ece9dbf">More...</a><br /></td></tr>
<tr class="separator:gabe3fd07a4b08ea4aa17e13b24ece9dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe4882476fd4ad932ba6f76d7a7523a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3">PoolThreadReturn</a> (<a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *pt, void *data)</td></tr>
<tr class="memdesc:gabe4882476fd4ad932ba6f76d7a7523a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">return data to thread pool  <a href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3">More...</a><br /></td></tr>
<tr class="separator:gabe4882476fd4ad932ba6f76d7a7523a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga987c02dbf3a66a990df219962b42a123"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga987c02dbf3a66a990df219962b42a123">PoolThreadRegisterTests</a> (void)</td></tr>
<tr class="separator:ga987c02dbf3a66a990df219962b42a123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61f2bfa4fa5c5806277fd5953fbfea34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34">PoolInit</a> (uint32_t size, uint32_t prealloc_size, uint32_t elt_size, void *(*Alloc)(void), int(*Init)(void *, void *), void *InitData, void(*Cleanup)(void *), void(*Free)(void *))</td></tr>
<tr class="memdesc:ga61f2bfa4fa5c5806277fd5953fbfea34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init a Pool.  <a href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34">More...</a><br /></td></tr>
<tr class="separator:ga61f2bfa4fa5c5806277fd5953fbfea34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2872120babab18bece5ce3499b4a3fe8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8">PoolFree</a> (<a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *p)</td></tr>
<tr class="separator:ga2872120babab18bece5ce3499b4a3fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d27effd9e7f38b78ef51f5b2d95d92f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga5d27effd9e7f38b78ef51f5b2d95d92f">PoolPrint</a> (<a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *p)</td></tr>
<tr class="separator:ga5d27effd9e7f38b78ef51f5b2d95d92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4b84b453b8cedd3653231a405f2d0b9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9">PoolGet</a> (<a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *p)</td></tr>
<tr class="separator:gad4b84b453b8cedd3653231a405f2d0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6552ceb7e157bc1ccc9de8bc33c0528e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e">PoolReturn</a> (<a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *p, void *data)</td></tr>
<tr class="separator:ga6552ceb7e157bc1ccc9de8bc33c0528e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06f51c149934cd93fb01a00f0ca27930"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#ga06f51c149934cd93fb01a00f0ca27930">PoolPrintSaturation</a> (<a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *p)</td></tr>
<tr class="separator:ga06f51c149934cd93fb01a00f0ca27930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3e5c8c10fb94a2668e6572cd7071314"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utilpool.html#gac3e5c8c10fb94a2668e6572cd7071314">PoolRegisterTests</a> (void)</td></tr>
<tr class="separator:gac3e5c8c10fb94a2668e6572cd7071314"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p ><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> are an effective way to maintain a set of ready to use structures.</p>
<p >To create a <a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a>, you need to use <a class="el" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34" title="Init a Pool.">PoolInit()</a>. You can get an item from the <a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> by using <a class="el" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9">PoolGet()</a>. When you're done with it call <a class="el" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e">PoolReturn()</a>. To destroy the <a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a>, call <a class="el" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8">PoolFree()</a>, it will free all used memory. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga2872120babab18bece5ce3499b4a3fe8" name="ga2872120babab18bece5ce3499b4a3fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2872120babab18bece5ce3499b4a3fe8">&#9670;&nbsp;</a></span>PoolFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00220">220</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00051">Pool_::alloc_stack</a>, <a class="el" href="util-pool_8h_source.html#l00063">Pool_::Cleanup</a>, <a class="el" href="util-pool_8h_source.html#l00037">PoolBucket_::data</a>, and <a class="el" href="util-pool_8h_source.html#l00039">PoolBucket_::next</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-pool-thread_8c_source.html#l00150">PoolThreadFree()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga2872120babab18bece5ce3499b4a3fe8_icgraph.png" border="0" usemap="#agroup__utilpool_ga2872120babab18bece5ce3499b4a3fe8_icgraph" alt=""/></div>
<map name="agroup__utilpool_ga2872120babab18bece5ce3499b4a3fe8_icgraph" id="agroup__utilpool_ga2872120babab18bece5ce3499b4a3fe8_icgraph">
<area shape="rect" title=" " alt="" coords="323,5,397,32"/>
<area shape="rect" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool" alt="" coords="160,5,275,32"/>
<area shape="rect" href="group__utilpool.html#gaeeec3f298d6d5a99ee979b93a6f67780" title="per thread Pool, initialization function" alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="gad4b84b453b8cedd3653231a405f2d0b9" name="gad4b84b453b8cedd3653231a405f2d0b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4b84b453b8cedd3653231a405f2d0b9">&#9670;&nbsp;</a></span>PoolGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * PoolGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00275">275</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00060">Pool_::Alloc</a>, <a class="el" href="util-pool_8h_source.html#l00051">Pool_::alloc_stack</a>, <a class="el" href="util-pool_8h_source.html#l00049">Pool_::alloc_stack_size</a>, <a class="el" href="util-pool_8h_source.html#l00046">Pool_::allocated</a>, <a class="el" href="util-pool_8h_source.html#l00037">PoolBucket_::data</a>, <a class="el" href="util-pool_8h_source.html#l00066">Pool_::elt_size</a>, <a class="el" href="util-pool_8h_source.html#l00053">Pool_::empty_stack</a>, <a class="el" href="util-pool_8h_source.html#l00054">Pool_::empty_stack_size</a>, <a class="el" href="util-pool_8h_source.html#l00064">Pool_::Free</a>, <a class="el" href="util-pool_8h_source.html#l00061">Pool_::Init</a>, <a class="el" href="util-pool_8h_source.html#l00062">Pool_::InitData</a>, <a class="el" href="util-pool_8h_source.html#l00044">Pool_::max_buckets</a>, <a class="el" href="util-pool_8h_source.html#l00039">PoolBucket_::next</a>, <a class="el" href="util-pool_8h_source.html#l00067">Pool_::outstanding</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, and <a class="el" href="util-debug_8h_source.html#l00314">SCReturnPtr</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-pool-thread_8c_source.html#l00168">PoolThreadGetById()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gad4b84b453b8cedd3653231a405f2d0b9_icgraph.png" border="0" usemap="#agroup__utilpool_gad4b84b453b8cedd3653231a405f2d0b9_icgraph" alt=""/></div>
<map name="agroup__utilpool_gad4b84b453b8cedd3653231a405f2d0b9_icgraph" id="agroup__utilpool_gad4b84b453b8cedd3653231a405f2d0b9_icgraph">
<area shape="rect" title=" " alt="" coords="673,35,743,61"/>
<area shape="rect" href="group__utilpool.html#gabe3fd07a4b08ea4aa17e13b24ece9dbf" title="get data from thread pool by thread id" alt="" coords="489,35,625,61"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a97a58f1dc1eea7d2a17c2be618efe8cf" title="get a segment from the pool" alt="" coords="284,35,441,61"/>
<area shape="rect" href="stream-tcp-util_8c.html#a76e6bc7448ccad45a8955265ec14e40a" title=" " alt="" coords="5,5,236,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#aa95bbbdf447725bbfb4948657754d61f" title=" " alt="" coords="19,57,222,98"/>
</map>
</div>

</div>
</div>
<a id="ga61f2bfa4fa5c5806277fd5953fbfea34" name="ga61f2bfa4fa5c5806277fd5953fbfea34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61f2bfa4fa5c5806277fd5953fbfea34">&#9670;&nbsp;</a></span>PoolInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> * PoolInit </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>prealloc_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>elt_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void)&#160;</td>
          <td class="paramname"><em>Alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, void *)&#160;</td>
          <td class="paramname"><em>Init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>InitData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Cleanup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init a Pool. </p>
<p ><a class="el" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34" title="Init a Pool.">PoolInit()</a> creates a <a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a>. The Alloc function must only do allocation stuff. The Cleanup function must not try to free the <a class="el" href="structPoolBucket__.html#a1ba1ef2397ea8f4586aec5d8187efe71">PoolBucket::data</a>. This is done by the <a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> management system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td></td></tr>
    <tr><td class="paramname">prealloc_size</td><td></td></tr>
    <tr><td class="paramname">elt_size</td><td>Memory size of an element </td></tr>
    <tr><td class="paramname">Alloc</td><td>An allocation function or NULL to use a standard SCMalloc </td></tr>
    <tr><td class="paramname">Init</td><td>An init function or NULL to use a standard memset to 0 </td></tr>
    <tr><td class="paramname">InitData</td><td>Init data </td></tr>
    <tr><td class="paramname">Cleanup</td><td>a free function or NULL if no special treatment is needed </td></tr>
    <tr><td class="paramname">Free</td><td>free func </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>allocated Pool </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00084">84</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00060">Pool_::Alloc</a>, <a class="el" href="util-pool_8h_source.html#l00063">Pool_::Cleanup</a>, <a class="el" href="util-pool_8h_source.html#l00056">Pool_::data_buffer_size</a>, <a class="el" href="util-pool_8h_source.html#l00066">Pool_::elt_size</a>, <a class="el" href="util-pool_8h_source.html#l00064">Pool_::Free</a>, <a class="el" href="util-pool_8h_source.html#l00061">Pool_::Init</a>, <a class="el" href="util-pool_8h_source.html#l00062">Pool_::InitData</a>, <a class="el" href="util-pool_8h_source.html#l00044">Pool_::max_buckets</a>, <a class="el" href="util-pool_8h_source.html#l00045">Pool_::preallocated</a>, <a class="el" href="util-error_8h_source.html#l00096">SC_ERR_POOL_INIT</a>, <a class="el" href="util-debug_8h_source.html#l00255">SCLogError</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-pool-thread_8c_source.html#l00092">PoolThreadExpand()</a>, and <a class="el" href="util-pool-thread_8c_source.html#l00043">PoolThreadInit()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga61f2bfa4fa5c5806277fd5953fbfea34_icgraph.png" border="0" usemap="#agroup__utilpool_ga61f2bfa4fa5c5806277fd5953fbfea34_icgraph" alt=""/></div>
<map name="agroup__utilpool_ga61f2bfa4fa5c5806277fd5953fbfea34_icgraph" id="agroup__utilpool_ga61f2bfa4fa5c5806277fd5953fbfea34_icgraph">
<area shape="rect" title="Init a Pool." alt="" coords="185,31,252,57"/>
<area shape="rect" href="group__utilpool.html#ga241b9af591cd51539e2bdb595356a77d" title="expand pool by one for a new thread" alt="" coords="5,5,137,32"/>
<area shape="rect" href="group__utilpool.html#gaeeec3f298d6d5a99ee979b93a6f67780" title="per thread Pool, initialization function" alt="" coords="18,56,125,83"/>
</map>
</div>

</div>
</div>
<a id="ga5d27effd9e7f38b78ef51f5b2d95d92f" name="ga5d27effd9e7f38b78ef51f5b2d95d92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5d27effd9e7f38b78ef51f5b2d95d92f">&#9670;&nbsp;</a></span>PoolPrint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolPrint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00268">268</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00049">Pool_::alloc_stack_size</a>, and <a class="el" href="util-pool_8h_source.html#l00054">Pool_::empty_stack_size</a>.</p>

</div>
</div>
<a id="ga06f51c149934cd93fb01a00f0ca27930" name="ga06f51c149934cd93fb01a00f0ca27930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06f51c149934cd93fb01a00f0ca27930">&#9670;&nbsp;</a></span>PoolPrintSaturation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolPrintSaturation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00373">373</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00044">Pool_::max_buckets</a>, <a class="el" href="util-pool_8h_source.html#l00067">Pool_::outstanding</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

</div>
</div>
<a id="gac3e5c8c10fb94a2668e6572cd7071314" name="gac3e5c8c10fb94a2668e6572cd7071314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac3e5c8c10fb94a2668e6572cd7071314">&#9670;&nbsp;</a></span>PoolRegisterTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00720">720</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-unittest_8c_source.html#l00103">UtRegisterTest()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gac3e5c8c10fb94a2668e6572cd7071314_cgraph.png" border="0" usemap="#agroup__utilpool_gac3e5c8c10fb94a2668e6572cd7071314_cgraph" alt=""/></div>
<map name="agroup__utilpool_gac3e5c8c10fb94a2668e6572cd7071314_cgraph" id="agroup__utilpool_gac3e5c8c10fb94a2668e6572cd7071314_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,135,32"/>
<area shape="rect" href="group__Testing.html#ga34617b41f44505d5c3938e4df12c264f" title="Register unit test." alt="" coords="183,5,293,32"/>
</map>
</div>

</div>
</div>
<a id="ga6552ceb7e157bc1ccc9de8bc33c0528e" name="ga6552ceb7e157bc1ccc9de8bc33c0528e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6552ceb7e157bc1ccc9de8bc33c0528e">&#9670;&nbsp;</a></span>PoolReturn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolReturn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool_8h.html#adf480d4c0cdfef53a997f290cfdc48dc">Pool</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool_8c_source.html#l00333">333</a> of file <a class="el" href="util-pool_8c_source.html">util-pool.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00046">Pool_::allocated</a>, <a class="el" href="util-pool_8h_source.html#l00063">Pool_::Cleanup</a>, <a class="el" href="util-pool_8h_source.html#l00053">Pool_::empty_stack</a>, <a class="el" href="util-pool_8h_source.html#l00067">Pool_::outstanding</a>, <a class="el" href="util-debug_8h_source.html#l00298">SCEnter</a>, and <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-pool-thread_8c_source.html#l00187">PoolThreadReturn()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga6552ceb7e157bc1ccc9de8bc33c0528e_icgraph.png" border="0" usemap="#agroup__utilpool_ga6552ceb7e157bc1ccc9de8bc33c0528e_icgraph" alt=""/></div>
<map name="agroup__utilpool_ga6552ceb7e157bc1ccc9de8bc33c0528e_icgraph" id="agroup__utilpool_ga6552ceb7e157bc1ccc9de8bc33c0528e_icgraph">
<area shape="rect" title=" " alt="" coords="1416,132,1503,159"/>
<area shape="rect" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool" alt="" coords="1241,132,1368,159"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="981,81,1193,108"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,132,189,159"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="709,69,933,96"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,56,655,83"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,107,661,133"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,5,660,32"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,5,434,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,5,197,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,56,209,83"/>
</map>
</div>

</div>
</div>
<a id="ga241b9af591cd51539e2bdb595356a77d" name="ga241b9af591cd51539e2bdb595356a77d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga241b9af591cd51539e2bdb595356a77d">&#9670;&nbsp;</a></span>PoolThreadExpand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PoolThreadExpand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td>
          <td class="paramname"><em>pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>expand pool by one for a new thread </p>
<p >grow a thread pool by one</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>or pool thread id </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00092">92</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool_8h_source.html#l00060">Pool_::Alloc</a>, <a class="el" href="util-pool-thread_8h_source.html#l00054">PoolThread_::array</a>, <a class="el" href="util-pool_8h_source.html#l00063">Pool_::Cleanup</a>, <a class="el" href="util-pool_8h_source.html#l00066">Pool_::elt_size</a>, <a class="el" href="util-pool_8h_source.html#l00064">Pool_::Free</a>, <a class="el" href="util-pool_8h_source.html#l00061">Pool_::Init</a>, <a class="el" href="util-pool_8h_source.html#l00062">Pool_::InitData</a>, <a class="el" href="util-pool-thread_8h_source.html#l00045">PoolThreadElement_::lock</a>, <a class="el" href="util-pool_8h_source.html#l00044">Pool_::max_buckets</a>, <a class="el" href="util-pool-thread_8h_source.html#l00046">PoolThreadElement_::pool</a>, <a class="el" href="util-pool_8c_source.html#l00084">PoolInit()</a>, <a class="el" href="util-pool_8h_source.html#l00045">Pool_::preallocated</a>, <a class="el" href="util-error_8h_source.html#l00096">SC_ERR_POOL_INIT</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00255">SCLogError</a>, <a class="el" href="threads-debug_8h_source.html#l00116">SCMutexInit</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, <a class="el" href="util-mem_8h_source.html#l00050">SCRealloc</a>, and <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga241b9af591cd51539e2bdb595356a77d_cgraph.png" border="0" usemap="#agroup__utilpool_ga241b9af591cd51539e2bdb595356a77d_cgraph" alt=""/></div>
<map name="agroup__utilpool_ga241b9af591cd51539e2bdb595356a77d_cgraph" id="agroup__utilpool_ga241b9af591cd51539e2bdb595356a77d_cgraph">
<area shape="rect" title="expand pool by one for a new thread" alt="" coords="5,5,137,32"/>
<area shape="rect" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34" title="Init a Pool." alt="" coords="185,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="ga0cc1f2c68a31a118a91eeb9376075f4d" name="ga0cc1f2c68a31a118a91eeb9376075f4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0cc1f2c68a31a118a91eeb9376075f4d">&#9670;&nbsp;</a></span>PoolThreadFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolThreadFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td>
          <td class="paramname"><em>pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>destroy the thread pool </p>
<dl class="section note"><dt>Note</dt><dd>wrapper around <a class="el" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8">PoolFree()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>thread pool </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00150">150</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8h_source.html#l00054">PoolThread_::array</a>, <a class="el" href="util-pool-thread_8h_source.html#l00045">PoolThreadElement_::lock</a>, <a class="el" href="util-pool-thread_8h_source.html#l00046">PoolThreadElement_::pool</a>, <a class="el" href="util-pool_8c_source.html#l00220">PoolFree()</a>, <a class="el" href="util-mem_8h_source.html#l00061">SCFree</a>, <a class="el" href="threads-debug_8h_source.html#l00120">SCMutexDestroy</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, and <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="util-pool-thread_8c_source.html#l00043">PoolThreadInit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_cgraph.png" border="0" usemap="#agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_cgraph" alt=""/></div>
<map name="agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_cgraph" id="agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_cgraph">
<area shape="rect" title="destroy the thread pool" alt="" coords="5,5,120,32"/>
<area shape="rect" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title=" " alt="" coords="168,5,243,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_icgraph.png" border="0" usemap="#agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_icgraph" alt=""/></div>
<map name="agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_icgraph" id="agroup__utilpool_ga0cc1f2c68a31a118a91eeb9376075f4d_icgraph">
<area shape="rect" title="destroy the thread pool" alt="" coords="160,5,275,32"/>
<area shape="rect" href="group__utilpool.html#gaeeec3f298d6d5a99ee979b93a6f67780" title="per thread Pool, initialization function" alt="" coords="5,5,112,32"/>
</map>
</div>

</div>
</div>
<a id="gabe3fd07a4b08ea4aa17e13b24ece9dbf" name="gabe3fd07a4b08ea4aa17e13b24ece9dbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe3fd07a4b08ea4aa17e13b24ece9dbf">&#9670;&nbsp;</a></span>PoolThreadGetById()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * PoolThreadGetById </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get data from thread pool by thread id </p>
<dl class="section note"><dt>Note</dt><dd>wrapper around <a class="el" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9">PoolGet()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>thread pool </td></tr>
    <tr><td class="paramname">id</td><td>thread id </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>data or NULL </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00168">168</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8h_source.html#l00054">PoolThread_::array</a>, <a class="el" href="util-pool-thread_8h_source.html#l00045">PoolThreadElement_::lock</a>, <a class="el" href="util-pool-thread_8h_source.html#l00046">PoolThreadElement_::pool</a>, <a class="el" href="util-pool_8c_source.html#l00275">PoolGet()</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, and <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l02036">StreamTcpGetSegment()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_cgraph.png" border="0" usemap="#agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_cgraph" alt=""/></div>
<map name="agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_cgraph" id="agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_cgraph">
<area shape="rect" title="get data from thread pool by thread id" alt="" coords="5,5,141,32"/>
<area shape="rect" href="group__utilpool.html#gad4b84b453b8cedd3653231a405f2d0b9" title=" " alt="" coords="189,5,259,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_icgraph.png" border="0" usemap="#agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_icgraph" alt=""/></div>
<map name="agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_icgraph" id="agroup__utilpool_gabe3fd07a4b08ea4aa17e13b24ece9dbf_icgraph">
<area shape="rect" title="get data from thread pool by thread id" alt="" coords="489,35,625,61"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a97a58f1dc1eea7d2a17c2be618efe8cf" title="get a segment from the pool" alt="" coords="284,35,441,61"/>
<area shape="rect" href="stream-tcp-util_8c.html#a76e6bc7448ccad45a8955265ec14e40a" title=" " alt="" coords="5,5,236,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#aa95bbbdf447725bbfb4948657754d61f" title=" " alt="" coords="19,57,222,98"/>
</map>
</div>

</div>
</div>
<a id="gaeeec3f298d6d5a99ee979b93a6f67780" name="gaeeec3f298d6d5a99ee979b93a6f67780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeeec3f298d6d5a99ee979b93a6f67780">&#9670;&nbsp;</a></span>PoolThreadInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> * PoolThreadInit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>prealloc_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>elt_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void)&#160;</td>
          <td class="paramname"><em>Alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, void *)&#160;</td>
          <td class="paramname"><em>Init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>InitData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Cleanup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>per thread Pool, initialization function </p>
<p >initialize a thread pool</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thread</td><td>number of threads this is for. Can start with 1 and be expanded. Other params are as for <a class="el" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34" title="Init a Pool.">PoolInit()</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00043">43</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8h_source.html#l00054">PoolThread_::array</a>, <a class="el" href="util-pool-thread_8h_source.html#l00045">PoolThreadElement_::lock</a>, <a class="el" href="util-pool-thread_8h_source.html#l00046">PoolThreadElement_::pool</a>, <a class="el" href="util-pool_8c_source.html#l00084">PoolInit()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00150">PoolThreadFree()</a>, <a class="el" href="util-mem_8h_source.html#l00053">SCCalloc</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00047">SCMalloc</a>, <a class="el" href="threads-debug_8h_source.html#l00116">SCMutexInit</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gaeeec3f298d6d5a99ee979b93a6f67780_cgraph.png" border="0" usemap="#agroup__utilpool_gaeeec3f298d6d5a99ee979b93a6f67780_cgraph" alt=""/></div>
<map name="agroup__utilpool_gaeeec3f298d6d5a99ee979b93a6f67780_cgraph" id="agroup__utilpool_gaeeec3f298d6d5a99ee979b93a6f67780_cgraph">
<area shape="rect" title="per thread Pool, initialization function" alt="" coords="5,31,112,57"/>
<area shape="rect" href="group__utilpool.html#ga61f2bfa4fa5c5806277fd5953fbfea34" title="Init a Pool." alt="" coords="184,5,251,32"/>
<area shape="rect" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool" alt="" coords="160,56,275,83"/>
<area shape="rect" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title=" " alt="" coords="323,56,397,83"/>
</map>
</div>

</div>
</div>
<a id="ga987c02dbf3a66a990df219962b42a123" name="ga987c02dbf3a66a990df219962b42a123"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga987c02dbf3a66a990df219962b42a123">&#9670;&nbsp;</a></span>PoolThreadRegisterTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolThreadRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00375">375</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-unittest_8c_source.html#l00103">UtRegisterTest()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_ga987c02dbf3a66a990df219962b42a123_cgraph.png" border="0" usemap="#agroup__utilpool_ga987c02dbf3a66a990df219962b42a123_cgraph" alt=""/></div>
<map name="agroup__utilpool_ga987c02dbf3a66a990df219962b42a123_cgraph" id="agroup__utilpool_ga987c02dbf3a66a990df219962b42a123_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,175,32"/>
<area shape="rect" href="group__Testing.html#ga34617b41f44505d5c3938e4df12c264f" title="Register unit test." alt="" coords="223,5,333,32"/>
</map>
</div>

</div>
</div>
<a id="gabe4882476fd4ad932ba6f76d7a7523a3" name="gabe4882476fd4ad932ba6f76d7a7523a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe4882476fd4ad932ba6f76d7a7523a3">&#9670;&nbsp;</a></span>PoolThreadReturn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoolThreadReturn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return data to thread pool </p>
<dl class="section note"><dt>Note</dt><dd>wrapper around <a class="el" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e">PoolReturn()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>thread pool </td></tr>
    <tr><td class="paramname">data</td><td>memory block to return, with PoolThreadReserved as it's first member </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00187">187</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8h_source.html#l00054">PoolThread_::array</a>, <a class="el" href="util-pool-thread_8h_source.html#l00045">PoolThreadElement_::lock</a>, <a class="el" href="util-pool-thread_8h_source.html#l00046">PoolThreadElement_::pool</a>, <a class="el" href="util-pool_8c_source.html#l00333">PoolReturn()</a>, <a class="el" href="util-debug_8h_source.html#l00296">SCLogDebug</a>, <a class="el" href="threads-debug_8h_source.html#l00117">SCMutexLock</a>, <a class="el" href="threads-debug_8h_source.html#l00119">SCMutexUnlock</a>, and <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00368">StreamTcpSegmentReturntoPool()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00243">StreamTcpSessionClear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_cgraph.png" border="0" usemap="#agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_cgraph" alt=""/></div>
<map name="agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_cgraph" id="agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_cgraph">
<area shape="rect" title="return data to thread pool" alt="" coords="5,5,132,32"/>
<area shape="rect" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title=" " alt="" coords="180,5,267,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_icgraph.png" border="0" usemap="#agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_icgraph" alt=""/></div>
<map name="agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_icgraph" id="agroup__utilpool_gabe4882476fd4ad932ba6f76d7a7523a3_icgraph">
<area shape="rect" title="return data to thread pool" alt="" coords="1241,132,1368,159"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool." alt="" coords="981,81,1193,108"/>
<area shape="rect" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="26,132,189,159"/>
<area shape="rect" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s)" alt="" coords="709,69,933,96"/>
<area shape="rect" href="stream-tcp-list_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession." alt="" coords="490,56,655,83"/>
<area shape="rect" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool." alt="" coords="484,107,661,133"/>
<area shape="rect" href="stream-tcp_8c.html#a68329a480b2477950361537db68d8b45" title=" " alt="" coords="485,5,660,32"/>
<area shape="rect" href="stream-tcp_8c.html#a26df002d4d76e0bf27433b289b1ca83a" title="Session cleanup function. Does not free the ssn." alt="" coords="257,56,436,83"/>
<area shape="rect" href="stream-tcp-util_8c.html#a92fbdb23e38878f63a4343951b9edcc7" title=" " alt="" coords="259,5,434,32"/>
<area shape="rect" href="stream-tcp-util_8c.html#a5bef4b33daf7e346128f449273fadda9" title=" " alt="" coords="17,5,197,32"/>
<area shape="rect" href="util-unittest-helper_8c.html#a31d5cbb8fdc195d4ab561829b3459e77" title=" " alt="" coords="5,56,209,83"/>
</map>
</div>

</div>
</div>
<a id="gacbe5aa27b89cc62080896dc8889ae7ce" name="gacbe5aa27b89cc62080896dc8889ae7ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacbe5aa27b89cc62080896dc8889ae7ce">&#9670;&nbsp;</a></span>PoolThreadSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PoolThreadSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-pool-thread_8h.html#abd3f784ab7766b87ab37a6cbdd4eb0d3">PoolThread</a> *&#160;</td>
          <td class="paramname"><em>pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get size of PoolThread (number of 'threads', so array elements) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>thread pool </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">size</td><td>or -1 on error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="util-pool-thread_8c_source.html#l00143">143</a> of file <a class="el" href="util-pool-thread_8c_source.html">util-pool-thread.c</a>.</p>

<p class="reference">References <a class="el" href="util-pool-thread_8h_source.html#l00053">PoolThread_::size</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 17 2022 16:17:25 for suricata by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
